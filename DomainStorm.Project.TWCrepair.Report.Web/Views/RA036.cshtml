@using Microsoft.AspNetCore.Html
@model DomainStorm.Project.TWCrepair.Report.Web.Views.RA036
@{
    Layout = null;
    var stylesPath = System.IO.Path.Combine(Directory.GetCurrentDirectory(), "Views", "RA036.head.xml");
    var head = await File.ReadAllTextAsync(stylesPath);
}
<?xml version="1.0" encoding="UTF-8"?>

<office:document xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:config="urn:oasis:names:tc:opendocument:xmlns:config:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:rpt="http://openoffice.org/2005/report" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:tableooo="http://openoffice.org/2009/table" xmlns:calcext="urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0" xmlns:drawooo="http://openoffice.org/2010/draw" xmlns:loext="urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:formx="urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:css3t="http://www.w3.org/TR/css3-text/" xmlns:presentation="urn:oasis:names:tc:opendocument:xmlns:presentation:1.0" office:version="1.4" office:mimetype="application/vnd.oasis.opendocument.spreadsheet">
  @Html.Raw(head)
 <office:body>
  <office:spreadsheet>
   <table:calculation-settings table:case-sensitive="false" table:automatic-find-labels="false" table:use-regular-expressions="false" table:use-wildcards="true"/>
   <table:table table:name="附表六、各系統管徑、管長暨附屬設備統計表" table:style-name="ta1">
    <office:forms form:automatic-focus="false" form:apply-design-mode="false"/>
    <table:table-column table:style-name="co1" table:number-columns-repeated="37" table:default-cell-style-name="Default"/>
    <table:table-row table:style-name="ro1">
     <table:table-cell table:style-name="ce1" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="@Model.Items.Count" table:number-rows-spanned="1">
      <text:p>@Model.DepartmentName 各系統大區管線長度暨附屬設備統計表(單位：公里)</text:p>
     </table:table-cell>
     if(@Model.Items.Count > 2)
    {
        <table:covered-table-cell table:number-columns-repeated="@(Model.Items.Count - 2)" table:style-name="ce1"/>
    }
     <table:table-cell table:style-name="ce21" office:value-type="string" calcext:value-type="string">
      <text:p><text:s/>(資料日期：@Model.Year 年10月31日)</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce653"/>
     <table:table-cell table:style-name="ce21"/>
     <table:table-cell table:style-name="ce653" office:value-type="string" calcext:value-type="string">
      <text:p>附.6</text:p>
     </table:table-cell>
    </table:table-row>
    <table:table-row table:style-name="ro2">
     <table:table-cell table:style-name="ce530" office:value-type="string" calcext:value-type="string">
      <text:p>供水系統</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce530" office:value-type="string" calcext:value-type="string">
      <text:p>管徑</text:p>
     </table:table-cell>
     @foreach(var ws in @Model.Items)
     {
       <table:table-cell table:style-name="ce619" office:value-type="string" calcext:value-type="string"><text:p>@ws.SiteName</text:p><text:p>(@ws.WaterSupplySystemName)</text:p>
       </table:table-cell>
     }
     <table:table-cell table:style-name="ce530" office:value-type="string" calcext:value-type="string">
      <text:p>小計</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce530" office:value-type="string" calcext:value-type="string">
      <text:p>管徑</text:p>
     </table:table-cell>
    </table:table-row>
    <table:table-row table:style-name="ro3">
     <table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="@(Model.PiepSiteDatas.Count + 1)">
      <text:p>管徑</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce582" office:value-type="string" calcext:value-type="string">
      <text:p>合計</text:p>
     </table:table-cell>
     @foreach(var length in Model.PiepSiteDatas.First().Lengthes)
     {
          <table:table-cell table:style-name="ce642" office:value-type="float" office:value="@length" calcext:value-type="float" />
     }
     <table:table-cell table:style-name="ce642" office:value-type="float" office:value="@Model.PiepSiteDatas.First().SubTotal" calcext:value-type="float" />

     <table:table-cell table:style-name="ce582" office:value-type="string" calcext:value-type="string">
      <text:p>合計</text:p>
     </table:table-cell>
    </table:table-row>
    @foreach(var item in  Model.PiepSiteDatas)
    {
        @if(item.Name == "合計") continue;
       <table:table-row table:style-name="ro3">
         <table:covered-table-cell table:style-name="ce3"/>
         <table:table-cell table:style-name="ce583" office:value-type="string" calcext:value-type="string">
          <text:p>@item.Name</text:p>
         </table:table-cell>
         @foreach(var length in item.Lengthes)
         {
              <table:table-cell table:style-name="ce646" office:value-type="float" office:value="@length" calcext:value-type="float" />
         }
        <table:table-cell table:style-name="ce646" office:value-type="float" office:value="@item.SubTotal" calcext:value-type="float" />
        <table:table-cell table:style-name="ce657" office:value-type="string" calcext:value-type="string">
            <text:p>@item.Name</text:p>
        </table:table-cell>
      </table:table-row>
    }
    
    
    <table:table-row table:style-name="ro3">
     <table:table-cell table:style-name="ce540"/>
     <table:table-cell table:style-name="ce587" office:value-type="string" calcext:value-type="string">
      <text:p>300折合</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce631" table:number-columns-repeated="@(Model.Items.Count + 1)"/>
     
     <table:table-cell table:style-name="ce587" office:value-type="string" calcext:value-type="string">
      <text:p>300折合</text:p>
     </table:table-cell>
    </table:table-row>
    <table:table-row table:style-name="ro3">
     <table:table-cell table:style-name="ce556" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="4">
      <text:p>附屬設備</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string">
      <text:p>制水閥</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce593" table:number-columns-repeated="@(Model.Items.Count + 1)"/>
     <table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string">
      <text:p>制水閥</text:p>
     </table:table-cell>
    </table:table-row>
    <table:table-row table:style-name="ro3">
     <table:covered-table-cell table:style-name="ce565"/>
     <table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string">
      <text:p>逆止閥</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce593" table:number-columns-repeated="@(Model.Items.Count + 1)"/>
     <table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string">
      <text:p>逆止閥</text:p>
     </table:table-cell>
    </table:table-row>
    <table:table-row table:style-name="ro3">
     <table:covered-table-cell table:style-name="ce565"/>
     <table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string">
      <text:p>排氣閥</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce593" table:number-columns-repeated="@(Model.Items.Count + 1)"/>
     <table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string">
      <text:p>排氣閥</text:p>
     </table:table-cell>
    </table:table-row>
    <table:table-row table:style-name="ro3">
     <table:covered-table-cell table:style-name="ce577"/>
     <table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string">
      <text:p>消火栓</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce593" table:number-columns-repeated="@(Model.Items.Count + 1)"/>
     <table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string">
      <text:p>消火栓</text:p>
     </table:table-cell>
    </table:table-row>
    <table:table-row table:style-name="ro3">
     <table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string">
      <text:p>備註</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce593" table:number-columns-repeated="@(Model.Items.Count + 3)"/>
    </table:table-row>
    <table:table-row table:style-name="ro4">
     <table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string">
      <text:p>說明</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce609" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="@(Model.Items.Count + 3)" table:number-rows-spanned="1">
      <text:p>本項資料(報表代號：FP705046[左])請洽總處室財產管理人員，請其增設檢漏業管「資料查詢/下載」之權限，自行進入匯出。</text:p>
     </table:table-cell>
     <table:covered-table-cell table:style-name="ce656"/>
     <table:covered-table-cell table:style-name="ce21"/>
    </table:table-row>
    <table:table-row table:style-name="ro3" table:number-rows-repeated="1048526">
     <table:table-cell table:number-columns-repeated="37"/>
    </table:table-row>
    <table:table-row table:style-name="ro3">
     <table:table-cell table:number-columns-repeated="37"/>
    </table:table-row>
   </table:table>
   <table:named-expressions/>
  </office:spreadsheet>
 </office:body>
</office:document>