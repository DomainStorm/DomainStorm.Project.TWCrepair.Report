@model DomainStorm.Project.TWCrepair.Report.Web.Views.RA010
@{
    Layout = null;
    var stylesPath = System.IO.Path.Combine(Directory.GetCurrentDirectory(), "Views", "RA010.head.xml");
    var head = await File.ReadAllTextAsync(stylesPath);
}
<?xml version="1.0" encoding="UTF-8"?>

<office:document xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:config="urn:oasis:names:tc:opendocument:xmlns:config:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:rpt="http://openoffice.org/2005/report" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:tableooo="http://openoffice.org/2009/table" xmlns:calcext="urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0" xmlns:drawooo="http://openoffice.org/2010/draw" xmlns:loext="urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:formx="urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:css3t="http://www.w3.org/TR/css3-text/" xmlns:presentation="urn:oasis:names:tc:opendocument:xmlns:presentation:1.0" office:version="1.4" office:mimetype="application/vnd.oasis.opendocument.spreadsheet">
    @Html.Raw(head)
 <office:body>
  <office:spreadsheet>
   <table:calculation-settings table:case-sensitive="false" table:automatic-find-labels="false" table:use-regular-expressions="false" table:use-wildcards="true"/>
   <table:table table:name="F" table:style-name="ta1" table:print-ranges="F.A1:F.L27">
    <office:forms form:automatic-focus="false" form:apply-design-mode="false"/>
    <table:table-column table:style-name="co1" table:default-cell-style-name="ce4"/>
    <table:table-column table:style-name="co2" table:default-cell-style-name="ce4"/>
    <table:table-column table:style-name="co3" table:default-cell-style-name="ce4"/>
    <table:table-column table:style-name="co4" table:default-cell-style-name="ce29"/>
    <table:table-column table:style-name="co5" table:number-columns-repeated="2" table:default-cell-style-name="ce29"/>
    <table:table-column table:style-name="co5" table:number-columns-repeated="2" table:default-cell-style-name="ce42"/>
    <table:table-column table:style-name="co5" table:number-columns-repeated="2" table:default-cell-style-name="ce56"/>
    <table:table-column table:style-name="co6" table:default-cell-style-name="ce4"/>
    <table:table-column table:style-name="co7" table:default-cell-style-name="ce4"/>
    <table:table-column table:style-name="co1" table:default-cell-style-name="ce4"/>
    <table:table-column table:style-name="co8" table:number-columns-repeated="16371" table:default-cell-style-name="Default"/>
    <table:table-header-rows>
     <table:table-row table:style-name="ro1">
      <table:table-cell table:style-name="ce514"/>
      <table:table-cell table:style-name="ce517" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="11" table:number-rows-spanned="1">
       <text:p>台灣自來水股份有限公司@($"{Model.DepartmentName}{Model.SiteName}")</text:p>
      </table:table-cell>
      <table:covered-table-cell table:style-name="ce526"/>
      <table:covered-table-cell table:number-columns-repeated="3" table:style-name="ce243"/>
      <table:covered-table-cell table:number-columns-repeated="2" table:style-name="ce297"/>
      <table:covered-table-cell table:number-columns-repeated="2" table:style-name="ce276"/>
      <table:covered-table-cell table:number-columns-repeated="2" table:style-name="ce526"/>
      <table:table-cell table:style-name="ce514" table:number-columns-repeated="16372"/>
     </table:table-row>
     <table:table-row table:style-name="ro2">
      <table:table-cell table:style-name="ce514"/>
      <table:table-cell table:style-name="ce7" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="7" table:number-rows-spanned="1">
       <text:p>單價分析表</text:p>
      </table:table-cell>
      <table:covered-table-cell table:style-name="ce7"/>
      <table:covered-table-cell table:number-columns-repeated="3" table:style-name="ce245"/>
      <table:covered-table-cell table:number-columns-repeated="2" table:style-name="ce298"/>
      <table:table-cell table:style-name="ce277" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="4" table:number-rows-spanned="1">
       <text:p>@Model.EngineeringName</text:p>
      </table:table-cell>
      <table:covered-table-cell table:style-name="ce287"/>
      <table:covered-table-cell table:number-columns-repeated="2" table:style-name="ce506"/>
      <table:table-cell table:style-name="ce514" table:number-columns-repeated="16372"/>
     </table:table-row>
    </table:table-header-rows>
    @foreach(var unitPrice in Model.BudgetDocUnitPrices)
    {
     <table:table-row table:style-name="ro3">
     <table:table-cell table:style-name="ce515"/>
     <table:table-cell table:style-name="ce519" office:value-type="string" calcext:value-type="string">
      <text:p>編碼 @unitPrice.Code</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce527" office:value-type="string" calcext:value-type="string">
      <text:p>工程項目</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce247" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="6" table:number-rows-spanned="1">
      <text:p>@unitPrice.Name</text:p>
     </table:table-cell>
     <table:covered-table-cell table:number-columns-repeated="2" table:style-name="ce254"/>
     <table:covered-table-cell table:number-columns-repeated="2" table:style-name="ce301"/>
     <table:covered-table-cell table:style-name="ce278"/>
     <table:table-cell table:style-name="ce288" office:value-type="string" calcext:value-type="string">
      <text:p>單位</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce573" office:value-type="string" calcext:value-type="string">
      <text:p>@(unitPrice.UnitAmount >1 ? unitPrice.UnitAmount : "" ) @unitPrice.Unit</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce671" office:value-type="string" calcext:value-type="string">
      <text:p>@(unitPrice.isCombine ? "組合單價" : unitPrice.Notes)</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce719"/>
     <table:table-cell table:number-columns-repeated="16371"/>
    </table:table-row>
    <table:table-row table:style-name="ro3">
     <table:table-cell table:style-name="ce516"/>
     <table:table-cell table:style-name="ce520" office:value-type="string" calcext:value-type="string">
      <text:p>工料項目</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce528" office:value-type="string" calcext:value-type="string">
      <text:p>說明</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce248" office:value-type="string" calcext:value-type="string">
      <text:p>單位</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce248" office:value-type="string" calcext:value-type="string">
      <text:p>日數量</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce248" office:value-type="string" calcext:value-type="string">
      <text:p>夜數量</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce302" office:value-type="string" calcext:value-type="string">
      <text:p>日單價</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce302" office:value-type="string" calcext:value-type="string">
      <text:p>夜單價</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce279" office:value-type="string" calcext:value-type="string">
      <text:p>日複價</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce289" office:value-type="string" calcext:value-type="string">
      <text:p>夜複價</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce577" office:value-type="string" calcext:value-type="string">
      <text:p>附註</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce673"/>
     <table:table-cell table:style-name="ce719"/>
     <table:table-cell table:number-columns-repeated="16371"/>
    </table:table-row>
    @if (!string.IsNullOrEmpty(unitPrice.OtherDescription))
    {
        <table:table-row table:style-name="ro3">
         <table:table-cell table:style-name="ce515"/>
         <table:table-cell table:style-name="ce521" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="5" table:number-rows-spanned="1">
          <text:p>@unitPrice.OtherDescription</text:p>
         </table:table-cell>
         <table:covered-table-cell table:style-name="ce530"/>
         <table:covered-table-cell table:number-columns-repeated="2" table:style-name="ce249"/>
         <table:covered-table-cell table:style-name="ce258"/>
         <table:table-cell table:style-name="ce303"/>
         <table:table-cell table:style-name="ce326"/>
         <table:table-cell table:style-name="ce280"/>
         <table:table-cell table:style-name="ce290"/>
         <table:table-cell table:style-name="ce581"/>
         <table:table-cell table:style-name="ce683"/>
         <table:table-cell table:style-name="ce719"/>
         <table:table-cell table:number-columns-repeated="16371"/>
        </table:table-row>
    }
    @foreach(var member in unitPrice.BudgetDocUnitPriceMembers)
    {
        <table:table-row table:style-name="ro3">
         <table:table-cell table:style-name="ce516"/>
         <table:table-cell table:style-name="ce523" office:value-type="string" calcext:value-type="string">
          <text:p>@member.Name</text:p>
         </table:table-cell>
         <table:table-cell table:style-name="ce531">
             <text:p>@member.Description</text:p>
         </table:table-cell>
         <table:table-cell table:style-name="ce250" office:value-type="string" calcext:value-type="string">
          <text:p>@member.Unit</text:p>
         </table:table-cell>
         <table:table-cell table:style-name="ce542" office:value-type="float" office:value="@member.DayAmount" calcext:value-type="float" />
         <table:table-cell table:style-name="ce542" office:value-type="float" office:value="@member.NightAmount" calcext:value-type="float" />
         <table:table-cell table:style-name="ce305" office:value-type="float" office:value="@member.DayUnitPrice" calcext:value-type="float"/>
         <table:table-cell table:style-name="ce327" office:value-type="float" office:value="@member.NightUnitPrice" calcext:value-type="float"/>
         <table:table-cell table:style-name="ce356" office:value-type="float" office:value="@member.DayPrice" calcext:value-type="float"/>
         <table:table-cell table:style-name="ce469" office:value-type="float" office:value="@member.NightPrice" calcext:value-type="float"/>
         <table:table-cell table:style-name="ce643" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="2" table:number-rows-spanned="1">
          <text:p>@member.Notes</text:p>
         </table:table-cell>
         <table:covered-table-cell table:style-name="ce75"/>
         <table:table-cell table:style-name="ce719"/>
         <table:table-cell table:number-columns-repeated="16371"/>
        </table:table-row>
    }
    for(var i = 20 - unitPrice.BudgetDocUnitPriceMembers.Count ; i>=0; i--)
    {
        <table:table-row table:style-name="ro3" table:visibility="collapse">
         <table:table-cell table:style-name="ce516"/>
         <table:table-cell table:style-name="ce523"/>
         <table:table-cell table:style-name="ce531"/>
         <table:table-cell table:style-name="ce250"/>
         <table:table-cell table:style-name="ce542" table:number-columns-repeated="2"/>
         <table:table-cell table:style-name="ce305"/>
         <table:table-cell table:style-name="ce327"/>
         <table:table-cell table:style-name="ce265" table:formula="of:=[.E24]*[.G24]" office:value-type="float" office:value="0" calcext:value-type="float">
          <text:p>0.00</text:p>
         </table:table-cell>
         <table:table-cell table:style-name="ce273" table:formula="of:=[.F24]*[.H24]" office:value-type="float" office:value="0" calcext:value-type="float">
          <text:p>0.00</text:p>
         </table:table-cell>
         <table:table-cell table:style-name="ce653"/>
         <table:table-cell table:style-name="ce75"/>
         <table:table-cell table:style-name="ce719"/>
         <table:table-cell table:number-columns-repeated="16371"/>
        </table:table-row>
    }
    
    
    <table:table-row table:style-name="ro3">
     <table:table-cell table:style-name="ce516"/>
     <table:table-cell table:style-name="ce523" office:value-type="string" calcext:value-type="string">
      <text:p>@(unitPrice.Tail != null ? unitPrice.Tail.Name : "")</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce531">
         <text:p>@(unitPrice.TailPersentage > 0 ? unitPrice.TailPersentage.ToString()!.TrimEnd('0').TrimEnd('.') + "%" :"")</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce250" office:value-type="string" calcext:value-type="string">
      <text:p>全</text:p>
     </table:table-cell>
     <table:table-cell table:number-columns-repeated="2" table:style-name="ce542" office:value-type="float" office:value="1" calcext:value-type="float">
      <text:p>1.000</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce305"/>
     <table:table-cell table:style-name="ce327"/>
     <table:table-cell table:style-name="ce267" office:value-type="float" office:value="@unitPrice.TailDayPrice" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce292" office:value-type="float" office:value="@unitPrice.TailNightPrice" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce643" table:number-columns-spanned="2" table:number-rows-spanned="1"/>
     <table:covered-table-cell table:style-name="ce75"/>
     <table:table-cell table:style-name="ce719"/>
     <table:table-cell table:number-columns-repeated="16371"/>
    </table:table-row>
    <table:table-row table:style-name="ro3">
     <table:table-cell table:style-name="ce515"/>
     <table:table-cell table:style-name="ce524" office:value-type="string" calcext:value-type="string">
      <text:p>小 計</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce533"/>
     <table:table-cell table:style-name="ce251"/>
     <table:table-cell table:style-name="ce544"/>
     <table:table-cell table:style-name="ce546"/>
     <table:table-cell table:style-name="ce305" table:number-columns-repeated="2"/>
     <table:table-cell table:style-name="ce563" office:value-type="float" office:value="@unitPrice.TotalDayPrice" calcext:value-type="float" />
     <table:table-cell table:style-name="ce563" office:value-type="float" office:value="@unitPrice.TotalNightPrice" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce656" table:number-columns-spanned="2" table:number-rows-spanned="1"/>
     <table:covered-table-cell table:style-name="ce700"/>
     <table:table-cell table:style-name="ce719"/>
     <table:table-cell table:number-columns-repeated="16371"/>
    </table:table-row>
    <table:table-row table:style-name="ro3">
     <table:table-cell table:style-name="ce515"/>
     <table:table-cell table:style-name="ce525" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="7" table:number-rows-spanned="1">
      <text:p>每 @unitPrice.Unit 單價計</text:p>
     </table:table-cell>
     <table:covered-table-cell table:style-name="ce534"/>
     <table:covered-table-cell table:number-columns-repeated="3" table:style-name="ce252"/>
     <table:covered-table-cell table:style-name="ce311"/>
     <table:covered-table-cell table:style-name="ce333"/>
     <table:table-cell table:style-name="ce564" office:value-type="float" office:value="@(unitPrice.TotalDayPrice/unitPrice.UnitAmount)" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce564" office:value-type="float" office:value="@(unitPrice.TotalNightPrice/unitPrice.UnitAmount)" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce670" table:number-columns-spanned="2" table:number-rows-spanned="1"/>
     <table:covered-table-cell table:style-name="ce702"/>
     <table:table-cell table:style-name="ce514" table:number-columns-repeated="16372"/>
    </table:table-row>
    }
    
    <table:table-row table:style-name="ro4" table:number-rows-repeated="1031774">
     <table:table-cell table:number-columns-repeated="16384"/>
    </table:table-row>
    <table:table-row table:style-name="ro5" table:number-rows-repeated="16774">
     <table:table-cell table:number-columns-repeated="16384"/>
    </table:table-row>
    <table:table-row table:style-name="ro5">
     <table:table-cell table:number-columns-repeated="16384"/>
    </table:table-row>
    <table:named-expressions>
     <table:named-range table:name="Excel_BuiltIn_Print_Area" table:base-cell-address="$F.$A$1" table:cell-range-address="$F.$A$1:.$L$27" table:range-usable-as="print-range"/>
     <table:named-range table:name="Excel_BuiltIn_Print_Titles" table:base-cell-address="$F.$A$1" table:cell-range-address="$F.$1:.$2" table:range-usable-as="repeat-column repeat-row"/>
    </table:named-expressions>
   </table:table>
   <table:named-expressions/>
  </office:spreadsheet>
 </office:body>
</office:document>