@using Microsoft.AspNetCore.Html
@model DomainStorm.Project.TWCrepair.Report.Web.Views.RA032
@{
    Layout = null;
    var stylesPath = System.IO.Path.Combine(Directory.GetCurrentDirectory(), "Views", "RA032.head.xml");
    var head = await File.ReadAllTextAsync(stylesPath);
}
<?xml version="1.0" encoding="UTF-8"?>

<office:document xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:config="urn:oasis:names:tc:opendocument:xmlns:config:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:rpt="http://openoffice.org/2005/report" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:tableooo="http://openoffice.org/2009/table" xmlns:calcext="urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0" xmlns:drawooo="http://openoffice.org/2010/draw" xmlns:loext="urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:formx="urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:css3t="http://www.w3.org/TR/css3-text/" xmlns:presentation="urn:oasis:names:tc:opendocument:xmlns:presentation:1.0" office:version="1.4" office:mimetype="application/vnd.oasis.opendocument.spreadsheet">
    @Html.Raw(head)
 <office:body>
  <office:spreadsheet>
   <table:calculation-settings table:case-sensitive="false" table:automatic-find-labels="false" table:use-regular-expressions="false" table:use-wildcards="true"/>
   <table:table table:name="附表二、檢漏工作計劃表" table:style-name="ta1">
    <office:forms form:automatic-focus="false" form:apply-design-mode="false"/>
    <table:table-column table:style-name="co1" table:default-cell-style-name="ce224"/>
    <table:table-column table:style-name="co2" table:default-cell-style-name="ce224"/>
    <table:table-column table:style-name="co3" table:number-columns-repeated="7" table:default-cell-style-name="ce224"/>
    <table:table-column table:style-name="co4" table:default-cell-style-name="ce224"/>
    <table:table-column table:style-name="co5" table:default-cell-style-name="ce224"/>
    <table:table-column table:style-name="co6" table:number-columns-repeated="8" table:default-cell-style-name="ce224"/>
    <table:table-column table:style-name="co7" table:number-columns-repeated="236" table:default-cell-style-name="ce224"/>
    <table:table-column table:style-name="co7" table:number-columns-repeated="16127" table:default-cell-style-name="Default"/>
    <table:table-row table:style-name="ro1">
     <table:table-cell table:style-name="ce415" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="19" table:number-rows-spanned="1">
      <text:p>附表二</text:p>
     </table:table-cell>
     <table:covered-table-cell table:number-columns-repeated="2" table:style-name="ce442"/>
     <table:covered-table-cell table:style-name="ce434"/>
     <table:covered-table-cell table:number-columns-repeated="15" table:style-name="ce442"/>
     <table:table-cell table:number-columns-repeated="16363"/>
    </table:table-row>
    <table:table-row table:style-name="ro1">
     <table:table-cell table:style-name="ce416" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="19" table:number-rows-spanned="1">
      <text:p>台水 @Model.DepartmentName @Model.Year 年檢漏工作計劃表</text:p>
     </table:table-cell>
     <table:covered-table-cell table:number-columns-repeated="18" table:style-name="ce443"/>
     <table:table-cell table:number-columns-repeated="16363"/>
    </table:table-row>
    <table:table-row table:style-name="ro1">
     <table:table-cell table:style-name="ce417" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="3"><text:p>現有人力</text:p><text:p>人員數</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce394" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="3">
      <text:p>工作區</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce431" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="3">
      <text:p>最小流量率降低數(%)</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce431" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="3">
      <text:p>與辦公廳距離(KM)</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce26" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="3" table:number-rows-spanned="1">
      <text:p>工作區</text:p>
     </table:table-cell>
     <table:covered-table-cell table:number-columns-repeated="2" table:style-name="ce26"/>
     <table:table-cell table:style-name="ce26" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="2" table:number-rows-spanned="1">
      <text:p>地下漏水檢漏件數</text:p>
     </table:table-cell>
     <table:covered-table-cell table:style-name="ce26"/>
     <table:table-cell table:style-name="ce394" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="3">
      <text:p>有效年數</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce431" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="3"><text:p><text:span text:style-name="T1">生產成本</text:span><text:span text:style-name="T2">   (</text:span><text:span text:style-name="T3">元</text:span><text:span text:style-name="T2">/M</text:span><text:span text:style-name="T4">3</text:span><text:span text:style-name="T5">)</text:span></text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce431" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="3"><text:p><text:span text:style-name="T1">檢出地下漏水</text:span><text:span text:style-name="T2">(CMD)</text:span></text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce26" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="4" table:number-rows-spanned="1">
      <text:p>檢漏作業總經費</text:p>
     </table:table-cell>
     <table:covered-table-cell table:number-columns-repeated="3" table:style-name="ce26"/>
     <table:table-cell table:style-name="ce26" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="2" table:number-rows-spanned="1">
      <text:p>檢漏成本</text:p>
     </table:table-cell>
     <table:covered-table-cell table:style-name="ce26"/>
     <table:table-cell table:style-name="ce457" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="3">
      <text:p>效益額(元)</text:p>
     </table:table-cell>
     <table:table-cell table:number-columns-repeated="16363"/>
    </table:table-row>
    <table:table-row table:style-name="ro1">
     <table:covered-table-cell table:style-name="ce418" office:value-type="string" calcext:value-type="string">
      <text:p>師</text:p>
     </table:covered-table-cell>
     <table:covered-table-cell table:style-name="ce15"/>
     <table:covered-table-cell table:number-columns-repeated="2" table:style-name="ce432"/>
     <table:table-cell table:style-name="ce15" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="2" table:number-rows-spanned="1">
      <text:p>配水管長</text:p>
     </table:table-cell>
     <table:covered-table-cell table:style-name="ce15"/>
     <table:table-cell table:style-name="ce386" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="2">
      <text:p>用戶數</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce386" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="2">
      <text:p>管線</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce386" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="2">
      <text:p>用戶外線</text:p>
     </table:table-cell>
     <table:covered-table-cell table:style-name="ce15"/>
     <table:covered-table-cell table:number-columns-repeated="2" table:style-name="ce432"/>
     <table:table-cell table:style-name="ce386" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="2">
      <text:p>作業費</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce386" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="2">
      <text:p>用人費</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce386" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="2">
      <text:p>器具折舊</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce386" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="2">
      <text:p>合計</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce386" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="2">
      <text:p>元/CMD</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce386" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="1" table:number-rows-spanned="2">
      <text:p>元/KM</text:p>
     </table:table-cell>
     <table:covered-table-cell table:style-name="ce461"/>
     <table:table-cell table:number-columns-repeated="16363"/>
    </table:table-row>
    <table:table-row table:style-name="ro1">
     <table:covered-table-cell table:style-name="ce435"/>
     <table:covered-table-cell table:number-columns-repeated="3" table:style-name="ce16"/>
     <table:table-cell table:style-name="ce16" office:value-type="string" calcext:value-type="string">
      <text:p>KM</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce16" office:value-type="string" calcext:value-type="string">
      <text:p>%</text:p>
     </table:table-cell>
     <table:covered-table-cell table:number-columns-repeated="12" table:style-name="ce16"/>
     <table:covered-table-cell table:style-name="ce462"/>
     <table:table-cell table:number-columns-repeated="16363"/>
    </table:table-row>
    @if(Model.SumItem != null)
    {
        <table:table-row table:style-name="ro2">
         <table:table-cell table:style-name="ce436"/>
         <table:table-cell table:style-name="ce428" table:number-columns-repeated="3"/>
         <table:table-cell table:style-name="ce455" office:value-type="float" office:value="@Model.SumItem.PlanPipeLength" calcext:value-type="float" />
         <table:table-cell table:style-name="ce455" office:value-type="float" office:value="0" calcext:value-type="float" />
         <table:table-cell table:style-name="ce455"  office:value-type="float" office:value="@Model.SumItem.CustomerAmount" calcext:value-type="float"/>
         <table:table-cell table:style-name="ce455" office:value-type="float" office:value="@Model.SumItem.CheckOutAmountDistributionPipe" calcext:value-type="float"/>
         <table:table-cell table:style-name="ce455" office:value-type="float" office:value="@Model.SumItem.CheckOutAmountOutdoorPipe" calcext:value-type="float"/>
         <table:table-cell table:style-name="ce455" office:value-type="float" office:value="@Model.SumItem.EfficientYear" calcext:value-type="float"/>
         <table:table-cell table:style-name="ce455" office:value-type="float" office:value="@Model.SumItem.ProductionCost" calcext:value-type="float"/>
         <table:table-cell table:style-name="ce455" office:value-type="float" office:value="@Model.SumItem.CheckOutCMD" calcext:value-type="float"/>
         <table:table-cell table:style-name="ce455" office:value-type="float" office:value="@Model.SumItem.OperationExpense" calcext:value-type="float"/>
         <table:table-cell table:style-name="ce455" office:value-type="float" office:value="@Model.SumItem.PersonnelExpense" calcext:value-type="float"/>
         <table:table-cell table:style-name="ce455" office:value-type="float" office:value="@Model.SumItem.DepreciationExpense" calcext:value-type="float"/>
         <table:table-cell table:style-name="ce455" office:value-type="float" office:value="@Model.SumItem.CheckOutTotalExpense" calcext:value-type="float"/>
         <table:table-cell table:style-name="ce455" office:value-type="float" office:value="@Model.SumItem.CheckOutCostPerCMD" calcext:value-type="float"/>
         <table:table-cell table:style-name="ce455" office:value-type="float" office:value="@Model.SumItem.CheckOutCostPerKm" calcext:value-type="float"/>
         <table:table-cell table:style-name="ce469" office:value-type="float" office:value="@Model.SumItem.BenefitAmount" calcext:value-type="float"/>
         <table:table-cell table:number-columns-repeated="16363"/>
          </table:table-row>
     }
     @foreach (var item in Model.Items)
     {
     <table:table-row table:style-name="ro2">
     <table:table-cell table:style-name="ce421" office:value-type="float" office:value="@item.CurrentPeople" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce15" office:value-type="string" calcext:value-type="string">
      <text:p>@item.WorkSpaceName</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce390" office:value-type="float" office:value="@item.LeakageLowerTarget" calcext:value-type="float" />
     <table:table-cell table:style-name="ce438" office:value-type="string" calcext:value-type="string">
      <text:p>@item.Distance<text:s text:c="14"/></text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce390" office:value-type="float" office:value="@item.PlanPipeLength" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce449" office:value-type="string" calcext:value-type="string">
      <text:p>@(item.PipeLengthPercentage)%</text:p>
     </table:table-cell>
     <table:table-cell table:style-name="ce383" office:value-type="float" office:value="@item.CustomerAmount" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce390" office:value-type="float" office:value="@item.CheckOutAmountDistributionPipe" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce390" office:value-type="float" office:value="@item.CheckOutAmountOutdoorPipe" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce390" office:value-type="float" office:value="@item.EfficientYear" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce390" office:value-type="float" office:value="@item.ProductionCost" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce383" office:value-type="float" office:value="@item.CheckOutCMD" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce383" office:value-type="float" office:value="@item.OperationExpense" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce383" office:value-type="float" office:value="@item.PersonnelExpense" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce383" office:value-type="float" office:value="@item.DepreciationExpense" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce383" office:value-type="float" office:value="@item.CheckOutTotalExpense" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce383" office:value-type="float" office:value="@item.CheckOutCostPerCMD" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce383" office:value-type="float" office:value="@item.CheckOutCostPerKm" calcext:value-type="float"/>
     <table:table-cell table:style-name="ce464" office:value-type="float" office:value="@item.BenefitAmount" calcext:value-type="float"/>
     <table:table-cell table:number-columns-repeated="16363"/>
    </table:table-row>
    }
    
    <table:table-row table:style-name="ro2" table:number-rows-repeated="8">
     <table:table-cell table:style-name="ce423"/>
     <table:table-cell table:style-name="ce430" table:number-columns-repeated="3"/>
     <table:table-cell table:style-name="ce433" table:number-columns-repeated="2"/>
     <table:table-cell table:style-name="ce430" table:number-columns-repeated="12"/>
     <table:table-cell table:style-name="ce468"/>
     <table:table-cell table:number-columns-repeated="16363"/>
    </table:table-row>
    <table:table-row table:style-name="ro3" table:number-rows-repeated="1048555">
     <table:table-cell table:number-columns-repeated="16382"/>
    </table:table-row>
    <table:table-row table:style-name="ro3">
     <table:table-cell table:number-columns-repeated="16382"/>
    </table:table-row>
   </table:table>
   <table:named-expressions/>
  </office:spreadsheet>
 </office:body>
</office:document>