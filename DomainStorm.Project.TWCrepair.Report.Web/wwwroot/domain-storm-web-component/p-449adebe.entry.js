import{r as t,c as e,a as s,f as i,h,H as o}from"./p-CQNG65Br.js";import{a}from"./p-tR-hyYiS.js";import{S as l}from"./p-CAnyxfG4.js";import{c as n,d as r,s as c,a as d,v as u,r as b,g as m,i as p,b as f,p as g}from"./p-CH__wnBt.js";import{d as w,c as C}from"./p-9Du3dL5x.js";import"./p-E-ZsRS8r.js";const y=class{constructor(s){t(this,s),this.pageNumberChange=e(this,"pageNumberChange"),this.pageSizeChange=e(this,"pageSizeChange"),this.sortChange=e(this,"sortChange"),this.searchChanged=e(this,"searchChanged"),this.tableWillRender=e(this,"tableWillRender"),this.rowMove=e(this,"rowMove"),this.rowWillSelect=e(this,"rowWillSelect"),this.rowWillUnselect=e(this,"rowWillUnselect"),this.rowSelect=e(this,"rowSelect"),this.rowUnselect=e(this,"rowUnselect"),this.rowDidSelect=e(this,"rowDidSelect"),this.rowDidUnselect=e(this,"rowDidUnselect"),this.rowSelectChange=e(this,"rowSelectChange"),this.selectWillChange=e(this,"selectWillChange"),this.selectChange=e(this,"selectChange"),this.selectDidChange=e(this,"selectDidChange"),this.checkWillChange=e(this,"checkWillChange"),this.checkChange=e(this,"checkChange"),this.checkDidChange=e(this,"checkDidChange"),this.cellWillCheck=e(this,"cellWillCheck"),this.cellWillUncheck=e(this,"cellWillUncheck"),this.cellCheck=e(this,"cellCheck"),this.cellUncheck=e(this,"cellUncheck"),this.cellDidCheck=e(this,"cellDidCheck"),this.cellDidUncheck=e(this,"cellDidUncheck"),this.cellCheckChange=e(this,"cellCheckChange"),this.clickRow=e(this,"clickRow")}_logger=n();__columns;__pageDate;__cellCheckChangeTimeoutRafId={};__bodyRef;__selectedInfoRef;__breakpoints=[{size:"4xs",width:239},{size:"3xs",width:359},{size:"xxs",width:479},{size:"xs",width:576},{size:"sm",width:768},{size:"md",width:992},{size:"lg",width:1200},{size:"xl",width:1400},{size:"xxl",width:1600},{size:"3xl",width:1920},{size:"4xl",width:1/0}];get host(){return s(this)}fieldId="id";fieldSelected="__selected";fieldIndex="__index";pagination=!1;sidePagination="stencil";searchable=!1;pageSizeMenu=!0;pageInfo=!0;selectedInfo=!0;escape=!0;classes;layout="fixed";cellTemplate="{value}";clickRowTo;selection="single";pageList=[5,10,15,20,25];tableHeight;columns;dataSet;pageNumber=1;pageSize=10;searchText;sortName;sortOrder;groupBy;totalRows;totalSelected;checkedItemsSum;isColumnResponsive=!1;expand={visibleColumnCount:0};timeStamp;pageNumberChange;pageSizeChange;sortChange;searchChanged;tableWillRender;rowMove;rowWillSelect;rowWillUnselect;rowSelect;rowUnselect;rowDidSelect;rowDidUnselect;rowSelectChange;selectWillChange;selectChange;selectDidChange;checkWillChange;checkChange;checkDidChange;cellWillCheck;cellWillUncheck;cellCheck;cellUncheck;cellDidCheck;cellDidUncheck;cellCheckChange;clickRow;watchDataSetHandler(t,e){this.timeStamp=Date.now(),r(t,e)||(this.initDataSet(),this.rerender())}async watchColumnsHandler(t,e){r(t,e)||this.initColumns()}watchTotalSelectedHandler(t,e){this.debouncedDisplaySelectedCount()}searchChangedHandler(t){"stencil"===this.sidePagination?this.searchText=t.detail:this.tableWillRender.emit({pageNumber:this.pageNumber,pageSize:this.pageSize,sortName:this.sortName,sortOrder:this.sortOrder,searchText:t.detail})}pageNumberChangeHandler(t){"stencil"===this.sidePagination?this.pageNumber=t.detail:this.tableWillRender.emit({pageNumber:t.detail,pageSize:this.pageSize,sortName:this.sortName,sortOrder:this.sortOrder,searchText:this.searchText})}pageSizeChangeHandler(t){"stencil"===this.sidePagination?this.pageSize=t.detail:this.tableWillRender.emit({pageNumber:this.pageNumber,pageSize:t.detail,sortName:this.sortName,sortOrder:this.sortOrder,searchText:this.searchText})}sortChangeHandler(t){"stencil"===this.sidePagination?(this.sortName=t.detail.sortName,this.sortOrder=t.detail.sortOrder):this.tableWillRender.emit({pageNumber:this.pageNumber,pageSize:this.pageSize,sortName:t.detail.sortName,sortOrder:t.detail.sortOrder,searchText:this.searchText})}async rowWillSelectHandler(t){"stencil"===this.sidePagination&&("single"===this.selection&&await this.unselectAll(),this.rowSelect.emit(t.detail))}async rowSelectHandler(t){const e=await this.getRowById(t.detail);c(e,this.fieldSelected,!0),this.__bodyRef.updateRowSelection(e),this.rowDidSelect.emit(e)}rowDidSelectHandler(t){this.rowSelectChange.emit(t.detail)}rowWillUnselectHandler(t){"stencil"===this.sidePagination&&this.rowUnselect.emit(t.detail)}async rowUnselectHandler(t){const e=await this.getRowById(t.detail);c(e,this.fieldSelected,!1),this.__bodyRef.updateRowSelection(e),this.rowDidUnselect.emit(e)}rowDidUnselectHandler(t){this.rowSelectChange.emit(t.detail)}rowSelectChangeHandler(t){this.debouncedRowSelectionUpdate()}async selectWillChangeHandler(t){if("stencil"===this.sidePagination){const t=await this.getSelected();this.selectChange.emit(t.length)}}selectChangeHandler(t){this.totalSelected=t.detail,this.debouncedDisplaySelectedCount(),this.selectDidChange.emit(t.detail)}async cellWillCheckHandler(t){if("stencil"===this.sidePagination){const e=await this.getColumnByField(t.detail.field);"radio"===e.type&&await this.uncheckAll(e.field),this.cellCheck.emit(t.detail)}}async cellCheckHandler(t){const e=await this.getColumnByField(t.detail.field),s=await this.getRowById(t.detail.id);c(s,e.field,!0),this.__bodyRef.updateRowCheckbox(s,e),this.cellDidCheck.emit({row:s,column:e})}cellDidCheckHandler(t){this.cellCheckChange.emit(t.detail)}cellWillUncheckHandler(t){"stencil"===this.sidePagination&&this.cellUncheck.emit(t.detail)}async cellUncheckHandler(t){const e=await this.getColumnByField(t.detail.field),s=await this.getRowById(t.detail.id);c(s,e.field,!1),this.__bodyRef.updateRowCheckbox(s,e),this.cellDidUncheck.emit({row:s,column:e})}cellDidUncheckHandler(t){this.cellCheckChange.emit(t.detail)}cellCheckChangeHandler(t){const e=t.detail.column,s=this.__cellCheckChangeTimeoutRafId[e.field];s&&(clearTimeout(s),delete this.__cellCheckChangeTimeoutRafId[e.field]),this.__cellCheckChangeTimeoutRafId[e.field]=setTimeout((()=>{delete this.__cellCheckChangeTimeoutRafId[e.field],this.checkWillChange.emit(e.field)}),100)}async checkWillChangeHandler(t){if("stencil"===this.sidePagination){const e=await this.getChecked(t.detail);this.checkChange.emit({total:e.length,field:t.detail})}}async checkChangeHandler(t){this.setCheckedItemsSum(t.detail.field,t.detail.total),t.detail.field===this.fieldSelected&&(this.totalSelected=t.detail.total);const e=await this.getColumnByField(t.detail.field);await this.__bodyRef.updateColumnCheckbox(e),this.checkDidChange.emit({total:t.detail.total,column:e})}async clickCellHandler(t){const e=await this.getColumnByField(t.detail.field);"checkbox"===e.type||"radio"===e.type?await this.checkClick(t.detail.id,t.detail.field):this.clickRow.emit(t.detail.id)}async clickRowHandler(t){if("check"===this.clickRowTo)await this.checkClick(t.detail,this.fieldSelected);else if("select"===this.clickRowTo){const e=await this.getRowById(t.detail);d(e,this.fieldSelected)?this.unselect(t.detail):this.select(t.detail)}}async moveRow(t,e){!function(t,e,s){const i=e<0?t.length+e:e;if(i>=0&&i<t.length){const i=s<0?t.length+s:s,[h]=t.splice(e,1);t.splice(i,0,h)}}(this.dataSet,t,e),this.dataSet.forEach(((t,e)=>{const s=d(t,this.fieldIndex);s!==e&&(this.rowMove.emit({row:t,from:s,to:e}),c(t,this.fieldIndex,e))})),this.rerender()}async dispatchCustomEvent(t,e){this[t]&&"function"==typeof this[t].emit&&this[t].emit(e)}async dispatchCellCustomEvent(t,e){const s=this.host.shadowRoot?.querySelector('tr[data-id="'+e.id+'"] storm-table-cell[data-field="'+e.field+'"]');await s.dispatchCustomEvent(t,e)}async getRowAt(t){return this.dataSet.find((e=>d(e,this.fieldIndex)===t))}async getRowById(t){return"object"==typeof t?t:this.dataSet.find((e=>d(e,this.fieldId)===t))}async getColumnByField(t){return"object"==typeof t?t:this.__columns.find((e=>e.field===t))}async getSelected(){if("stencil"!==this.sidePagination)return null;const t=this.dataSet||[],e=[];for(const s of t){const t=d(s,this.fieldSelected);if(null!=t&&!0===t){const t=d(s,this.fieldId);null!=t&&e.push(u(t))}}return e}async getChecked(t){if("stencil"!==this.sidePagination)return null;const e=await this.getColumnByField(t);if(!e||!e.field)return[];const s=this.dataSet||[],i=[];for(const t of s){const s=d(t,e.field);if(null!=s&&!0===s){const e=d(t,this.fieldId);null!=e&&i.push(String(e))}}return i}async select(t){this.rowWillSelect.emit(t)}async selectAll(){this.dataSet.filter((t=>!d(t,this.fieldSelected))).forEach((t=>{this.select(d(t,this.fieldId))}))}async unselect(t){this.rowWillUnselect.emit(t)}async unselectAll(){this.dataSet.filter((t=>d(t,this.fieldSelected))).forEach((t=>{this.unselect(d(t,this.fieldId))}))}async check(t,e){const s=await this.getRowById(t);d(s,e)||this.cellWillCheck.emit({id:t,field:e})}async uncheck(t,e){const s=await this.getRowById(t);d(s,e)&&this.cellWillUncheck.emit({id:t,field:e})}async checkAll(t){const e=await this.getColumnByField(t),s=this.dataSet.filter((e=>!d(e,t)));for(const i of s){const s=await this.resolveColumnData(e,[i,d(i,this.fieldIndex),e]);s&&s.disabled||this.check(d(i,this.fieldId),t)}}async uncheckAll(t){const e=await this.getColumnByField(t),s=this.dataSet.filter((e=>d(e,t)));for(const i of s){const s=await this.resolveColumnData(e,[i,d(i,this.fieldIndex),e]);s&&s.disabled||this.uncheck(d(i,this.fieldId),t)}}async resolveColumnData(t,e){const s=b(t,"data",e);return s instanceof Promise?await s:s}rerender=w((async()=>{this.timeStamp=Date.now(),i(this)}),50);debouncedDisplaySelectedCount=w((async()=>{if(!this.isSelectedInfoVisible()||!this.__selectedInfoRef)return;const t=this.totalSelected?`已選取 ${this.totalSelected} 筆`:"";this.__selectedInfoRef.innerHTML!==t&&(this.__selectedInfoRef.innerHTML=t)}),50);debouncedRowSelectionUpdate=w((async()=>{this.selectWillChange.emit()}),500);async checkClick(t,e){const s=await this.getColumnByField(e),i=await this.getRowById(t);if(d(i,s.field)){if(!("radio"!==s.type||s.data&&s.data.unchecked))return;this.uncheck(t,s.field)}else this.check(t,s.field)}isPaginationVisible(){return this.__columns&&this.pageInfo&&this.pagination&&this.__pageDate&&this.__pageDate.length>0}isPageSizeMenuVisible(){return this.pageSizeMenu&&this.isPaginationVisible()}isSelectedInfoVisible(){return this.selectedInfo&&null!=this.clickRowTo}getCheckedItemsSum(t){return this.checkedItemsSum?this.checkedItemsSum[t]??0:0}handleSearchChanged(t){t.stopPropagation();const e=t.detail?.trim();this.searchText!==e&&this.searchChanged.emit(e)}handleColumnCheckChange(t,e){t.target.checked?this.checkAll(e.field):this.uncheckAll(e.field)}handleColumnClick(t){t.sortable&&this.sortChange.emit(t.field===this.sortName?"desc"===this.sortOrder?{sortName:void 0,sortOrder:void 0}:{sortName:this.sortName,sortOrder:"desc"}:{sortName:t.field,sortOrder:"asc"})}renderPagination(){if(this.isPaginationVisible())return h("div",{class:"table-pagination"},h("storm-pagination",{"page-number":this.pageNumber,"total-pages":Math.ceil(this.totalRows/this.pageSize),onPageChange:t=>{this.pageNumberChange.emit(t.detail)}}))}renderPageSizeMenu(){if(this.isPageSizeMenuVisible())return h("div",{class:"table-pageSizeMenu"},h("label",null,"顯示"," ",h("select",{class:"table-selector",onChange:t=>this.pageSizeChange.emit(Number(t.currentTarget.value))},this.pageList.map((t=>h("option",{value:t,selected:this.pageSize===t},t))))," ","筆結果"))}renderSearch(){if(this.searchable)return h("div",{class:"table-search"},h(a,{placeholder:"請輸入關鍵字",onValueChanged:t=>this.handleSearchChanged(t)}))}renderPageInfo(){if(this.pageInfo)return h("div",{class:"table-pageInfo"},this.searchable&&this.searchText?`篩選 ${this.__pageDate.length} 筆，`:"",this.pagination&&this.__pageDate.length>0?`顯示第 ${(this.pageNumber-1)*this.pageSize+1} 至 ${Math.min(this.totalRows,this.pageNumber*this.pageSize)} 筆，`:"","共 ",this.totalRows," 筆")}renderSelectedInfo(){if(this.isSelectedInfoVisible())return h("div",{ref:t=>this.__selectedInfoRef=t,class:"table-selectedInfo"})}renderTableTop(){if(this.isPageSizeMenuVisible()||this.searchable)return h("div",{class:"table-top p-1"},this.renderPageSizeMenu(),this.renderSearch())}renderTableBottom(){if(this.isSelectedInfoVisible()||this.isPaginationVisible())return h("div",{class:"table-bottom p-1"},this.renderPageInfo(),this.renderSelectedInfo(),this.renderPagination())}initDataSet(){this.dataSet?.length&&this.__columns?.length&&("stencil"===this.sidePagination?this.initDataSetStencil():this.initDataSetRazor())}initDataSetStencil(){const t=this.__columns.filter((t=>"checkbox"===t.type||"radio"===t.type)),e=this.initColumnCheckedCounts(t);this.sortData(this.dataSet);const s=this.fieldId,i=this.fieldIndex,h=this.fieldSelected;let o=0;const a=this.dataSet.length;for(let l=0;l<a;l++){const a=this.dataSet[l];this.ensureRowFields(a,s,i,h,l),this.handleCheckboxRadioColumns(a,t,e,!0),this.isRowSelected(a,h)&&o++}this.finalizeDataSet(!0,o,a,t,e)}initDataSetRazor(){const t=this.__columns.filter((t=>"checkbox"===t.type||"radio"===t.type)),e=this.initColumnCheckedCounts(t);this.sortData(this.dataSet);const s=this.fieldId,i=this.fieldIndex,h=this.fieldSelected,o=this.dataSet.length;for(let a=0;a<o;a++){const o=this.dataSet[a];this.ensureRowFields(o,s,i,h,a),this.handleCheckboxRadioColumns(o,t,e,!1)}this.finalizeDataSet(!1,0,o,t,e)}initColumnCheckedCounts(t){const e=new Map;for(const s of t)e.set(s.field,0);return e}ensureRowFields(t,e,s,i,h){null==d(t,e)&&c(t,e,m("row")),null==d(t,s)&&c(t,s,h),null==d(t,i)&&c(t,i,!1)}handleCheckboxRadioColumns(t,e,s,i){for(const h of e){const e=d(t,h.field);null==e?c(t,h.field,!1):i&&e&&s.set(h.field,s.get(h.field)+1)}}isRowSelected(t,e){return!!d(t,e)}finalizeDataSet(t,e,s,i,h){if(t){if(this.totalSelected=e,this.totalRows=s,i.length>0)for(const[t,e]of h)this.setCheckedItemsSum(t,e)}else this.checkedItemsSum=null}initColumns(){if(!this.columns)return;this.__columns=this.flattenColumnsRecursive(this.columns);const t=this.__columns.some((t=>t.children?.length))?this.getHeaderDepth(this.__columns):1;if(this.__columns.forEach(((e,s)=>{this.initColumn(e,s,t,1)})),this.__columns.some((t=>!0===t.responsive))&&(this.isColumnResponsive=!0,this.__columns.unshift({type:"detail"})),this.expand.visibleColumnCount=this.__columns.filter((t=>!1!==t.visible)).length,"check"===this.clickRowTo){const t=this.__columns.find((t=>"checkbox"===t.type||"radio"===t.type));!t||this.fieldSelected&&"__selected"!==this.fieldSelected||(this.fieldSelected=t.field?.toString())}this.dataSet?this.initDataSet():this.tableWillRender.emit({pageNumber:this.pageNumber,pageSize:this.pageSize,sortName:this.sortName,sortOrder:this.sortOrder,searchText:this.searchText})}flattenColumnsRecursive(t,e=1){if(!t?.length)return[];const s=C()(t),i=[];for(const t of s)t.__depth=e,i.push(t),t.children?.length&&i.push(...this.flattenColumnsRecursive(t.children,e+1));return i}initColumn(t,e,s,i){this.initColumnSpan(t,e,s,i),this.initColumnType(t,e),this.initColumnRender(t),this.initColumnResponsive(t),this.initColumnData(t)}initColumnSpan(t,e,s,i){t.headerRowspan=t.children?.length?1:s-i+1,t.headerColspan=this.getColspan(t)}initColumnType(t,e){t.type??="text",null!=t.cellType&&"string"==typeof t.cellType&&p(t.cellType)&&(t.cellType=f(t.cellType)),"action"!==t.type&&(t.field??=["checkbox","radio"].includes(t.type)?m(t.type):e,t.align??=["checkbox","radio","serialNumber"].includes(t.type)?"center":"left",t.searchable??=this.searchable)}initColumnRender(t){"string"==typeof t.render&&p(t.render)&&(t.render=f(t.render))}initColumnResponsive(t){const e=t.classes??{},s=Object.entries(e).filter((([t,e])=>t.startsWith("d-table-")&&"d-table-none"!==t&&"d-table-cell"!==t&&!0===e));if(0===s.length)return;t.responsive=!0,t.rwdClassReversal={};const i=s.some((([t])=>t.endsWith("-none"))),h=s.some((([t])=>t.endsWith("-cell")));!i||!h&&h||(t.rwdClassReversal["d-table-none"]=!0!==e["d-table-none"]),this.initColumnRwdClassReversal(t,s)}initColumnRwdClassReversal(t,e){for(const[s]of e)if(s.endsWith("-cell")){const e=s.replace(/-cell$/,"-none");t.rwdClassReversal[e]=!0}else if(s.endsWith("-none")){const e=s.replace(/-none$/,"-cell");t.rwdClassReversal[e]=!0}}initColumnData(t){"string"==typeof t.data&&(p(t.data)?t.data=f(t.data):t.data.startsWith("{")&&t.data.endsWith("}")&&this.parseColumnDataJson(t))}parseColumnDataJson(t){t.data=JSON.parse(t.data)}getHeaderDepth(t,e=1){let s=e;for(const i of t)if(i.children?.length){const t=this.getHeaderDepth(i.children,e+1);t>s&&(s=t)}return s}getColspan(t){return"number"==typeof t.headerColspan?t.headerColspan:Array.isArray(t.children)&&0!==t.children.length?t.children.reduce(((t,e)=>t+this.getColspan(e)),0):1}_resizeObserver;responsiveResize(){this._resizeObserver||(this._resizeObserver=new ResizeObserver((t=>{const e=t[0];if(e){const{width:t}=e.contentRect;this.refreshColumnVisibility(t)}})),this._resizeObserver.observe(this.host))}_breakpointIndex;refreshColumnVisibility=w((t=>{this._logger("refreshColumnVisibility",t);const e=this.host.shadowRoot?.querySelector("table");if(!e)return;if(null!=this._breakpointIndex){const e=this.__breakpoints[this._breakpointIndex-1];if(t<this.__breakpoints[this._breakpointIndex].width&&e&&t>=e.width)return}let s;const i=this.__breakpoints.length;for(let e=0;e<i;e++){const{width:h}=this.__breakpoints[e];if(t>=h&&(e===i-1||t<this.__breakpoints[e+1].width)){s=e;break}}if(void 0!==s)for(let t=0;t<i;t++)e.classList.toggle(`storm-table-${this.__breakpoints[t].size}`,t===s);this._breakpointIndex=s;const h=[];let o=!1;const a=this.__columns.length;for(let t=0;t<a;t++){const e=this.__columns[t],s=this.isColumnVisible(e);e.__columnVisible=s,s?h.push(e):!0===e.responsive&&(o=!0)}if(this.__bodyRef){const t=this.__bodyRef.querySelectorAll(".detail-toggle, .row-detail");if(t.length>0){const e=o,s=t.length;for(let i=0;i<s;i++)t[i].classList.toggle("d-table-none",!e)}const e=o?h.length:h.filter((t=>"detail"!==t.type)).length;if(this.expand.visibleColumnCount!==e){this.expand.visibleColumnCount=e;const t=e.toString(),s=this.__bodyRef.querySelectorAll(".full-cell[colspan]"),i=s.length;for(let e=0;e<i;e++)s[e].setAttribute("colspan",t)}}}),250);isColumnVisible(t){if(!1===t.visible)return!1;if(!t.classes||!0!==t.responsive)return!0;let e=this.getBaseVisibility(t.classes);return e=this.applyBreakpointVisibility(e,t.classes),e}getBaseVisibility(t){let e=!0;return!0===t["d-table-none"]&&(e=!1),!0===t["d-table-cell"]&&(e=!0),e}applyBreakpointVisibility(t,e){if("number"!=typeof this._breakpointIndex||!Array.isArray(this.__breakpoints))return t;for(let s=0;s<=this._breakpointIndex;s++){const i=this.__breakpoints[s]?.size;i&&(t=this.updateVisibilityBySize(t,e,i))}return t}updateVisibilityBySize(t,e,s){return!0===e[`d-table-${s}-none`]&&(t=!1),!0===e[`d-table-${s}-cell`]&&(t=!0),t}setCheckedItemsSum(t,e){this.checkedItemsSum??={},this.checkedItemsSum[t]=e}async componentWillLoad(){await l.applyShadowRootStylesAsync(this.host,"material"),this.initColumns()}disconnectedCallback(){Object.values(this.__cellCheckChangeTimeoutRafId).forEach((t=>{t&&clearTimeout(t)})),this.__cellCheckChangeTimeoutRafId={},this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0)}componentWillRender(){if(this.dataSet&&this.__columns&&(this.classes=g(this.classes),this.__pageDate=this.dataSet,"stencil"===this.sidePagination)){if(this.searchable&&this.searchText){const t=this.searchText.toLowerCase(),e=this.__columns.filter((t=>t.searchable)),s=e.length;s>0&&(this.__pageDate=this.__pageDate.filter((i=>{for(let h=0;h<s;h++){const s=d(i,e[h].field);if(null!=s){let e;if(e="object"==typeof s?Array.isArray(s)?s.map((t=>"object"==typeof t&&null!==t?JSON.stringify(t):String(t))).join(","):JSON.stringify(s):String(s),e.toLowerCase().includes(t))return!0}}return!1})))}this.sortData(this.__pageDate)}}sortData(t){if(!t||t.length<=1)return;const e=this.buildSortKeys();if(0===e.length)return;const s=this.sortName,i="desc"===this.sortOrder;t.sort(((t,h)=>this.compareSortValues(t,h,e,s,i)))}buildSortKeys(){const t=[];return this.groupBy&&t.push(this.groupBy),null!=this.sortName&&t.push(this.sortName),void 0!==this.fieldIndex&&t.push(this.fieldIndex),t}compareSortValues(t,e,s,i,h){for(const o of s){const s=d(t,o),a=d(e,o),l=this.compareValues(s,a,o===i&&h);if(0!==l)return l}return 0}compareValues(t,e,s){return t===e||null==t&&null==e?0:null==t?-1:null==e?1:this.compareNonNullValues(t,e,s)}compareNonNullValues(t,e,s){const i=typeof t,h=typeof e;return"string"===i&&"string"===h?this.compareStrings(t,e,s):"number"===i&&"number"===h?s?this.compareNumbersDesc(t,e):this.compareNumbersAsc(t,e):this.compareAsStrings(t,e,s)}compareStrings(t,e,s){const i=t.localeCompare(e);return s?-i:i}compareNumbersAsc(t,e){return t-e}compareNumbersDesc(t,e){return e-t}compareAsStrings(t,e,s){const i=u(t).localeCompare(u(e));return s?-i:i}render(){if(!this.__pageDate)return;let t=this.__pageDate;this.pagination&&"stencil"===this.sidePagination&&(t=t.slice((this.pageNumber-1)*this.pageSize+1-1,this.pageNumber*this.pageSize));const e={"table-container":!0,"fixed-table-header":!!this.tableHeight,"custom-table-height":!!this.tableHeight};return h(o,null,this.renderTableTop(),h("div",{class:{"text-sm":!0,"table-responsive":!0,border:this.classes&&!!this.classes["table-bordered"]}},h("div",{class:e},h("storm-table-body",{ref:t=>this.__bodyRef=t,table:this,dataSet:t,columns:this.__columns,timeStamp:this.timeStamp}))),this.renderTableBottom())}componentDidRender(){if(this.debouncedDisplaySelectedCount(),this.__columns&&this.__bodyRef){if(this.isColumnResponsive&&this.responsiveResize(),this.tableHeight){const t=this.host.shadowRoot?.querySelector(".table-container.custom-table-height");t&&t.style.setProperty("--storm-table-custom-height",this.tableHeight)}this.__columns.forEach((t=>{this.__bodyRef.updateColumnCheckbox(t)}))}}static get watchers(){return{dataSet:[{watchDataSetHandler:0}],columns:[{watchColumnsHandler:0}],totalSelected:[{watchTotalSelectedHandler:0}]}}};y.style=':host{display:block;line-height:1}:host .table td,:host .table th{white-space:pre-wrap}:host .table thead{z-index:1}:host .table thead th{padding:0.75rem 0.5rem}:host .table thead th.thead-xxs{padding:0.25rem;width:2.3rem}:host .table thead th.combined-cell{padding-top:0.25rem;padding-bottom:0}:host .table thead th.child-cell{padding-top:0;padding-bottom:0.25rem}:host .table.table-sm thead th{padding:0.5rem 0.25rem}:host .table.table-sm thead th.thead-xxs{padding:0.125rem}:host .table.table-sm thead th.combined-cell{padding-top:0.125rem;padding-bottom:0}:host .table.table-sm thead th.child-cell{padding-top:0.0625rem;padding-bottom:0}:host .table .form-check>.form-check-input[type=radio]{background-color:#fff;cursor:pointer}:host .form-check{padding:0}:host .table-sorter{cursor:pointer}:host .table-sorter>.cell{display:inline-block;height:100%;position:relative;width:100%;line-height:1.1}:host .table-sorter>.cell:before{border-top:5px solid #000;bottom:0.15rem}:host .table-sorter>.cell:after{border-bottom:5px solid #000;border-top:5px solid transparent;top:-0.2rem}:host .table-sorter>.cell:after,:host .table-sorter>.cell:before{content:"";height:0;width:0;position:absolute;right:5px;border-left:5px solid transparent;border-right:5px solid transparent;opacity:0.3}:host .table-sorter.asc>.cell:after{opacity:0.7}:host .table-sorter.asc>.cell:before{opacity:0}:host .table-sorter.desc>.cell:before{opacity:0.7}:host .table-sorter.desc>.cell:after{opacity:0}:host .table-layout-fixed{table-layout:fixed}:host .table-layout-auto{table-layout:auto}:host .no-records-found{height:30vh}:host .fixed-table-header th{position:sticky;top:0}:host .fixed-table-header thead{position:sticky;top:0;background:white}:host .fixed-table-header thead tr{border-top-width:0}:host .table-description{font-size:0.5rem;font-weight:normal !important}:host .table-top,:host .table-bottom{padding:0.5rem}:host .table-top:after,:host .table-bottom:after{clear:both;content:" ";display:table}:host .table-top label{margin-bottom:0}:host .table-top .table-pageSizeMenu label select{border-color:#f0f2f5;border-radius:0.375rem;padding:6px}:host .table-selectedInfo,:host .table-pageSizeMenu,:host .table-pageInfo{float:left;color:#7b809a;font-size:0.875rem}:host .table-selectedInfo,:host .table-pageInfo{margin:0.7rem 0;padding-right:2rem}:host .table-search,:host .table-pagination{float:right}:host .table-search input{font-size:0.875rem;color:#495057;border:1px solid #f0f2f5;border-radius:0.375rem;padding:6px 12px}:host .tr.table-sorter{cursor:pointer}:host tr storm-toolbar storm-button .btn{width:1.5rem;height:1.5rem;padding:0.3rem 0.3rem}:host tr storm-toolbar.storm-dynamic-label storm-button .storm-button-label{display:none}:host tr:hover storm-toolbar.storm-dynamic-label storm-button .btn:not(.btn-icon-only){width:auto;height:auto;padding:0.06rem 0.5rem 0.06rem 0.2rem}:host tr:hover storm-toolbar.storm-dynamic-label storm-button .storm-button-label{display:block}';export{y as storm_table}