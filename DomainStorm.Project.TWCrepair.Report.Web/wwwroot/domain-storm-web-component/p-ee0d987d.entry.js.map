{"version":3,"names":["stormCheckboxGroupCss","StormCheckboxGroup","_dataSet","type","labelClasses","isSwitch","isInline","dataSet","value","disabled","valueChanged","dataSetWatcher","newValue","this","JSON","parse","error","console","valueWatcher","find","x","checked","id","filter","map","checkedItems","length","reverse","slice","forEach","item","Array","isArray","includes","check","uncheckAll","uncheck","componentWillLoad","dataSetRender","label","h","isDisabled","isChecked","onValueChanged","ev","detail","render","Host","key","stormDropdownTreeCss","StormDropdownTree","_dropdownRef","_treeRef","_text","heading","text","dataSource","nullable","fieldId","fieldLabel","fieldChildren","expandLevel","nodeSelectableRule","size","partialLoad","loading","class","valid","required","searchText","searchable","selection","timeStamp","textChanged","searchChanged","oldValue","deepEqual","updateValue","emit","textWatcher","componentDidLoad","renderTree","ref","elm","stopPropagation","onNodeClick","async","hide","onSearchChanged","componentWillRender","values","texts","node","getNodeById","push","getLabel","join","undefined","showSelected","onUnselectedAll","unselectAll","onShowMenu","loadDataSet","requestAnimationFrame","setSearchFocus","isCommandString","test","trim","parseCommandString","trimmed","commandRegex","match","exec","command","MemoryCache","store","Map","maxEntries","constructor","get","set","entry","has","evictOldestEntry","iterator","keys","firstKey","next","delete","clear","defaultKeyPrefix","setMaxEntries","enforceMaxEntries","excessCount","i","getMaxEntries","destroy","cacheService","CacheService","invokeDotNetMethodAsync","methodName","args","settings","TypeError","cache","regionName","stringify","useCache","cachedValue","result","window","counterInterop","invokeMethodAsync","err","stormTableCellCss","StormTableCell","__cellValueEditingEvent","cellData","cellType","prependText","appendText","table","row","index","column","clickCell","clickAction","cellWillValueChanged","cellValueChanged","cellDidValueChanged","cellValueChangedOnBlur","valueChangedHandler","field","eventDetail","getFieldValue","cellWillValueChangedHandler","sidePagination","cellValueChangedHandler","setFieldValue","cellDidValueChangedHandler","host","querySelector","__emitCellValueChangedOnBlur","rerender","focusoutHandler","_","debounce","forceUpdate","dispatchCustomEvent","renderSerialNumber","pageNumber","pageSize","renderDetail","FnIconSwitch","onToggle","on","detailRow","shadowRoot","classList","toggle","renderActionControl","onClickAction","renderInputControl","option","InputType","Text","mode","DateInputMode","Single","enableTime","noCalendar","dateFormat","omitNullish","onClick","onChange","target","renderTextareaControl","cols","rows","title","renderDropdownControl","renderDropdownTreeControl","dataSets","isConditionGroups","matchingConditionGroup","conditionGroup","isConditions","conditions","evaluateConditions","fieldText","onTextChanged","renderCheckControl","renderCheckboxGroupControl","visible","groupType","renderCellContent","renderCellValue","renderCell","content","escape","escapeHtml","String","transform","toString","appendHighlight","template","cellTemplate","displayValue","innerHTML","replacePlaceholders","resetCellState","cellTypeResult","cellDataResult","Promise","all","resolvePropertyValueAsync","resetControlState","targetObject","propertyName","resolvePropertyValue","handleCommandString","evaluateConditionGroups","parsed","rowId","conditionGroups","preventDefault","stormTableToolbarCss","StormTableToolbar","__dateSet","isDynamicLabel","buttons","tooltip","icon","buttonStyle","rounded","calculateObjectValue","fieldIndex","items","y","selected","click","dropdownItem","action","actionId","dropdownItemId","align"],"sources":["src/components/storm-checkbox-group/storm-checkbox-group.css?tag=storm-checkbox-group","src/components/storm-checkbox-group/storm-checkbox-group.tsx","src/components/storm-dropdown-tree/storm-dropdown-tree.css?tag=storm-dropdown-tree","src/components/storm-dropdown-tree/storm-dropdown-tree.tsx","src/utils/command-utils/command-utils.ts","src/utils/cache/memory-cache.ts","src/utils/dotnet-method-invoker/dotnet-method-invoker.ts","src/components/storm-table/storm-table-cell/storm-table-cell.scss?tag=storm-table-cell","src/components/storm-table/storm-table-cell/storm-table-cell.tsx","src/components/storm-table/storm-table-toolbar/storm-table-toolbar.scss?tag=storm-table-toolbar","src/components/storm-table/storm-table-toolbar/storm-table-toolbar.tsx"],"sourcesContent":[":host {\r\n    display: block;\r\n}","import { Component, Event, EventEmitter, h, Host, Prop, Watch } from '@stencil/core';\r\n\r\n@Component({\r\n  tag: 'storm-checkbox-group',\r\n  styleUrl: 'storm-checkbox-group.css',\r\n  shadow: false,\r\n})\r\nexport class StormCheckboxGroup {\r\n  private _dataSet: ICheckboxItem[];\r\n\r\n  @Prop() type: 'checkbox' | 'radio' = 'checkbox';\r\n  @Prop() labelClasses: Record<string, boolean> | string = 'custom-control-label';\r\n  @Prop() isSwitch: boolean = false;\r\n  @Prop() isInline: boolean = false;\r\n  @Prop() dataSet: ICheckboxItem[] | string;\r\n  @Prop({ mutable: true }) value: string | string[];\r\n  @Prop({ mutable: true }) disabled?: boolean;\r\n\r\n  @Event() valueChanged: EventEmitter<string | string[] | null>;\r\n\r\n  @Watch('dataSet')\r\n  dataSetWatcher(newValue: ICheckboxItem[] | string) {\r\n    try {\r\n      this._dataSet = typeof newValue === 'string' ? JSON.parse(newValue) : newValue;\r\n    } catch (error) {\r\n      console.error('Invalid JSON format:', error);\r\n      return;\r\n    }\r\n    if (this.value) {\r\n      this.valueWatcher(this.value);\r\n    } else this.value = this.type === 'checkbox' ? this._dataSet.find(x => x.checked)?.id : this._dataSet.filter(x => x.checked).map(x => x.id);\r\n    if (this.type === 'radio') {\r\n      const checkedItems = this._dataSet.filter(x => x.checked);\r\n      if (checkedItems.length === 0) {\r\n        this._dataSet[0].checked = true;\r\n      } else if (checkedItems.length > 1) {\r\n        checkedItems\r\n          .reverse()\r\n          .slice(1)\r\n          .forEach(item => (item.checked = false));\r\n      }\r\n    }\r\n  }\r\n\r\n  @Watch('value')\r\n  valueWatcher(newValue: string | string[]) {\r\n    if (Array.isArray(newValue)) this._dataSet.forEach(x => (x.checked = newValue.includes(x.id)));\r\n    else this._dataSet.forEach(x => (x.checked = x.id == newValue));\r\n  }\r\n\r\n  check(item: ICheckboxItem) {\r\n    if (this.type === 'radio') {\r\n      this.uncheckAll();\r\n    }\r\n    item.checked = true;\r\n    if (this.type === 'radio') {\r\n      this.value = item.id;\r\n    } else if (Array.isArray(this.value)) {\r\n      if (!this.value.includes(item.id)) this.value = [...this.value, item.id];\r\n    } else {\r\n      this.value = [item.id];\r\n    }\r\n  }\r\n\r\n  uncheck(item: ICheckboxItem) {\r\n    item.checked = false;\r\n    if (this.type === 'radio') {\r\n      if (this.value === item.id) {\r\n        this.value = null;\r\n      }\r\n    } else if (Array.isArray(this.value)) {\r\n      this.value = this.value.filter(id => id !== item.id);\r\n    }\r\n  }\r\n\r\n  uncheckAll() {\r\n    if (this._dataSet) {\r\n      this._dataSet.filter(x => x.checked).forEach(x => (x.checked = false));\r\n    }\r\n  }\r\n\r\n  componentWillLoad() {\r\n    if (this.dataSet) {\r\n      this.dataSetWatcher(this.dataSet);\r\n    }\r\n  }\r\n\r\n  dataSetRender() {\r\n    return this._dataSet.map(item => {\r\n      if (!item.id) item.id = item.label;\r\n      return (\r\n        <storm-checkbox\r\n          type={this.type}\r\n          label={item.label}\r\n          labelClasses={item.labelClasses ?? this.labelClasses}\r\n          isDisabled={this.disabled || item.disabled}\r\n          isChecked={item.checked}\r\n          isSwitch={this.isSwitch}\r\n          isInline={this.isInline}\r\n          onValueChanged={ev => {\r\n            if (ev.detail) {\r\n              this.check(item);\r\n            } else {\r\n              this.uncheck(item);\r\n            }\r\n          }}\r\n        ></storm-checkbox>\r\n      );\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return <Host>{this.dataSetRender()}</Host>;\r\n  }\r\n}\r\n\r\nexport interface ICheckboxItem {\r\n  id?: string;\r\n  label: string;\r\n  labelClasses?: string;\r\n  checked?: boolean;\r\n  disabled?: boolean;\r\n}\r\n",":host {\r\n  display: block;\r\n}","import { Component, Element, Event, EventEmitter, h, Host, Prop, Watch } from '@stencil/core';\r\nimport { deepEqual } from '@utils/utils';\r\nimport type { FetchOption } from '@utils/fetch-data-source/interface';\r\n@Component({\r\n  tag: 'storm-dropdown-tree',\r\n  styleUrl: 'storm-dropdown-tree.css',\r\n  shadow: false,\r\n})\r\nexport class StormDropdownTree {\r\n  private _dropdownRef: HTMLStormDropdownElement;\r\n  private _treeRef: HTMLStormTreeViewElement;\r\n  private _text: string;\r\n\r\n  @Element() host: HTMLElement;\r\n\r\n  @Prop({ mutable: true }) label: string;\r\n  @Prop({ mutable: true }) heading: string;\r\n  @Prop({ mutable: true }) text?: string;\r\n  @Prop({ mutable: true }) value?: string | string[];\r\n  @Prop({ mutable: true }) dataSet?: object | object[];\r\n  @Prop({ mutable: true }) dataSource?: FetchOption | Function | string;\r\n  @Prop({ mutable: true }) disabled?: boolean;\r\n  @Prop() nullable: boolean = false;\r\n  @Prop() fieldId: string = 'id';\r\n  @Prop() fieldLabel: string = 'label';\r\n  @Prop() fieldChildren: string = 'children';\r\n  @Prop() expandLevel: number = 2;\r\n  @Prop() nodeSelectableRule?: string | Function;\r\n  @Prop() size: 'Default' | 'Small' = 'Default';\r\n  @Prop() partialLoad: boolean = false;\r\n  @Prop() loading: 'eager' | 'lazy' = 'lazy';\r\n  @Prop() class: Record<string, boolean> | string;\r\n\r\n  @Prop({ mutable: true }) valid?: boolean;\r\n  @Prop() required?: boolean;\r\n\r\n  @Prop({ mutable: true }) searchText?: string;\r\n  @Prop() searchable: boolean = false;\r\n  @Prop() selection: 'single' | 'multiple' | 'none' = 'single';\r\n\r\n  @Prop({ mutable: true }) timeStamp?: number;\r\n\r\n  @Event() valueChanged: EventEmitter<string | string[]>;\r\n  @Event() textChanged: EventEmitter<string>;\r\n  @Event() searchChanged: EventEmitter<string>;\r\n\r\n  @Watch('value')\r\n  valueWatcher(newValue: string | string[], oldValue: string | string[]) {\r\n    if (deepEqual(newValue, oldValue)) return;\r\n    this.updateValue();\r\n    this.valueChanged.emit(this.value);\r\n  }\r\n\r\n  @Watch('text')\r\n  textWatcher() {\r\n    this.textChanged.emit(this.text);\r\n  }\r\n\r\n  @Watch('dataSet')\r\n  dataSetWatcher() {\r\n    this._treeRef.dataSet = this.dataSet;\r\n  }\r\n\r\n  updateValue() {\r\n    if (this._treeRef.value != this.value) this._treeRef.value = this.value;\r\n    if (this._dropdownRef.value != this.value) this._dropdownRef.value = this.value;\r\n  }\r\n\r\n  componentDidLoad() {\r\n    this.updateValue();\r\n  }\r\n\r\n  renderTree() {\r\n    return (\r\n      <storm-tree-view\r\n        ref={elm => (this._treeRef = elm)}\r\n        partialLoad={this.partialLoad}\r\n        loading={this.loading}\r\n        value={this.value}\r\n        class={this.class}\r\n        dataSet={this.dataSet}\r\n        dataSource={this.dataSource}\r\n        fieldId={this.fieldId}\r\n        fieldLabel={this.fieldLabel}\r\n        fieldChildren={this.fieldChildren}\r\n        nullable={this.nullable}\r\n        selection={this.selection}\r\n        expandLevel={this.expandLevel}\r\n        nodeSelectableRule={this.nodeSelectableRule}\r\n        searchable={this.searchable}\r\n        onValueChanged={ev => {\r\n          ev.stopPropagation();\r\n          this.value = ev.detail;\r\n        }}\r\n        onNodeClick={async ev => {\r\n          ev.stopPropagation();\r\n          await this._dropdownRef.hide();\r\n        }}\r\n        onSearchChanged={ev => {\r\n          ev.stopPropagation();\r\n          this.searchChanged.emit(ev.detail);\r\n        }}\r\n      ></storm-tree-view>\r\n    );\r\n  }\r\n\r\n  async componentWillRender() {\r\n    this._text = this.text;\r\n    if (this._text == null) {\r\n      if (this._treeRef && this.value) {\r\n        const values = Array.isArray(this.value) ? this.value : [this.value];\r\n        const texts = [];\r\n        for (const value of values) {\r\n          const node = await this._treeRef.getNodeById(value);\r\n          if (node) {\r\n            texts.push(await this._treeRef.getLabel(node));\r\n          }\r\n        }\r\n        this._text = texts.join('、');\r\n      } else {\r\n        this._text = undefined;\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <storm-dropdown\r\n          ref={elm => (this._dropdownRef = elm)}\r\n          nullable={this.nullable}\r\n          heading={this.heading}\r\n          label={this.label}\r\n          text={this._text}\r\n          value={this.value}\r\n          showSelected={true}\r\n          valid={this.valid}\r\n          required={this.required}\r\n          disabled={this.disabled}\r\n          timeStamp={this.timeStamp}\r\n          type=\"select\"\r\n          onValueChanged={ev => {\r\n            ev.stopPropagation();\r\n            this.value = ev.detail;\r\n            if (this.value == null) {\r\n              this.text = undefined;\r\n            }\r\n          }}\r\n          onUnselectedAll={async ev => {\r\n            ev.stopPropagation();\r\n            await this._treeRef.unselectAll();\r\n          }}\r\n          onShowMenu={async ev => {\r\n            ev.stopPropagation();\r\n            await this._treeRef.loadDataSet();\r\n            if (this.searchable && this._treeRef) {\r\n              requestAnimationFrame(async () => {\r\n                await this._treeRef.setSearchFocus();\r\n              });\r\n            }\r\n          }}\r\n        >\r\n          {this.renderTree()}\r\n        </storm-dropdown>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n","import type { ParsedCommand } from './interface';\r\n\r\n/**\r\n * 判斷輸入是否為有效命令格式，例如 @Invoke:DotNet('GetUser')\r\n * @param value 任意輸入\r\n * @returns 是否符合命令格式\r\n */\r\nexport function isCommandString(value: unknown): value is string {\r\n    if (typeof value !== 'string') return false;\r\n    // 檢查型別與正則，確保格式正確\r\n    // 僅允許單層括號內容，且括號內可為任意字元\r\n    return (\r\n        typeof value === 'string' &&\r\n        /^@[a-zA-Z0-9:-]+\\('.*'\\)$/.test(value.trim())\r\n    );\r\n}\r\n\r\n/**\r\n * 解析命令字串，回傳 ParsedCommand 或 null\r\n * 格式範例：@Invoke:DotNet('GetUser')\r\n * @param value 命令字串\r\n * @returns 解析後的命令物件，若格式不符則回傳 null\r\n */\r\nexport function parseCommandString(value: string): ParsedCommand | null {\r\n    const trimmed = value.trim();\r\n    // 強化正則表達式，避免括號內為空或出現多行情況\r\n    const commandRegex = /^@([a-zA-Z0-9:-]+)\\('([^']*)'\\)$/;\r\n\r\n    const match = commandRegex.exec(trimmed);\r\n    if (!match) return null;\r\n\r\n    return {\r\n        command: match[1],\r\n        value: match[2]\r\n    };\r\n}\r\n\r\n/**\r\n * 檢查解析後命令是否符合指定 path\r\n * @param parsed 解析後的命令物件\r\n * @param expectedPath 預期的 path 字串，例如 \"Invoke:DotNet\"\r\n * @returns 是否符合預期 path\r\n */\r\nexport function isPath(parsed: ParsedCommand | null, expectedPath: string): boolean {\r\n    return !!parsed && parsed.command === expectedPath;\r\n}","import type { CacheEntry, CacheProvider } from './interface';\r\n\r\nexport class MemoryCache implements CacheProvider {\r\n    private readonly store = new Map<string, CacheEntry>();\r\n    private maxEntries: number;\r\n\r\n    constructor(maxEntries = 1000) {\r\n        this.maxEntries = maxEntries;\r\n    }\r\n\r\n    async get(key: string): Promise<CacheEntry | null> {\r\n        return this.store.get(key) || null;\r\n    }\r\n\r\n    async set(key: string, entry: CacheEntry): Promise<void> {\r\n        // If updating existing key, no need to check size\r\n        if (!this.store.has(key) && this.store.size >= this.maxEntries) {\r\n            this.evictOldestEntry();\r\n        }\r\n        \r\n        this.store.set(key, entry);\r\n    }\r\n\r\n    private evictOldestEntry(): void {\r\n        const iterator = this.store.keys();\r\n        const firstKey = iterator.next().value;\r\n        if (firstKey !== undefined) {\r\n            this.store.delete(firstKey);\r\n        }\r\n    }\r\n\r\n    async delete(key: string): Promise<void> {\r\n        this.store.delete(key);\r\n    }\r\n\r\n    async clear(): Promise<void> {\r\n        this.store.clear();\r\n    }\r\n\r\n    get defaultKeyPrefix(): string {\r\n        return 'mem';\r\n    }\r\n\r\n    async size(): Promise<number> {\r\n        return this.store.size;\r\n    }\r\n\r\n    setMaxEntries(maxEntries: number): void {\r\n        this.maxEntries = maxEntries;\r\n        this.enforceMaxEntries();\r\n    }\r\n\r\n    private enforceMaxEntries(): void {\r\n        const excessCount = this.store.size - this.maxEntries;\r\n        if (excessCount <= 0) return;\r\n        \r\n        const iterator = this.store.keys();\r\n        for (let i = 0; i < excessCount; i++) {\r\n            const key = iterator.next().value;\r\n            if (key === undefined) break;\r\n            this.store.delete(key);\r\n        }\r\n    }\r\n\r\n    getMaxEntries(): number {\r\n        return this.maxEntries;\r\n    }\r\n\r\n    async destroy(): Promise<void> {\r\n        this.store.clear();\r\n    }\r\n}","import { CacheService } from '../cache/cache-service';\r\nimport { MemoryCache } from '../cache/memory-cache';\r\n\r\ndeclare global {\r\n    interface Window {\r\n        counterInterop: {\r\n            invokeMethodAsync: (method: string, ...args: any[]) => Promise<any>;\r\n        };\r\n    }\r\n}\r\n\r\nconst cacheService = new CacheService(new MemoryCache());\r\n\r\n/**\r\n * 呼叫 .NET Interop 方法，支援快取與錯誤保護\r\n * @param value    字串，格式可為 \"Invoke:DotNet('methodName')\" 或僅 methodName\r\n * @param args     傳給 .NET 方法的參數陣列\r\n * @param settings 可選設定：\r\n *                 - cache: 是否啟用快取，預設 true\r\n *                 - regionName: 快取區域名稱，預設 'dotnetInterop'\r\n * @return Promise<any> 回傳 .NET 方法的結果\r\n */\r\nexport async function invokeDotNetMethodAsync(\r\n    methodName: string,\r\n    args: any[] = [],\r\n    settings: { cache?: boolean, regionName?: string } = {}\r\n): Promise<any> {\r\n    if (typeof methodName !== 'string') {\r\n        throw new TypeError('methodName 必須是字串');\r\n    }\r\n\r\n    settings = { cache: true, regionName: 'dotnetInterop', ...settings };\r\n\r\n    // 組成 key：methodName + args\r\n    const key = `${methodName}:${JSON.stringify(args)}`;\r\n    const useCache = settings.cache ?? true;\r\n\r\n    if (useCache) {\r\n        const cachedValue = await cacheService.get<any>(key);\r\n        if (cachedValue !== null) {\r\n            return cachedValue;\r\n        }\r\n    }\r\n\r\n    try {\r\n        const result = await window.counterInterop?.invokeMethodAsync(\r\n            methodName,\r\n            ...args\r\n        );\r\n\r\n        if (useCache) {\r\n            await cacheService.set(key, result);\r\n        }\r\n        return result;\r\n    } catch (err) {\r\n        console.error(`[Interop] 無法呼叫 '${methodName}'：`, err);\r\n        return 'unknown';\r\n    }\r\n}\r\n\r\n/**\r\n * 清除 .NET Interop 方法的快取\r\n * @param regionName (可選) 指定要清除的 region，預設為 'dotnetInterop'\r\n * @return Promise<void>\r\n */\r\nexport async function clearDotNetMethodCache(): Promise<void> {\r\n    await cacheService.clear();\r\n}",":host {\r\n  display: block;\r\n}\r\n\r\n.input-group {\r\n  &.input-group-static {\r\n    .form-control {\r\n      background-color: white;\r\n      line-height: 1.25rem;\r\n      padding: .25rem;\r\n    }\r\n  }\r\n}\r\n\r\n.detail-button {\r\n  cursor: pointer;\r\n}","import { Component, Element, Event, EventEmitter, forceUpdate, h, Host, Listen, Method, Prop, State } from '@stencil/core';\nimport { isCommandString, parseCommandString } from '@utils/command-utils/command-utils';\nimport { invokeDotNetMethodAsync } from '@utils/dotnet-method-invoker/dotnet-method-invoker';\nimport { FnIconSwitch } from '@utils/functional/functional';\nimport {\n  appendHighlight,\n  debounce,\n  escapeHtml,\n  evaluateConditions,\n  getFieldValue,\n  isConditionGroups,\n  isConditions,\n  omitNullish,\n  replacePlaceholders,\n  resolvePropertyValue,\n  setFieldValue,\n} from '@utils/utils';\nimport type { ICheckboxItem } from '../../storm-checkbox-group/storm-checkbox-group';\nimport { DateInputMode, InputType } from '../../storm-input-group/interface';\nimport type { CheckboxGroupInterface, TableColumnInterface } from '../interface';\nimport { StormTable } from '../storm-table';\nimport type { ClickActionDetail } from '../storm-table-toolbar/interface';\nimport type {\n  CellValue,\n  CheckboxGroupControlOptionInterface,\n  CheckControlOptionInterface,\n  DropdownControlOptionInterface,\n  DropdownTreeControlOptionInterface,\n  InputControlOptionInterface,\n  TextAreaControlOptionInterface,\n} from './interface';\n\n@Component({\n  tag: 'storm-table-cell',\n  styleUrl: 'storm-table-cell.scss',\n  shadow: false,\n})\nexport class StormTableCell {\n  private __cellValueEditingEvent?: CellValue;\n\n  @Element() host: HTMLElement;\n\n  @State() private cellData: any;\n  @State() private cellType: string = 'text';\n  @State() private isDisabled: boolean = false;\n  @State() private prependText?: string;\n  @State() private appendText?: string;\n\n  @Prop() table: StormTable;\n  @Prop() row: object;\n  @Prop() index: number;\n  @Prop() column: TableColumnInterface;\n  @Prop({ mutable: true }) timeStamp?: number;\n\n  @Event() clickCell: EventEmitter<{ id: string; field: string | number }>;\n  @Event() clickAction: EventEmitter<ClickActionDetail>;\n  @Event() valueChanged: EventEmitter<any>;\n\n  @Event() cellWillValueChanged: EventEmitter<CellValue>;\n  @Event() cellValueChanged: EventEmitter<CellValue>;\n  @Event() cellDidValueChanged: EventEmitter<CellValue>;\n  @Event() cellValueChangedOnBlur: EventEmitter<CellValue>;\n\n  @Listen('valueChanged')\n  valueChangedHandler(ev: CustomEvent<any>) {\n    if (!this.column?.field) return;\n\n    const eventDetail = {\n      id: getFieldValue(this.row, this.table.fieldId) as string,\n      field: this.column.field,\n      value: ev.detail,\n    };\n    this.cellWillValueChanged.emit(eventDetail);\n  }\n\n  @Listen('cellWillValueChanged')\n  cellWillValueChangedHandler(ev: CustomEvent<CellValue>) {\n    if (this.table.sidePagination === 'stencil') {\n      this.cellValueChanged.emit(ev.detail);\n    }\n  }\n\n  @Listen('cellValueChanged')\n  cellValueChangedHandler(ev: CustomEvent<CellValue>) {\n    setFieldValue(this.row, this.column.field, ev.detail.value);\n    if (this.table.sidePagination === 'stencil') {\n      this.cellDidValueChanged.emit(ev.detail);\n    }\n  }\n\n  @Listen('cellDidValueChanged')\n  cellDidValueChangedHandler(ev: CustomEvent<CellValue>) {\n    if (this.host.querySelector(':focus')) {\n      this.__cellValueEditingEvent = ev.detail;\n    } else if (this.__cellValueEditingEvent != null) {\n      this.__cellValueEditingEvent = ev.detail;\n      this.__emitCellValueChangedOnBlur();\n    }\n    this.rerender();\n  }\n\n  @Listen('focusout')\n  focusoutHandler(_: FocusEvent) {\n    if (this.__cellValueEditingEvent) {\n      this.__emitCellValueChangedOnBlur();\n    }\n  }\n\n  private readonly rerender = debounce(() => {\n    forceUpdate(this);\n  }, 100);\n\n  @Method()\n  async dispatchCustomEvent(type: string, detail?: object): Promise<void> {\n    this[type].emit(detail);\n  }\n\n  renderSerialNumber() {\n    return (this.table.pageNumber - 1) * this.table.pageSize + this.index + 1;\n  }\n\n  renderDetail() {\n    return (\n      <FnIconSwitch\n        onToggle={on => {\n          const detailRow = this.table.host.shadowRoot.querySelector('.row-detail[data-index=\"' + this.index + '\"]');\n          if (detailRow) {\n            detailRow.classList.toggle('d-none', !on);\n          }\n        }}\n      />\n    );\n  }\n\n  renderActionControl() {\n    return (\n      <storm-table-toolbar\n        table={this.table}\n        column={this.column}\n        row={this.row}\n        timeStamp={this.timeStamp}\n        onClickAction={ev => {\n          ev.stopPropagation();\n          this.clickAction.emit(ev.detail);\n        }}\n      ></storm-table-toolbar>\n    );\n  }\n\n  renderInputControl() {\n    const option = {\n      type: InputType.Text,\n      mode: DateInputMode.Single,\n      enableTime: false,\n      noCalendar: false,\n      dateFormat: 'Y-m-d',\n      ...omitNullish(this.cellData),\n    } as InputControlOptionInterface;\n    return (\n      <storm-input-group\n        disabled={this.isDisabled}\n        value={getFieldValue(this.row, this.column.field) as string}\n        type={option.type}\n        mode={option.mode}\n        enableTime={option.enableTime}\n        noCalendar={option.noCalendar}\n        dateFormat={option.dateFormat}\n        onClick={ev => ev.stopPropagation()}\n        onChange={ev => {\n          ev.stopPropagation();\n          this.valueChanged.emit((ev.target as HTMLInputElement).value);\n        }}\n      ></storm-input-group>\n    );\n  }\n\n  renderTextareaControl() {\n    const option = this.cellData as TextAreaControlOptionInterface;\n    return (\n      <div class=\"input-group input-group-static\">\n        <textarea\n          class=\"form-control\"\n          disabled={this.isDisabled}\n          cols={option.cols}\n          rows={option.rows}\n          title={this.column.title}\n          value={getFieldValue(this.row, this.column.field) as string}\n          onClick={ev => ev.stopPropagation()}\n          onChange={ev => {\n            ev.stopPropagation();\n            this.valueChanged.emit((ev.target as HTMLInputElement).value);\n          }}\n        />\n      </div>\n    );\n  }\n\n  renderDropdownControl() {\n    const option = {\n      label: null,\n      dataSet: null,\n      nullable: false,\n      searchable: true,\n      ...omitNullish(this.cellData),\n    } as DropdownControlOptionInterface;\n    return (\n      <storm-dropdown\n        disabled={this.isDisabled}\n        label={option.label}\n        value={getFieldValue(this.row, this.column.field) as string | string[]}\n        dataSet={option.dataSet}\n        nullable={option.nullable}\n        searchable={option.searchable}\n        selection={'single'}\n        timeStamp={this.timeStamp}\n        type={'select'}\n        onValueChanged={ev => {\n          ev.stopPropagation();\n          this.valueChanged.emit(ev.detail);\n        }}\n      ></storm-dropdown>\n    );\n  }\n\n  renderDropdownTreeControl() {\n    const option = this.cellData as DropdownTreeControlOptionInterface;\n    let dataSet = option.dataSet;\n\n    if (option.dataSets && isConditionGroups(option.dataSets)) {\n      const matchingConditionGroup = option.dataSets.find(conditionGroup => isConditions(conditionGroup.conditions) && evaluateConditions(conditionGroup.conditions, this.row));\n      if (matchingConditionGroup) {\n        dataSet = matchingConditionGroup.value;\n      }\n    }\n    return (\n      <storm-dropdown-tree\n        disabled={this.isDisabled}\n        loading={option.loading}\n        partialLoad={option.partialLoad}\n        label={option.label}\n        value={getFieldValue(this.row, this.column.field) as string | string[]}\n        text={option.fieldText ? (getFieldValue(this.row, option.fieldText) as string) : null}\n        dataSet={dataSet}\n        dataSource={option.dataSource}\n        fieldId={option.fieldId ?? 'id'}\n        fieldLabel={option.fieldLabel ?? 'label'}\n        fieldChildren={option.fieldChildren ?? 'children'}\n        expandLevel={option.expandLevel ?? 2}\n        nodeSelectableRule={option.nodeSelectableRule}\n        nullable={option.nullable ?? false}\n        searchable={option.searchable ?? true}\n        selection={'single'}\n        timeStamp={this.timeStamp}\n        onValueChanged={ev => {\n          ev.stopPropagation();\n          this.valueChanged.emit(ev.detail);\n        }}\n        onTextChanged={ev => {\n          ev.stopPropagation();\n          if (option.fieldText) setFieldValue(this.row, option.fieldText, ev.detail);\n        }}\n        onSearchChanged={ev => {\n          ev.stopPropagation();\n        }}\n      ></storm-dropdown-tree>\n    );\n  }\n\n  renderCheckControl() {\n    return (\n      <storm-checkbox\n        type={this.cellType === 'checkbox' ? 'checkbox' : 'radio'}\n        is-disabled={this.isDisabled}\n        is-checked={getFieldValue(this.row, this.column.field) as boolean}\n        time-stamp={this.timeStamp}\n      ></storm-checkbox>\n    );\n  }\n\n  renderCheckboxGroupControl() {\n    const option = this.cellData as CheckboxGroupControlOptionInterface;\n    const value = getFieldValue(this.row, this.column.field) as any;\n    const dataSet = (option.dataSet as CheckboxGroupInterface[])\n      .filter(x => {\n        if (x.visible === undefined) return true;\n        return typeof x.visible === 'function' ? x.visible(this.row) : x.visible;\n      })\n      .map(\n        x =>\n          ({\n            id: x.id,\n            label: x.label,\n            labelClasses: x.labelClasses,\n            checked: x.checked,\n            disabled: x.disabled,\n          } as ICheckboxItem),\n      );\n    return (\n      <div class=\"input-group input-group-static\">\n        <storm-checkbox-group\n          disabled={this.isDisabled}\n          type={option.groupType}\n          value={value}\n          dataSet={dataSet}\n          isSwitch={option.isSwitch ?? false}\n          isInline={option.isInline ?? true}\n          onValueChanged={ev => {\n            ev.stopPropagation();\n            this.valueChanged.emit(ev.detail);\n          }}\n        ></storm-checkbox-group>\n      </div>\n    );\n  }\n\n  renderCellContent() {\n    switch (this.cellType) {\n      case 'action':\n        return this.renderActionControl();\n      case 'input':\n        return this.renderInputControl();\n      case 'checkbox':\n      case 'radio':\n        return this.renderCheckControl();\n      case 'textarea':\n        return this.renderTextareaControl();\n      case 'dropdown':\n        return this.renderDropdownControl();\n      case 'dropdownTree':\n        return this.renderDropdownTreeControl();\n      case 'checkboxGroup':\n        return this.renderCheckboxGroupControl();\n      case 'serialNumber':\n        return this.renderSerialNumber();\n      case 'detail':\n        return this.renderDetail();\n      case 'text':\n        return this.renderCellValue();\n      case 'empty':\n        return '';\n      default:\n        return null;\n    }\n  }\n\n  renderCell() {\n    if (!this.prependText && !this.appendText) {\n      return this.renderCellContent();\n    } else {\n      return (\n        <div class=\"d-flex flex-row gap-1 align-items-center\">\n          {this.prependText && <span>{this.prependText}</span>}\n          {this.renderCellContent()}\n          {this.appendText && <span>{this.appendText}</span>}\n        </div>\n      );\n    }\n  }\n\n  renderCellValue() {\n    let content = getFieldValue(this.row, this.column.field) as any;\n\n    if (typeof this.column.render === 'function') {\n      content = this.column.render(content, this.row, this.index);\n    } else {\n      if (Array.isArray(content)) {\n        content = content.filter(item => item != null && item !== '').join('、');\n      }\n\n      if (this.table.escape && typeof content !== 'boolean' && content != null) {\n        content = escapeHtml(String(content));\n      }\n\n      if (content != null && this.column.transform && this.column.transform[content.toString()]) {\n        content = this.column.transform[content];\n      } else if (content && this.table.searchable && this.table.searchText) {\n        content = appendHighlight(content, this.table.searchText);\n      }\n    }\n\n    const template = this.column.cellTemplate || this.table.cellTemplate;\n    const displayValue = content != null && content.toString().trim().length > 0 ? content : '-';\n    return (\n      <span\n        innerHTML={replacePlaceholders(template, {\n          value: displayValue,\n          row: this.row,\n          index: this.index,\n        })}\n      ></span>\n    );\n  }\n\n  async componentWillRender() {\n    if (!this.column) {\n      this.resetCellState();\n      return;\n    }\n\n    // Parallelize independent async operations for better performance\n    const [cellTypeResult, cellDataResult] = await Promise.all([\n      this.resolvePropertyValueAsync<string>(this.column, 'cellType'),\n      this.resolvePropertyValueAsync(this.column, 'data'),\n    ]);\n\n    this.cellType = cellTypeResult || this.column.type || 'text';\n    this.cellData = cellDataResult;\n\n    // Early return if cellData is not an object to avoid unnecessary async calls\n    if (!this.cellData || typeof this.cellData !== 'object' || Array.isArray(this.cellData)) {\n      this.resetControlState();\n      return;\n    }\n\n    // Resolve additional properties only when needed\n    const [disabled, prependText, appendText] = await Promise.all([\n      this.resolvePropertyValueAsync<boolean>(this.cellData, 'disabled'),\n      this.resolvePropertyValueAsync<string>(this.cellData, 'prependText'),\n      this.resolvePropertyValueAsync<string>(this.cellData, 'appendText'),\n    ]);\n\n    this.isDisabled = disabled ?? false;\n    this.prependText = prependText;\n    this.appendText = appendText;\n\n    if (this.isDisabled && (this.cellType === 'input' || this.cellType === 'textarea')) {\n      this.cellType = 'text';\n    }\n  }\n\n  private resetCellState(): void {\n    this.cellType = 'text';\n    this.cellData = undefined;\n    this.resetControlState();\n  }\n\n  private resetControlState(): void {\n    this.isDisabled = false;\n    this.prependText = undefined;\n    this.appendText = undefined;\n    this.__cellValueEditingEvent = undefined;\n  }\n\n  private async resolvePropertyValueAsync<T>(targetObject: any, propertyName: string): Promise<T> {\n    const result = resolvePropertyValue(targetObject, propertyName, [this.row, this.index, this.column]);\n\n    // Handle command strings\n    if (isCommandString(result)) {\n      return this.handleCommandString<T>(result);\n    }\n\n    // Handle conditions\n    if (isConditions(result)) {\n      return evaluateConditions(result, this.row) as T;\n    }\n\n    // Handle condition groups\n    if (isConditionGroups(result)) {\n      return this.evaluateConditionGroups<T>(result);\n    }\n\n    // Handle promises\n    if (result instanceof Promise) {\n      try {\n        return await result;\n      } catch (error) {\n        console.error('屬性 Promise 解析失敗', error);\n        throw error;\n      }\n    }\n\n    return result;\n  }\n\n  private async handleCommandString<T>(result: string): Promise<T> {\n    const parsed = parseCommandString(result);\n\n    if (parsed.command === 'Invoke:DotNet') {\n      const rowId = getFieldValue(this.row, this.table?.fieldId) as string;\n      try {\n        return await invokeDotNetMethodAsync(parsed.value, [rowId, this.index, this.column.field], { cache: true });\n      } catch (error) {\n        console.error('InvokeDotNetMethod 執行失敗', error);\n        throw error;\n      }\n    }\n\n    if (parsed.command === 'Get:Field') {\n      return getFieldValue(this.row, parsed.value) as T;\n    }\n\n    return result as T;\n  }\n\n  private evaluateConditionGroups<T>(conditionGroups: any[]): T {\n    for (const conditionGroup of conditionGroups) {\n      if (isConditions(conditionGroup.conditions) && evaluateConditions(conditionGroup.conditions, this.row)) {\n        return conditionGroup.value as T;\n      }\n    }\n    return undefined;\n  }\n\n  private readonly __emitCellValueChangedOnBlur = debounce(() => {\n    if (this.__cellValueEditingEvent !== undefined) {\n      this.cellValueChangedOnBlur.emit(this.__cellValueEditingEvent);\n      this.__cellValueEditingEvent = undefined;\n    }\n  }, 500);\n\n  render() {\n    return (\n      <Host\n        onClick={ev => {\n          if (this.cellType === 'checkbox' || this.cellType === 'radio') {\n            ev.stopPropagation();\n            ev.preventDefault();\n            const option = this.cellData as CheckControlOptionInterface;\n            if (option && option.disabled) {\n              return;\n            }\n          }\n          this.clickCell.emit({ id: getFieldValue(this.row, this.table.fieldId) as string, field: this.column.field });\n        }}\n      >\n        {this.renderCell()}\n      </Host>\n    );\n  }\n}\n",":host {\r\n  display: block;\r\n\r\n  storm-button,\r\n  storm-dropdown,\r\n  div {\r\n    vertical-align: middle;\r\n  }\r\n\r\n  .btn {\r\n    &:hover:not(.active) {\r\n      color: white;\r\n    }\r\n\r\n    &.btn-outline-primary:hover {\r\n      background-color: #e91e63;\r\n    }\r\n\r\n    &.disabled {\r\n      color: #7b809a;\r\n      border-color: #7b809a;\r\n      cursor: not-allowed;\r\n    }\r\n  }\r\n}","import { Component, Element, Event, EventEmitter, Host, Prop, h } from '@stencil/core';\r\nimport type { ConditionInterface, ListItemInterface } from '@utils/interface';\r\nimport { calculateObjectValue, evaluateConditions, getFieldValue, isConditions } from '@utils/utils';\r\nimport type { ToolbarItemInterface } from '../../storm-toolbar/interface';\r\nimport type { TableColumnInterface } from '../interface';\r\nimport type { StormTable } from '../storm-table';\r\nimport type { ClickActionDetail } from '../storm-table-toolbar/interface';\r\n\r\n@Component({\r\n  tag: 'storm-table-toolbar',\r\n  styleUrl: 'storm-table-toolbar.scss',\r\n  shadow: false,\r\n})\r\nexport class StormTableToolbar {\r\n  private __dateSet: ToolbarItemInterface[];\r\n\r\n  @Element() host: HTMLElement;\r\n\r\n  @Prop() table: StormTable;\r\n  @Prop() column: TableColumnInterface;\r\n  @Prop() row: object;\r\n  @Prop() isDynamicLabel: boolean = true;\r\n  @Prop({ mutable: true }) timeStamp?: number;\r\n\r\n  @Event() clickAction: EventEmitter<ClickActionDetail>;\r\n\r\n  componentWillRender() {\r\n    this.__dateSet = this.column.buttons?.map(x => {\r\n      const item: ToolbarItemInterface = {\r\n        id: x.id,\r\n        type: x.type,\r\n        label: x.label,\r\n        tooltip: x.tooltip,\r\n        icon: x.icon,\r\n        size: 'sm',\r\n        buttonStyle: 'outline-primary',\r\n        rounded: true,\r\n        visible: () => {\r\n          if (isConditions(x.visible)) {\r\n            return evaluateConditions(x.visible as ConditionInterface[], this.row);\r\n          }\r\n          return calculateObjectValue(this, x.visible, this.row, this.table, getFieldValue(this.row, this.table.fieldIndex)) ?? true;\r\n        },\r\n        disabled: () => {\r\n          if (isConditions(x.disabled)) {\r\n            return evaluateConditions(x.disabled as ConditionInterface[], this.row);\r\n          }\r\n          return calculateObjectValue(this, x.disabled, this.row, this.table, getFieldValue(this.row, this.table.fieldIndex)) ?? false;\r\n        },\r\n        items: x.items\r\n          ? x.items.map(\r\n              y =>\r\n                ({\r\n                  id: y.id,\r\n                  title: y.title,\r\n                  icon: y.icon,\r\n                  selected: y.selected,\r\n                  visible: () => {\r\n                    if (isConditions(y.visible)) {\r\n                      return evaluateConditions(y.visible as ConditionInterface[], this.row);\r\n                    }\r\n                    return calculateObjectValue(this, y.visible, this.row, this.table, getFieldValue(this.row, this.table.fieldIndex)) ?? true;\r\n                  },\r\n                  disabled: () => {\r\n                    if (isConditions(y.disabled)) {\r\n                      return evaluateConditions(y.disabled as ConditionInterface[], this.row);\r\n                    }\r\n                    return calculateObjectValue(this, y.disabled, this.row, this.table, getFieldValue(this.row, this.table.fieldIndex)) ?? false;\r\n                  },\r\n                } as ListItemInterface),\r\n            )\r\n          : null,\r\n        click: (_: ToolbarItemInterface, dropdownItem: ListItemInterface = null) => {\r\n          if (x.action) x.action(this.row, x, this.table, dropdownItem);\r\n          this.clickAction.emit({\r\n            id: getFieldValue(this.row, this.table.fieldId) as string,\r\n            field: this.column.field,\r\n            actionId: x.id,\r\n            dropdownItemId: dropdownItem ? dropdownItem.id : null,\r\n          });\r\n        },\r\n      } as ToolbarItemInterface;\r\n      return item;\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <storm-toolbar\r\n          class={{\r\n            'storm-dynamic-label': this.isDynamicLabel,\r\n            'justify-content-start': this.column.align === 'left',\r\n            'justify-content-center': this.column.align === 'center',\r\n            'justify-content-end': this.column.align === 'right',\r\n          }}\r\n          dataSet={this.__dateSet}\r\n          timeStamp={this.timeStamp}\r\n        ></storm-toolbar>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]}