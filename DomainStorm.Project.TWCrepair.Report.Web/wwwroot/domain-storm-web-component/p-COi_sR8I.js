class t{provider;defaultOptions;constructor(t,e={}){if(!t){throw new Error("CacheService requires a valid provider")}this.provider=t;this.defaultOptions={regionName:typeof e.regionName==="string"&&e.regionName.trim()?e.regionName:"default",expiredMillis:typeof e.expiredMillis==="number"&&e.expiredMillis>0?e.expiredMillis:3e5}}makeCompositeKey(t,e){return`${t}:${e}`}async get(t,e=this.defaultOptions.regionName){if(!t||typeof t!=="string"){throw new Error("Cache key must be a non-empty string")}const i=this.makeCompositeKey(e,t);const r=await this.provider.get(i);if(!r)return null;const s=Date.now();if(s-r.timestamp>r.expiredMillis){await this.provider.delete(i);return null}return r.value}async set(t,e,i=this.defaultOptions.regionName,r=this.defaultOptions.expiredMillis){if(!t||typeof t!=="string"){throw new Error("Cache key must be a non-empty string")}if(typeof r!=="number"||r<=0){throw new Error("expiredMillis must be a positive number")}const s=this.makeCompositeKey(i,t);const n={value:e,timestamp:Date.now(),expiredMillis:r};await this.provider.set(s,n)}async delete(t,e=this.defaultOptions.regionName){if(!t||typeof t!=="string"){throw new Error("Cache key must be a non-empty string")}const i=this.makeCompositeKey(e,t);await this.provider.delete(i)}async clearRegion(t=this.defaultOptions.regionName){const e=`${t}:`;await this.provider.deleteByPrefix(e)}async clearAll(){await this.provider.clear()}}export{t as C};
//# sourceMappingURL=p-COi_sR8I.js.map