{"file":"storm-table-cell.entry.esm.js","mappings":"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","names":[],"sources":["src/utils/command-utils/command-utils.ts","src/utils/cache/memory-cache.ts","src/utils/dotnet-method-invoker/dotnet-method-invoker.ts","src/components/storm-table/storm-table-cell/storm-table-cell.css?tag=storm-table-cell","src/components/storm-table/storm-table-cell/storm-table-cell.tsx"],"sourcesContent":["import type { ParsedCommand } from './interface';\r\n\r\n/**\r\n * 判斷輸入是否為有效命令格式，例如 @Invoke:DotNet('GetUser')\r\n * @param value 任意輸入\r\n * @returns 是否符合命令格式\r\n */\r\nexport function isCommandString(value: unknown): value is string {\r\n    if (typeof value !== 'string') return false;\r\n    // 檢查型別與正則，確保格式正確\r\n    // 僅允許單層括號內容，且括號內可為任意字元\r\n    return (\r\n        typeof value === 'string' &&\r\n        /^@[a-zA-Z0-9:-]+\\('.*'\\)$/.test(value.trim())\r\n    );\r\n}\r\n\r\n/**\r\n * 解析命令字串，回傳 ParsedCommand 或 null\r\n * 格式範例：@Invoke:DotNet('GetUser')\r\n * @param value 命令字串\r\n * @returns 解析後的命令物件，若格式不符則回傳 null\r\n */\r\nexport function parseCommandString(value: string): ParsedCommand | null {\r\n    const trimmed = value.trim();\r\n    // 強化正則表達式，避免括號內為空或出現多行情況\r\n    const commandRegex = /^@([a-zA-Z0-9:-]+)\\('([^']*)'\\)$/;\r\n\r\n    const match = commandRegex.exec(trimmed);\r\n    if (!match) return null;\r\n\r\n    return {\r\n        command: match[1],\r\n        value: match[2]\r\n    };\r\n}\r\n\r\n/**\r\n * 檢查解析後命令是否符合指定 path\r\n * @param parsed 解析後的命令物件\r\n * @param expectedPath 預期的 path 字串，例如 \"Invoke:DotNet\"\r\n * @returns 是否符合預期 path\r\n */\r\nexport function isPath(parsed: ParsedCommand | null, expectedPath: string): boolean {\r\n    return !!parsed && parsed.command === expectedPath;\r\n}","import type { CacheEntry, CacheProvider } from './interface';\r\n\r\nexport class MemoryCache implements CacheProvider {\r\n    private readonly store = new Map<string, CacheEntry>();\r\n    private maxEntries: number;\r\n\r\n    constructor(maxEntries = 1000) {\r\n        this.maxEntries = maxEntries;\r\n    }\r\n\r\n    async get(key: string): Promise<CacheEntry | null> {\r\n        return this.store.get(key) || null;\r\n    }\r\n\r\n    async set(key: string, entry: CacheEntry): Promise<void> {\r\n        // If updating existing key, no need to check size\r\n        if (!this.store.has(key) && this.store.size >= this.maxEntries) {\r\n            this.evictOldestEntry();\r\n        }\r\n        \r\n        this.store.set(key, entry);\r\n    }\r\n\r\n    private evictOldestEntry(): void {\r\n        const iterator = this.store.keys();\r\n        const firstKey = iterator.next().value;\r\n        if (firstKey !== undefined) {\r\n            this.store.delete(firstKey);\r\n        }\r\n    }\r\n\r\n    async delete(key: string): Promise<void> {\r\n        this.store.delete(key);\r\n    }\r\n\r\n    async clear(): Promise<void> {\r\n        this.store.clear();\r\n    }\r\n\r\n    get defaultKeyPrefix(): string {\r\n        return 'mem';\r\n    }\r\n\r\n    async size(): Promise<number> {\r\n        return this.store.size;\r\n    }\r\n\r\n    setMaxEntries(maxEntries: number): void {\r\n        this.maxEntries = maxEntries;\r\n        this.enforceMaxEntries();\r\n    }\r\n\r\n    private enforceMaxEntries(): void {\r\n        const excessCount = this.store.size - this.maxEntries;\r\n        if (excessCount <= 0) return;\r\n        \r\n        const iterator = this.store.keys();\r\n        for (let i = 0; i < excessCount; i++) {\r\n            const key = iterator.next().value;\r\n            if (key === undefined) break;\r\n            this.store.delete(key);\r\n        }\r\n    }\r\n\r\n    getMaxEntries(): number {\r\n        return this.maxEntries;\r\n    }\r\n\r\n    async destroy(): Promise<void> {\r\n        this.store.clear();\r\n    }\r\n}","import { CacheService } from '../cache/cache-service';\r\nimport { MemoryCache } from '../cache/memory-cache';\r\n\r\ndeclare global {\r\n    interface Window {\r\n        counterInterop: {\r\n            invokeMethodAsync: (method: string, ...args: any[]) => Promise<any>;\r\n        };\r\n    }\r\n}\r\n\r\nconst cacheService = new CacheService(new MemoryCache());\r\n\r\n/**\r\n * 呼叫 .NET Interop 方法，支援快取與錯誤保護\r\n * @param value    字串，格式可為 \"Invoke:DotNet('methodName')\" 或僅 methodName\r\n * @param args     傳給 .NET 方法的參數陣列\r\n * @param settings 可選設定：\r\n *                 - cache: 是否啟用快取，預設 true\r\n *                 - regionName: 快取區域名稱，預設 'dotnetInterop'\r\n * @return Promise<any> 回傳 .NET 方法的結果\r\n */\r\nexport async function invokeDotNetMethodAsync(\r\n    methodName: string,\r\n    args: any[] = [],\r\n    settings: { cache?: boolean, regionName?: string } = {}\r\n): Promise<any> {\r\n    if (typeof methodName !== 'string') {\r\n        throw new TypeError('methodName 必須是字串');\r\n    }\r\n\r\n    settings = { cache: true, regionName: 'dotnetInterop', ...settings };\r\n\r\n    // 組成 key：methodName + args\r\n    const key = `${methodName}:${JSON.stringify(args)}`;\r\n    const useCache = settings.cache ?? true;\r\n\r\n    if (useCache) {\r\n        const cachedValue = await cacheService.get<any>(key);\r\n        if (cachedValue !== null) {\r\n            return cachedValue;\r\n        }\r\n    }\r\n\r\n    try {\r\n        const result = await window.counterInterop?.invokeMethodAsync(\r\n            methodName,\r\n            ...args\r\n        );\r\n\r\n        if (useCache) {\r\n            await cacheService.set(key, result);\r\n        }\r\n        return result;\r\n    } catch (err) {\r\n        console.error(`[Interop] 無法呼叫 '${methodName}'：`, err);\r\n        return 'unknown';\r\n    }\r\n}\r\n\r\n/**\r\n * 清除 .NET Interop 方法的快取\r\n * @param regionName (可選) 指定要清除的 region，預設為 'dotnetInterop'\r\n * @return Promise<void>\r\n */\r\nexport async function clearDotNetMethodCache(): Promise<void> {\r\n    await cacheService.clear();\r\n}",":host {\r\n  display: block;\r\n}\r\n\r\n.input-group.input-group-static .form-control {\r\n  background-color: white;\r\n  line-height: 1.25rem;\r\n  padding: .25rem;\r\n}\r\n\r\n.detail-button {\r\n  cursor: pointer;\r\n}","import { Component, Element, Event, EventEmitter, forceUpdate, h, Host, Listen, Method, Prop, State } from '@stencil/core';\r\nimport { isCommandString, parseCommandString } from '../../../utils/command-utils/command-utils';\r\nimport { invokeDotNetMethodAsync } from '../../../utils/dotnet-method-invoker/dotnet-method-invoker';\r\nimport { FnIconSwitch } from '../../../utils/functional/functional';\r\nimport {\r\n  appendHighlight,\r\n  debounce,\r\n  escapeHtml,\r\n  evaluateConditions,\r\n  getFieldValue,\r\n  isConditionGroups,\r\n  isConditions,\r\n  replacePlaceholders,\r\n  resolvePropertyValue,\r\n  setFieldValue,\r\n} from '../../../utils/utils';\r\nimport type { ICheckboxItem } from '../../storm-checkbox-group/storm-checkbox-group';\r\nimport type { CheckboxGroupInterface, TableColumnInterface } from '../interface';\r\nimport { StormTable } from '../storm-table';\r\nimport type { ClickActionDetail } from '../storm-table-toolbar/interface';\r\nimport type {\r\n  CellValue,\r\n  CheckboxGroupControlOptionInterface,\r\n  CheckControlOptionInterface,\r\n  DropdownControlOptionInterface,\r\n  DropdownTreeControlOptionInterface,\r\n  TextAreaControlOptionInterface,\r\n} from './interface';\r\n\r\n@Component({\r\n  tag: 'storm-table-cell',\r\n  styleUrl: 'storm-table-cell.css',\r\n  shadow: false,\r\n})\r\nexport class StormTableCell {\r\n  @State() private cellData: any;\r\n  @State() private cellType: string = 'text';\r\n  @State() private isDisabled: boolean = false;\r\n  @State() private prependText?: string;\r\n  @State() private appendText?: string;\r\n  private __cellValueEditingEvent?: CellValue;\r\n\r\n  @Element() host: HTMLElement;\r\n\r\n  @Prop() table: StormTable;\r\n  @Prop() row: object;\r\n  @Prop() index: number;\r\n  @Prop() column: TableColumnInterface;\r\n  @Prop({ mutable: true }) timeStamp?: number;\r\n\r\n  @Event() clickCell: EventEmitter<{ id: string; field: string | number }>;\r\n  @Event() clickAction: EventEmitter<ClickActionDetail>;\r\n  @Event() valueChanged: EventEmitter<any>;\r\n\r\n  @Event() cellWillValueChanged: EventEmitter<CellValue>;\r\n  @Event() cellValueChanged: EventEmitter<CellValue>;\r\n  @Event() cellDidValueChanged: EventEmitter<CellValue>;\r\n  @Event() cellValueChangedOnBlur: EventEmitter<CellValue>;\r\n\r\n  @Listen('valueChanged')\r\n  valueChangedHandler(ev: CustomEvent<any>) {\r\n    if (!this.column?.field) return;\r\n\r\n    const eventDetail = {\r\n      id: getFieldValue(this.row, this.table.fieldId) as string,\r\n      field: this.column.field,\r\n      value: ev.detail,\r\n    };\r\n    this.cellWillValueChanged.emit(eventDetail);\r\n  }\r\n\r\n  @Listen('cellWillValueChanged')\r\n  cellWillValueChangedHandler(ev: CustomEvent<CellValue>) {\r\n    if (this.table.sidePagination === 'stencil') {\r\n      this.cellValueChanged.emit(ev.detail);\r\n    }\r\n  }\r\n\r\n  @Listen('cellValueChanged')\r\n  cellValueChangedHandler(ev: CustomEvent<CellValue>) {\r\n    setFieldValue(this.row, this.column.field, ev.detail.value);\r\n    if (this.table.sidePagination === 'stencil') {\r\n      this.cellDidValueChanged.emit(ev.detail);\r\n    }\r\n  }\r\n\r\n  @Listen('cellDidValueChanged')\r\n  cellDidValueChangedHandler(ev: CustomEvent<CellValue>) {\r\n    this.__cellValueEditingEvent = ev.detail;\r\n    this.rerender();\r\n  }\r\n\r\n  @Listen('focusout')\r\n  focusoutHandler(_: FocusEvent) {\r\n    if (this.__cellValueEditingEvent) {\r\n      this.cellValueChangedOnBlur.emit(this.__cellValueEditingEvent);\r\n      this.__cellValueEditingEvent = undefined;\r\n    }\r\n  }\r\n\r\n  private readonly rerender = debounce(() => {\r\n    forceUpdate(this);\r\n  }, 100);\r\n\r\n  @Method()\r\n  async dispatchCustomEvent(type: string, detail?: object): Promise<void> {\r\n    this[type].emit(detail);\r\n  }\r\n\r\n  renderSerialNumber() {\r\n    return (this.table.pageNumber - 1) * this.table.pageSize + this.index + 1;\r\n  }\r\n\r\n  renderDetail() {\r\n    return (\r\n      <FnIconSwitch\r\n        onToggle={on => {\r\n          const detailRow = this.table.host.shadowRoot.querySelector('.row-detail[data-index=\"' + this.index + '\"]');\r\n          if (detailRow) {\r\n            detailRow.classList.toggle('d-none', !on);\r\n          }\r\n        }}\r\n      />\r\n    );\r\n  }\r\n\r\n  renderActionControl() {\r\n    return (\r\n      <storm-table-toolbar\r\n        table={this.table}\r\n        column={this.column}\r\n        row={this.row}\r\n        timeStamp={this.timeStamp}\r\n        onClickAction={ev => {\r\n          ev.stopPropagation();\r\n          this.clickAction.emit(ev.detail);\r\n        }}\r\n      ></storm-table-toolbar>\r\n    );\r\n  }\r\n\r\n  renderInputControl() {\r\n    return (\r\n      <div class=\"input-group input-group-static\">\r\n        <input\r\n          class=\"form-control\"\r\n          type=\"text\"\r\n          aria-label={this.column.title}\r\n          disabled={this.isDisabled}\r\n          value={getFieldValue(this.row, this.column.field) as string | number | string[]}\r\n          onClick={ev => ev.stopPropagation()}\r\n          onChange={ev => {\r\n            ev.stopPropagation();\r\n            this.valueChanged.emit((ev.target as HTMLInputElement).value);\r\n          }}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderTextareaControl() {\r\n    const option = this.cellData as TextAreaControlOptionInterface;\r\n    return (\r\n      <div class=\"input-group input-group-static\">\r\n        <textarea\r\n          class=\"form-control\"\r\n          disabled={this.isDisabled}\r\n          cols={option.cols}\r\n          rows={option.rows}\r\n          title={this.column.title}\r\n          value={getFieldValue(this.row, this.column.field) as string}\r\n          onClick={ev => ev.stopPropagation()}\r\n          onChange={ev => {\r\n            ev.stopPropagation();\r\n            this.valueChanged.emit((ev.target as HTMLInputElement).value);\r\n          }}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderDropdownControl() {\r\n    const option = this.cellData as DropdownControlOptionInterface;\r\n    const dataSet = option.dataSet;\r\n    return (\r\n      <storm-dropdown\r\n        disabled={this.isDisabled}\r\n        label={option.label}\r\n        value={getFieldValue(this.row, this.column.field) as string | string[]}\r\n        dataSet={dataSet}\r\n        nullable={option.nullable ?? false}\r\n        searchable={option.searchable ?? true}\r\n        selection={'single'}\r\n        timeStamp={this.timeStamp}\r\n        type={'select'}\r\n        onValueChanged={ev => {\r\n          ev.stopPropagation();\r\n          this.valueChanged.emit(ev.detail);\r\n        }}\r\n      ></storm-dropdown>\r\n    );\r\n  }\r\n\r\n  renderDropdownTreeControl() {\r\n    const option = this.cellData as DropdownTreeControlOptionInterface;\r\n    let dataSet = option.dataSet;\r\n\r\n    if (option.dataSets && isConditionGroups(option.dataSets)) {\r\n      const matchingConditionGroup = option.dataSets.find(conditionGroup => isConditions(conditionGroup.conditions) && evaluateConditions(conditionGroup.conditions, this.row));\r\n      if (matchingConditionGroup) {\r\n        dataSet = matchingConditionGroup.value;\r\n      }\r\n    }\r\n    return (\r\n      <storm-dropdown-tree\r\n        disabled={this.isDisabled}\r\n        loading={option.loading}\r\n        partialLoad={option.partialLoad}\r\n        label={option.label}\r\n        value={getFieldValue(this.row, this.column.field) as string | string[]}\r\n        text={option.fieldText ? (getFieldValue(this.row, option.fieldText) as string) : null}\r\n        dataSet={dataSet}\r\n        dataSource={option.dataSource}\r\n        fieldId={option.fieldId ?? 'id'}\r\n        fieldLabel={option.fieldLabel ?? 'label'}\r\n        fieldChildren={option.fieldChildren ?? 'children'}\r\n        expandLevel={option.expandLevel ?? 2}\r\n        nodeSelectableRule={option.nodeSelectableRule}\r\n        nullable={option.nullable ?? false}\r\n        searchable={option.searchable ?? true}\r\n        selection={'single'}\r\n        timeStamp={this.timeStamp}\r\n        onValueChanged={ev => {\r\n          ev.stopPropagation();\r\n          this.valueChanged.emit(ev.detail);\r\n        }}\r\n        onTextChanged={ev => {\r\n          ev.stopPropagation();\r\n          if (option.fieldText) setFieldValue(this.row, option.fieldText, ev.detail);\r\n        }}\r\n        onSearchChanged={ev => {\r\n          ev.stopPropagation();\r\n        }}\r\n      ></storm-dropdown-tree>\r\n    );\r\n  }\r\n\r\n  renderCheckControl() {\r\n    return (\r\n      <storm-checkbox\r\n        type={this.cellType === 'checkbox' ? 'checkbox' : 'radio'}\r\n        disabled={this.isDisabled}\r\n        checked={getFieldValue(this.row, this.column.field) as boolean}\r\n      ></storm-checkbox>\r\n    );\r\n  }\r\n\r\n  renderCheckboxGroupControl() {\r\n    const option = this.cellData as CheckboxGroupControlOptionInterface;\r\n    const value = getFieldValue(this.row, this.column.field) as any;\r\n    const dataSet = (option.dataSet as CheckboxGroupInterface[])\r\n      .filter(x => {\r\n        if (x.visible === undefined) return true;\r\n        return typeof x.visible === 'function' ? x.visible(this.row) : x.visible;\r\n      })\r\n      .map(\r\n        x =>\r\n          ({\r\n            id: x.id,\r\n            label: x.label,\r\n            labelClasses: x.labelClasses,\r\n            checked: x.checked,\r\n            disabled: x.disabled,\r\n          } as ICheckboxItem),\r\n      );\r\n    return (\r\n      <div class=\"input-group input-group-static\">\r\n        <storm-checkbox-group\r\n          disabled={this.isDisabled}\r\n          type={option.groupType}\r\n          value={value}\r\n          dataSet={dataSet}\r\n          isSwitch={option.isSwitch ?? false}\r\n          isInline={option.isInline ?? true}\r\n          onValueChanged={ev => {\r\n            ev.stopPropagation();\r\n            this.valueChanged.emit(ev.detail);\r\n          }}\r\n        ></storm-checkbox-group>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderCellContent() {\r\n    switch (this.cellType) {\r\n      case 'action':\r\n        return this.renderActionControl();\r\n      case 'input':\r\n        return this.renderInputControl();\r\n      case 'checkbox':\r\n      case 'radio':\r\n        return this.renderCheckControl();\r\n      case 'textarea':\r\n        return this.renderTextareaControl();\r\n      case 'dropdown':\r\n        return this.renderDropdownControl();\r\n      case 'dropdownTree':\r\n        return this.renderDropdownTreeControl();\r\n      case 'checkboxGroup':\r\n        return this.renderCheckboxGroupControl();\r\n      case 'serialNumber':\r\n        return this.renderSerialNumber();\r\n      case 'detail':\r\n        return this.renderDetail();\r\n      case 'text':\r\n        return this.renderCellValue();\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n\r\n  renderCell() {\r\n    if (!this.prependText && !this.appendText) {\r\n      return this.renderCellContent();\r\n    } else {\r\n      return (\r\n        <div class=\"d-flex flex-row gap-1 align-items-center\">\r\n          {this.prependText && <span>{this.prependText}</span>}\r\n          {this.renderCellContent()}\r\n          {this.appendText && <span>{this.appendText}</span>}\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  renderCellValue() {\r\n    let content = getFieldValue(this.row, this.column.field) as any;\r\n\r\n    if (typeof this.column.render === 'function') {\r\n      content = this.column.render(content, this.row, this.index);\r\n    } else {\r\n      if (Array.isArray(content)) {\r\n        content = content.filter(item => item != null && item !== '').join('、');\r\n      }\r\n\r\n      if (this.table.escape && typeof content !== 'boolean' && content != null) {\r\n        content = escapeHtml(content);\r\n      }\r\n\r\n      if (content != null && this.column.transform && this.column.transform[content.toString()]) {\r\n        content = this.column.transform[content];\r\n      } else if (content && this.table.searchable && this.table.searchText) {\r\n        content = appendHighlight(content, this.table.searchText);\r\n      }\r\n    }\r\n\r\n    const template = this.column.cellTemplate || this.table.cellTemplate;\r\n    const displayValue = content != null && content.toString().trim().length > 0 ? content : '-';\r\n    return (\r\n      <span\r\n        innerHTML={replacePlaceholders(template, {\r\n          value: displayValue,\r\n          row: this.row,\r\n          index: this.index,\r\n        })}\r\n      ></span>\r\n    );\r\n  }\r\n\r\n  async componentWillRender() {\r\n    if (!this.column) {\r\n      this.resetCellState();\r\n      return;\r\n    }\r\n\r\n    const [cellType, cellData] = await Promise.all([this.resolvePropertyValueAsync<string>(this.column, 'type'), this.resolvePropertyValueAsync(this.column, 'data')]);\r\n\r\n    this.cellType = cellType || 'text';\r\n    this.cellData = cellData;\r\n\r\n    if (cellData && typeof cellData === 'object' && !Array.isArray(cellData)) {\r\n      const [disabled, prependText, appendText] = await Promise.all([\r\n        this.resolvePropertyValueAsync<boolean>(cellData, 'disabled'),\r\n        this.resolvePropertyValueAsync<string>(cellData, 'prependText'),\r\n        this.resolvePropertyValueAsync<string>(cellData, 'appendText'),\r\n      ]);\r\n\r\n      this.isDisabled = disabled ?? false;\r\n      this.prependText = prependText;\r\n      this.appendText = appendText;\r\n\r\n      if (this.isDisabled && (cellType === 'input' || cellType === 'textarea')) {\r\n        this.cellType = 'text';\r\n      }\r\n    } else {\r\n      this.resetControlState();\r\n    }\r\n  }\r\n\r\n  private resetCellState(): void {\r\n    this.cellType = 'text';\r\n    this.cellData = undefined;\r\n    this.resetControlState();\r\n  }\r\n\r\n  private resetControlState(): void {\r\n    this.isDisabled = false;\r\n    this.prependText = undefined;\r\n    this.appendText = undefined;\r\n    this.__cellValueEditingEvent = undefined;\r\n  }\r\n\r\n  private async resolvePropertyValueAsync<T>(targetObject: any, propertyName: string): Promise<T> {\r\n    const result = resolvePropertyValue(targetObject, propertyName, [this.row, this.index, this.column]);\r\n    if (isCommandString(result)) {\r\n      const parsed = parseCommandString(result);\r\n      if (parsed.command === 'Invoke:DotNet') {\r\n        const rowId = getFieldValue(this.row, this.table?.fieldId) as string;\r\n        try {\r\n          return await invokeDotNetMethodAsync(parsed.value, [rowId, this.index, this.column.field], { cache: true });\r\n        } catch (error) {\r\n          console.error('InvokeDotNetMethod 執行失敗', error);\r\n          throw error;\r\n        }\r\n      }\r\n      if (parsed.command === 'Get:Field') {\r\n        return getFieldValue(this.row, parsed.value) as T;\r\n      }\r\n    }\r\n\r\n    if (isConditions(result)) {\r\n      return evaluateConditions(result, this.row) as T;\r\n    }\r\n\r\n    if (isConditionGroups(result)) {\r\n      for (const conditionGroup of result) {\r\n        if (isConditions(conditionGroup.conditions) && evaluateConditions(conditionGroup.conditions, this.row)) {\r\n          return conditionGroup.value as T;\r\n        }\r\n      }\r\n      return undefined;\r\n    }\r\n\r\n    if (result instanceof Promise) {\r\n      try {\r\n        const resolved = await result;\r\n        return resolved;\r\n      } catch (error) {\r\n        console.error('屬性 Promise 解析失敗', error);\r\n        throw error;\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host\r\n        onClick={ev => {\r\n          if (this.cellType === 'checkbox' || this.cellType === 'radio') {\r\n            const option = this.cellData as CheckControlOptionInterface;\r\n            if (option && option.disabled) {\r\n              ev.stopPropagation();\r\n              ev.preventDefault();\r\n              return;\r\n            }\r\n          }\r\n          this.clickCell.emit({ id: getFieldValue(this.row, this.table.fieldId) as string, field: this.column.field });\r\n        }}\r\n      >\r\n        {this.renderCell()}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"version":3}