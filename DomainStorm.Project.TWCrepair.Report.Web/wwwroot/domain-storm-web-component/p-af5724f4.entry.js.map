{"version":3,"names":["stormTableCss","StormTable","_pageDate","_cellCheckChangeTimeoutRafId","_bodyRef","_selectedInfoRef","_breakpoints","size","width","Infinity","fieldId","fieldSelected","fieldIndex","pagination","sidePagination","searchable","pageSizeMenu","pageInfo","selectedInfo","escape","classes","cellTemplate","clickRowTo","selection","pageList","tableHeight","columns","dataSet","pageNumber","pageSize","searchText","sortName","sortOrder","groupBy","totalRows","totalSelected","totalChecked","isColumnResponsive","expand","visibleColumnCount","pageNumberChange","pageSizeChange","sortChange","searchChanged","tableWillRender","rowMove","rowWillSelect","rowWillUnselect","rowSelect","rowUnselect","rowDidSelect","rowDidUnselect","rowSelectChange","selectWillChange","selectChange","selectDidChange","cellWillCheck","cellWillUncheck","cellCheck","cellUncheck","cellDidCheck","cellDidUncheck","cellCheckChange","checkWillChange","checkChange","checkDidChange","clickRow","watchDataSetHandler","this","initDataSet","rerender","watchColumnsHandler","initColumns","watchTotalSelectedHandler","_newValue","_oldValue","debouncedDisplaySelectedCount","searchChangedHandler","ev","detail","emit","pageNumberChangeHandler","pageSizeChangeHandler","sortChangeHandler","rowWillSelectHandler","unselectAll","rowSelectHandler","row","getRowById","setFieldValue","updateRowSelection","rowDidSelectHandler","rowWillUnselectHandler","rowUnselectHandler","rowDidUnselectHandler","rowSelectChangeHandler","_","debouncedRowSelectionUpdate","selectWillChangeHandler","selected","getSelected","length","selectChangeHandler","cellWillCheckHandler","col","getColumnByField","field","type","uncheckAll","cellCheckHandler","id","updateRowCheckbox","column","cellDidCheckHandler","cellWillUncheckHandler","cellUncheckHandler","cellDidUncheckHandler","cellCheckChangeHandler","rafId","clearTimeout","setTimeout","checkWillChangeHandler","checked","getChecked","total","checkChangeHandler","setTotalChecked","updateColumnCheckbox","clickCellHandler","checkClick","clickRowHandler","getFieldValue","unselect","select","moveRow","from","to","arrayMove","forEach","index","rowIndex","dispatchCustomEvent","dispatchCellCustomEvent","cell","host","shadowRoot","querySelector","getRowAt","find","filter","selectAll","check","uncheck","checkAll","rowsToCheck","option","resolveColumnData","disabled","rowsToUncheck","args","result","resolvePropertyValue","Promise","debounce","async","forceUpdate","isSelectedInfoVisible","innerHTML","data","unchecked","isPaginationVisible","isPageSizeMenuVisible","getTotalChecked","handleSearchChanged","stopPropagation","value","trim","handleColumnCheckChange","target","handleColumnClick","sortable","undefined","renderPagination","h","class","Math","ceil","onPageChange","renderPageSizeMenu","onChange","Number","currentTarget","map","page","renderSearch","FnSearchInput","placeholder","onValueChanged","renderPageInfo","renderSelectedInfo","ref","elm","renderTableTop","renderTableBottom","checkboxRadioColumns","checkboxRadioColumnsLength","dataSetLength","isStencilPagination","columnCheckedCounts","Map","set","selectedCount","sortData","fieldIndexValue","fieldSelectedValue","generateUid","i","fieldValue","get","count","isModuleFunctionString","createFunctionFromString","includes","toString","responsiveClassPairs","Object","entries","className","startsWith","responsive","rwdClassReversal","hasNone","some","cls","endsWith","hasCell","noneClass","replace","cellClass","JSON","parse","error","console","warn","unshift","visible","checkColumn","_resizeObserver","responsiveResize","ResizeObserver","refreshColumnVisibility","observe","_breakpointIndex","tableElem","tableWidth","offsetWidth","currentBreakpoint","prevBreakpoint","newBreakpointIndex","breakpointsLength","classesToAdd","classesToRemove","bpWidth","isLast","isMatch","push","classList","add","remove","visibleColumns","hasResponsiveHidden","columnsLength","isVisible","isColumnVisible","elems","querySelectorAll","elemsArray","Array","elem","colspanValue","fullCellElems","setAttribute","isArray","componentWillLoad","SharedStyles","applyShadowRootStylesAsync","disconnectedCallback","values","disconnect","componentWillRender","parseClassNames","toLowerCase","searchableColumns","searchableColumnsLength","String","sortKeys","sort","a","b","key","aValue","bValue","isDesc","localeCompare","render","slice","Host","border","style","height","table","timeStamp","Date","now","componentDidRender"],"sources":["src/components/storm-table/storm-table.css?tag=storm-table&encapsulation=shadow","src/components/storm-table/storm-table.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n  line-height: 1;\r\n}\r\n\r\n:host .table td,\r\n:host .table th {\r\n  white-space: pre-wrap;\r\n}\r\n\r\n:host .table thead {\r\n  z-index: 1;\r\n}\r\n\r\n:host .table.table-sm thead th {\r\n  padding: 0.5rem 0.25rem;\r\n}\r\n\r\n:host .table thead th {\r\n  padding: 0.75rem 0.5rem;\r\n}\r\n\r\n:host .table thead th.thead-xxs {\r\n  width: 2.3rem;\r\n}\r\n\r\n:host .table-sm thead th.thead-xxs {\r\n  padding: 0.25rem;\r\n}\r\n\r\n:host .form-check {\r\n  padding: 0;\r\n}\r\n\r\n:host .table-sorter {\r\n  cursor: pointer;\r\n}\r\n\r\n:host .table-sorter>.cell {\r\n  display: inline-block;\r\n  height: 100%;\r\n  position: relative;\r\n  width: 100%;\r\n  line-height: 1.1;\r\n}\r\n\r\n:host .table-sorter>.cell:before {\r\n  border-top: 5px solid #000;\r\n  bottom: .15rem;\r\n}\r\n\r\n:host .table-sorter>.cell:after {\r\n  border-bottom: 5px solid #000;\r\n  border-top: 5px solid transparent;\r\n  top: -.2rem;\r\n}\r\n\r\n:host .table-sorter>.cell:after,\r\n:host .table-sorter>.cell:before {\r\n  content: \"\";\r\n  height: 0;\r\n  width: 0;\r\n  position: absolute;\r\n  right: 5px;\r\n  border-left: 5px solid transparent;\r\n  border-right: 5px solid transparent;\r\n  opacity: .3;\r\n}\r\n\r\n:host .table-sorter.asc>.cell:after,\r\n:host .table-sorter.desc>.cell:before {\r\n  opacity: .7;\r\n}\r\n\r\n:host .table-sorter.asc>.cell:before,\r\n:host .table-sorter.desc>.cell:after {\r\n  opacity: 0;\r\n}\r\n\r\n:host table {\r\n  table-layout: fixed;\r\n}\r\n\r\n:host .no-records-found {\r\n  height: 30vh;\r\n}\r\n\r\n:host .fixed-table-header th {\r\n  position: sticky;\r\n  top: 0;\r\n}\r\n\r\n:host .fixed-table-header thead {\r\n  position: sticky;\r\n  top: 0;\r\n  background: white;\r\n}\r\n\r\n:host .fixed-table-header thead tr {\r\n  border-top-width: 0;\r\n}\r\n\r\n:host .table-description {\r\n  font-size: 0.5rem;\r\n  font-weight: normal !important;\r\n}\r\n\r\n:host .table-top,\r\n:host .table-bottom {\r\n  padding: 0.5rem;\r\n}\r\n\r\n:host .table-top label {\r\n  margin-bottom: 0;\r\n}\r\n\r\n:host .table-selectedInfo,\r\n:host .table-pageSizeMenu,\r\n:host .table-pageInfo {\r\n  float: left;\r\n  color: #7b809a;\r\n  font-size: .875rem;\r\n}\r\n\r\n:host .table-selectedInfo,\r\n:host .table-pageInfo {\r\n  margin: 0.7rem 0;\r\n  padding-right: 2rem;\r\n}\r\n\r\n:host .table-search,\r\n:host .table-pagination {\r\n  float: right;\r\n}\r\n\r\n:host .table .form-check>.form-check-input[type=radio] {\r\n  background-color: #fff;\r\n  cursor: pointer;\r\n}\r\n\r\n:host .table-bottom:after,\r\n:host .table-top:after {\r\n  clear: both;\r\n  content: \" \";\r\n  display: table;\r\n}\r\n\r\n:host .table-search input {\r\n  font-size: .875rem;\r\n  color: #495057;\r\n  border: 1px solid #f0f2f5;\r\n  border-radius: 0.375rem;\r\n  padding: 6px 12px;\r\n}\r\n\r\n:host .table-top .table-pageSizeMenu label select {\r\n  border-color: #f0f2f5;\r\n  border-radius: 0.375rem;\r\n  padding: 6px;\r\n}\r\n\r\n:host .tr.table-sorter {\r\n  cursor: pointer;\r\n}\r\n\r\n:host tr storm-toolbar storm-button .btn {\r\n  width: 1.5rem;\r\n  height: 1.5rem;\r\n  padding: 0.3rem 0.3rem;\r\n}\r\n\r\n:host tr:hover storm-toolbar.storm-dynamic-label storm-button .btn:not(.btn-icon-only) {\r\n  width: auto;\r\n  height: auto;\r\n  padding: .06rem .5rem .06rem .2rem;\r\n}\r\n\r\n:host tr storm-toolbar.storm-dynamic-label storm-button .storm-button-label {\r\n  display: none;\r\n}\r\n\r\n:host tr:hover storm-toolbar.storm-dynamic-label storm-button .storm-button-label {\r\n  display: block;\r\n}","import { Component, Element, Event, EventEmitter, forceUpdate, h, Host, Listen, Method, Prop, Watch } from '@stencil/core';\r\nimport { FnSearchInput } from '../../utils/functional/functional';\r\nimport { SharedStyles } from '../../utils/shared-styles';\r\nimport {\r\n  arrayMove,\r\n  createFunctionFromString,\r\n  debounce,\r\n  generateUid,\r\n  getFieldValue,\r\n  isModuleFunctionString,\r\n  parseClassNames,\r\n  resolvePropertyValue,\r\n  setFieldValue,\r\n} from '../../utils/utils';\r\nimport type { RowMoveInterface, TableColumnInterface, TableRenderOption } from './interface';\r\nimport type {\r\n  CheckboxGroupControlOptionInterface,\r\n  CheckControlOptionInterface,\r\n  ControlOptionInterface,\r\n  DropdownTreeControlOptionInterface,\r\n  TextAreaControlOptionInterface,\r\n} from './storm-table-cell/interface';\r\n\r\n@Component({\r\n  tag: 'storm-table',\r\n  styleUrl: 'storm-table.css',\r\n  shadow: true,\r\n})\r\nexport class StormTable {\r\n  private _pageDate: object[];\r\n  private _cellCheckChangeTimeoutRafId: Record<string, NodeJS.Timeout> = {};\r\n\r\n  private _bodyRef: HTMLStormTableBodyElement;\r\n  private _selectedInfoRef: HTMLDivElement;\r\n  private readonly _breakpoints = [\r\n    { size: '4xs', width: 239 },\r\n    { size: '3xs', width: 359 },\r\n    { size: 'xxs', width: 479 },\r\n    { size: 'xs', width: 576 },\r\n    { size: 'sm', width: 768 },\r\n    { size: 'md', width: 992 },\r\n    { size: 'lg', width: 1200 },\r\n    { size: 'xl', width: 1400 },\r\n    { size: 'xxl', width: 1600 },\r\n    { size: '3xl', width: 1920 },\r\n    { size: '4xl', width: Infinity },\r\n  ];\r\n\r\n  @Element() host: HTMLElement;\r\n  @Prop({ mutable: true }) fieldId: string | number = 'id';\r\n  @Prop({ mutable: true }) fieldSelected: string = '__selected';\r\n  @Prop() fieldIndex: string = '__index';\r\n\r\n  @Prop() pagination: boolean = false;\r\n  @Prop() sidePagination: 'razor' | 'stencil' = 'stencil';\r\n  @Prop() searchable: boolean = false;\r\n  @Prop() pageSizeMenu: boolean = true;\r\n  @Prop() pageInfo: boolean = true;\r\n  @Prop() selectedInfo: boolean = true;\r\n  @Prop() escape: boolean = true;\r\n  @Prop({ mutable: true }) classes: Record<string, boolean> | string;\r\n\r\n  @Prop() cellTemplate: string = '{value}';\r\n\r\n  @Prop() clickRowTo?: 'select' | 'check';\r\n  @Prop() selection: 'single' | 'multiple' | 'none' = 'single';\r\n  @Prop() pageList: Array<number> = [5, 10, 15, 20, 25];\r\n  @Prop() tableHeight?: string;\r\n\r\n  @Prop({ mutable: true, reflect: false }) columns: TableColumnInterface[];\r\n  @Prop({ mutable: true, reflect: false }) dataSet: object[];\r\n  @Prop({ mutable: true }) pageNumber: number = 1;\r\n  @Prop({ mutable: true }) pageSize: number = 10;\r\n  @Prop({ mutable: true }) searchText?: string;\r\n  @Prop({ mutable: true }) sortName?: string | number;\r\n  @Prop({ mutable: true }) sortOrder?: 'asc' | 'desc';\r\n  @Prop({ mutable: true }) groupBy?: string;\r\n\r\n  @Prop({ mutable: true }) totalRows: number;\r\n  @Prop({ mutable: true }) totalSelected: number;\r\n  @Prop({ mutable: true, reflect: false }) totalChecked: any;\r\n\r\n  @Prop({ mutable: true, reflect: false }) isColumnResponsive: boolean = false;\r\n\r\n  @Prop({ reflect: false }) expand: { visibleColumnCount: number } = { visibleColumnCount: 0 };\r\n\r\n  @Event() pageNumberChange: EventEmitter<number>;\r\n  @Event() pageSizeChange: EventEmitter<number>;\r\n  @Event() sortChange: EventEmitter<{ sortName?: string | number; sortOrder?: 'asc' | 'desc' }>;\r\n  @Event() searchChanged: EventEmitter<string>;\r\n  @Event() tableWillRender: EventEmitter<TableRenderOption>;\r\n  @Event() rowMove: EventEmitter<RowMoveInterface>;\r\n\r\n  @Event() rowWillSelect: EventEmitter<string>;\r\n  @Event() rowWillUnselect: EventEmitter<string>;\r\n  @Event() rowSelect: EventEmitter<string>;\r\n  @Event() rowUnselect: EventEmitter<string>;\r\n  @Event() rowDidSelect: EventEmitter<object>;\r\n  @Event() rowDidUnselect: EventEmitter<object>;\r\n  @Event() rowSelectChange: EventEmitter<object>;\r\n  @Event() selectWillChange: EventEmitter;\r\n  @Event() selectChange: EventEmitter<number>;\r\n  @Event() selectDidChange: EventEmitter<number>;\r\n\r\n  @Event() cellWillCheck: EventEmitter<{ id: string; field: string | number }>;\r\n  @Event() cellWillUncheck: EventEmitter<{ id: string; field: string | number }>;\r\n  @Event() cellCheck: EventEmitter<{ id: string; field: string | number }>;\r\n  @Event() cellUncheck: EventEmitter<{ id: string; field: string | number }>;\r\n  @Event() cellDidCheck: EventEmitter<{ row: object; column: TableColumnInterface }>;\r\n  @Event() cellDidUncheck: EventEmitter<{ row: object; column: TableColumnInterface }>;\r\n  @Event() cellCheckChange: EventEmitter<{ row: object; column: TableColumnInterface }>;\r\n\r\n  @Event() checkWillChange: EventEmitter<string | number>;\r\n  @Event() checkChange: EventEmitter<{ total: number; field: string | number }>;\r\n  @Event() checkDidChange: EventEmitter<{ total: number; column: TableColumnInterface }>;\r\n\r\n  @Event() clickRow: EventEmitter<string>;\r\n\r\n  @Watch('dataSet')\r\n  watchDataSetHandler() {\r\n    this.initDataSet();\r\n    this.rerender();\r\n  }\r\n\r\n  @Watch('columns')\r\n  async watchColumnsHandler() {\r\n    this.initColumns();\r\n  }\r\n\r\n  @Watch('totalSelected')\r\n  watchTotalSelectedHandler(_newValue: number, _oldValue: number) {\r\n    this.debouncedDisplaySelectedCount();\r\n  }\r\n\r\n  @Listen('searchChanged')\r\n  searchChangedHandler(ev: CustomEvent<string>) {\r\n    if (this.sidePagination === 'stencil') {\r\n      this.searchText = ev.detail;\r\n    } else {\r\n      this.tableWillRender.emit({\r\n        pageNumber: this.pageNumber,\r\n        pageSize: this.pageSize,\r\n        sortName: this.sortName,\r\n        sortOrder: this.sortOrder,\r\n        searchText: ev.detail,\r\n      });\r\n    }\r\n  }\r\n\r\n  @Listen('pageNumberChange')\r\n  pageNumberChangeHandler(ev: CustomEvent<number>) {\r\n    if (this.sidePagination === 'stencil') {\r\n      this.pageNumber = ev.detail;\r\n    } else {\r\n      this.tableWillRender.emit({ pageNumber: ev.detail, pageSize: this.pageSize, sortName: this.sortName, sortOrder: this.sortOrder, searchText: this.searchText });\r\n    }\r\n  }\r\n\r\n  @Listen('pageSizeChange')\r\n  pageSizeChangeHandler(ev: CustomEvent<number>) {\r\n    if (this.sidePagination === 'stencil') {\r\n      this.pageSize = ev.detail;\r\n    } else {\r\n      this.tableWillRender.emit({ pageNumber: this.pageNumber, pageSize: ev.detail, sortName: this.sortName, sortOrder: this.sortOrder, searchText: this.searchText });\r\n    }\r\n  }\r\n\r\n  @Listen('sortChange')\r\n  sortChangeHandler(ev: CustomEvent<{ sortName?: string | number; sortOrder?: 'asc' | 'desc' }>) {\r\n    if (this.sidePagination === 'stencil') {\r\n      this.sortName = ev.detail.sortName;\r\n      this.sortOrder = ev.detail.sortOrder;\r\n    } else {\r\n      this.tableWillRender.emit({\r\n        pageNumber: this.pageNumber,\r\n        pageSize: this.pageSize,\r\n        sortName: ev.detail.sortName,\r\n        sortOrder: ev.detail.sortOrder,\r\n        searchText: this.searchText,\r\n      });\r\n    }\r\n  }\r\n\r\n  @Listen('rowWillSelect')\r\n  async rowWillSelectHandler(ev: CustomEvent<string>) {\r\n    if (this.sidePagination === 'stencil') {\r\n      if (this.selection === 'single') {\r\n        await this.unselectAll();\r\n      }\r\n      this.rowSelect.emit(ev.detail);\r\n    }\r\n  }\r\n\r\n  @Listen('rowSelect')\r\n  async rowSelectHandler(ev: CustomEvent<string>) {\r\n    const row = await this.getRowById(ev.detail);\r\n    setFieldValue(row, this.fieldSelected, true);\r\n    this._bodyRef.updateRowSelection(row);\r\n    this.rowDidSelect.emit(row);\r\n  }\r\n\r\n  @Listen('rowDidSelect')\r\n  rowDidSelectHandler(ev: CustomEvent<object>) {\r\n    this.rowSelectChange.emit(ev.detail);\r\n  }\r\n\r\n  @Listen('rowWillUnselect')\r\n  rowWillUnselectHandler(ev: CustomEvent<string>) {\r\n    if (this.sidePagination === 'stencil') {\r\n      this.rowUnselect.emit(ev.detail);\r\n    }\r\n  }\r\n\r\n  @Listen('rowUnselect')\r\n  async rowUnselectHandler(ev: CustomEvent<string>) {\r\n    const row = await this.getRowById(ev.detail);\r\n    setFieldValue(row, this.fieldSelected, false);\r\n    this._bodyRef.updateRowSelection(row);\r\n    this.rowDidSelect.emit(row);\r\n  }\r\n\r\n  @Listen('rowDidUnselect')\r\n  rowDidUnselectHandler(ev: CustomEvent<object>) {\r\n    this.rowSelectChange.emit(ev.detail);\r\n  }\r\n\r\n  @Listen('rowSelectChange')\r\n  rowSelectChangeHandler(_: CustomEvent<object>) {\r\n    this.debouncedRowSelectionUpdate();\r\n  }\r\n\r\n  @Listen('selectWillChange')\r\n  async selectWillChangeHandler(_: CustomEvent) {\r\n    if (this.sidePagination === 'stencil') {\r\n      const selected = await this.getSelected();\r\n      this.selectChange.emit(selected.length);\r\n    }\r\n  }\r\n\r\n  @Listen('selectChange')\r\n  selectChangeHandler(ev: CustomEvent<number>) {\r\n    this.totalSelected = ev.detail;\r\n    this.debouncedDisplaySelectedCount();\r\n    this.selectDidChange.emit(ev.detail);\r\n  }\r\n\r\n  @Listen('cellWillCheck')\r\n  async cellWillCheckHandler(ev: CustomEvent<{ id: string; field: string | number }>) {\r\n    if (this.sidePagination === 'stencil') {\r\n      const col = await this.getColumnByField(ev.detail.field);\r\n      if (col.type === 'radio') {\r\n        await this.uncheckAll(col.field);\r\n      }\r\n      this.cellCheck.emit(ev.detail);\r\n    }\r\n  }\r\n\r\n  @Listen('cellCheck')\r\n  async cellCheckHandler(ev: CustomEvent<{ id: string; field: string | number }>) {\r\n    const col = await this.getColumnByField(ev.detail.field);\r\n    const row = await this.getRowById(ev.detail.id);\r\n    setFieldValue(row, col.field, true);\r\n    this._bodyRef.updateRowCheckbox(row, col);\r\n    this.cellDidCheck.emit({ row: row, column: col });\r\n  }\r\n\r\n  @Listen('cellDidCheck')\r\n  cellDidCheckHandler(ev: CustomEvent<{ row: object; column: TableColumnInterface }>) {\r\n    this.cellCheckChange.emit(ev.detail);\r\n  }\r\n\r\n  @Listen('cellWillUncheck')\r\n  cellWillUncheckHandler(ev: CustomEvent<{ id: string; field: string | number }>) {\r\n    if (this.sidePagination === 'stencil') {\r\n      this.cellUncheck.emit(ev.detail);\r\n    }\r\n  }\r\n\r\n  @Listen('cellUncheck')\r\n  async cellUncheckHandler(ev: CustomEvent<{ id: string; field: string | number }>) {\r\n    const col = await this.getColumnByField(ev.detail.field);\r\n    const row = await this.getRowById(ev.detail.id);\r\n    setFieldValue(row, col.field, false);\r\n    this._bodyRef.updateRowCheckbox(row, col);\r\n    this.cellDidCheck.emit({ row: row, column: col });\r\n  }\r\n\r\n  @Listen('cellDidUncheck')\r\n  cellDidUncheckHandler(ev: CustomEvent<{ row: object; column: TableColumnInterface }>) {\r\n    this.cellCheckChange.emit(ev.detail);\r\n  }\r\n\r\n  @Listen('cellCheckChange')\r\n  cellCheckChangeHandler(ev: CustomEvent<{ row: object; column: TableColumnInterface }>) {\r\n    const col = ev.detail.column;\r\n    const rafId = this._cellCheckChangeTimeoutRafId[col.field];\r\n\r\n    if (rafId) {\r\n      clearTimeout(rafId);\r\n      delete this._cellCheckChangeTimeoutRafId[col.field];\r\n    }\r\n\r\n    this._cellCheckChangeTimeoutRafId[col.field] = setTimeout(() => {\r\n      delete this._cellCheckChangeTimeoutRafId[col.field];\r\n      this.checkWillChange.emit(col.field);\r\n    }, 100);\r\n  }\r\n\r\n  @Listen('checkWillChange')\r\n  async checkWillChangeHandler(ev: CustomEvent<string | number>) {\r\n    if (this.sidePagination === 'stencil') {\r\n      const checked = await this.getChecked(ev.detail);\r\n      this.checkChange.emit({ total: checked.length, field: ev.detail });\r\n    }\r\n  }\r\n\r\n  @Listen('checkChange')\r\n  async checkChangeHandler(ev: CustomEvent<{ total: number; field: string | number }>) {\r\n    this.setTotalChecked(ev.detail.field, ev.detail.total);\r\n    if (ev.detail.field === this.fieldSelected) {\r\n      this.totalSelected = ev.detail.total;\r\n    }\r\n    const col = await this.getColumnByField(ev.detail.field);\r\n    await this._bodyRef.updateColumnCheckbox(col);\r\n    this.checkDidChange.emit({ total: ev.detail.total, column: col });\r\n  }\r\n\r\n  @Listen('clickCell')\r\n  async clickCellHandler(ev: CustomEvent<{ id: string; field: string | number }>) {\r\n    const col = await this.getColumnByField(ev.detail.field);\r\n    if (col.type === 'checkbox' || col.type === 'radio') {\r\n      await this.checkClick(ev.detail.id, ev.detail.field);\r\n    } else {\r\n      this.clickRow.emit(ev.detail.id);\r\n    }\r\n  }\r\n\r\n  @Listen('clickRow')\r\n  async clickRowHandler(ev: CustomEvent<string>) {\r\n    if (this.clickRowTo === 'check') {\r\n      await this.checkClick(ev.detail, this.fieldSelected);\r\n    } else if (this.clickRowTo === 'select') {\r\n      const row = await this.getRowById(ev.detail);\r\n      getFieldValue(row, this.fieldSelected) ? this.unselect(ev.detail) : this.select(ev.detail);\r\n    }\r\n  }\r\n\r\n  @Method()\r\n  async moveRow(from: number, to: number) {\r\n    arrayMove(this.dataSet, from, to);\r\n    this.dataSet.forEach((row, index) => {\r\n      const rowIndex = getFieldValue(row, this.fieldIndex);\r\n      if (rowIndex !== index) {\r\n        this.rowMove.emit({\r\n          row: row,\r\n          from: rowIndex as number,\r\n          to: index,\r\n        });\r\n        setFieldValue(row, this.fieldIndex, index);\r\n      }\r\n    });\r\n    this.rerender();\r\n  }\r\n\r\n  @Method()\r\n  async dispatchCustomEvent(type: string, detail?: object): Promise<void> {\r\n    this[type].emit(detail);\r\n  }\r\n\r\n  @Method()\r\n  async dispatchCellCustomEvent(type: string, detail?: object): Promise<void> {\r\n    const cell = this.host.shadowRoot?.querySelector('tr[data-id=\"' + detail['id'] + '\"] storm-table-cell[data-field=\"' + detail['field'] + '\"]') as HTMLStormTableCellElement;\r\n    await cell.dispatchCustomEvent(type, detail);\r\n  }\r\n\r\n  @Method()\r\n  async getRowAt(index: number): Promise<object> {\r\n    return this.dataSet.find(row => getFieldValue(row, this.fieldIndex) === index);\r\n  }\r\n\r\n  @Method()\r\n  async getRowById(id: string | object): Promise<object> {\r\n    if (typeof id === 'object') return id;\r\n    return this.dataSet.find(row => getFieldValue(row, this.fieldId) === id);\r\n  }\r\n\r\n  @Method()\r\n  async getColumnByField(field: string | number | TableColumnInterface): Promise<TableColumnInterface> {\r\n    if (typeof field === 'object') return field;\r\n    return this.columns.find(col => col.field === field);\r\n  }\r\n\r\n  @Method()\r\n  async getSelected(): Promise<object[]> {\r\n    if (this.sidePagination === 'stencil') {\r\n      return this.dataSet.filter(row => getFieldValue(row, this.fieldSelected));\r\n    }\r\n    return null;\r\n  }\r\n\r\n  @Method()\r\n  async getChecked(field: string | number): Promise<object[]> {\r\n    if (this.sidePagination === 'stencil') {\r\n      const col = await this.getColumnByField(field);\r\n      return this.dataSet.filter(row => getFieldValue(row, col.field) !== null && getFieldValue(row, col.field));\r\n    }\r\n    return null;\r\n  }\r\n\r\n  @Method()\r\n  async select(id: string) {\r\n    this.rowWillSelect.emit(id);\r\n  }\r\n\r\n  @Method()\r\n  async selectAll() {\r\n    this.dataSet\r\n      .filter(row => !getFieldValue(row, this.fieldSelected))\r\n      .forEach(row => {\r\n        this.select(getFieldValue(row, this.fieldId) as string);\r\n      });\r\n  }\r\n\r\n  @Method()\r\n  async unselect(id: string) {\r\n    this.rowWillUnselect.emit(id);\r\n  }\r\n\r\n  @Method()\r\n  async unselectAll() {\r\n    this.dataSet\r\n      .filter(row => getFieldValue(row, this.fieldSelected))\r\n      .forEach(row => {\r\n        this.unselect(getFieldValue(row, this.fieldId) as string);\r\n      });\r\n  }\r\n\r\n  @Method()\r\n  async check(id: string, field: string | number) {\r\n    const row = await this.getRowById(id);\r\n    if (getFieldValue(row, field)) return;\r\n    this.cellWillCheck.emit({ id: id, field: field });\r\n  }\r\n\r\n  @Method()\r\n  async uncheck(id: string, field: string | number) {\r\n    const row = await this.getRowById(id);\r\n    if (!getFieldValue(row, field)) return;\r\n    this.cellWillUncheck.emit({ id: id, field: field });\r\n  }\r\n\r\n  @Method()\r\n  async checkAll(field: string | number) {\r\n    const col = await this.getColumnByField(field);\r\n    const rowsToCheck = this.dataSet.filter(row => !getFieldValue(row, field));\r\n\r\n    for (const row of rowsToCheck) {\r\n      const option = await this.resolveColumnData<CheckControlOptionInterface>(col, [row, getFieldValue(row, this.fieldIndex), col]);\r\n      if (option && option.disabled) continue;\r\n\r\n      this.check(getFieldValue(row, this.fieldId) as string, field);\r\n    }\r\n  }\r\n\r\n  @Method()\r\n  async uncheckAll(field: string | number) {\r\n    const col = await this.getColumnByField(field);\r\n    const rowsToUncheck = this.dataSet.filter(row => getFieldValue(row, field));\r\n\r\n    for (const row of rowsToUncheck) {\r\n      const option = await this.resolveColumnData<CheckControlOptionInterface>(col, [row, getFieldValue(row, this.fieldIndex), col]);\r\n      if (option && option.disabled) continue;\r\n\r\n      this.uncheck(getFieldValue(row, this.fieldId) as string, field);\r\n    }\r\n  }\r\n\r\n  private async resolveColumnData<T = unknown>(col: TableColumnInterface | null | undefined, args: unknown[]): Promise<T | undefined> {\r\n    const result = resolvePropertyValue(col, 'data', args);\r\n    return result instanceof Promise ? await result : result;\r\n  }\r\n\r\n  private readonly rerender = debounce(async () => {\r\n    forceUpdate(this);\r\n  }, 100);\r\n\r\n  private readonly debouncedDisplaySelectedCount = debounce(async () => {\r\n    if (!this.isSelectedInfoVisible() || !this._selectedInfoRef) return;\r\n    this._selectedInfoRef.innerHTML = this.totalSelected ? `已選取 ${this.totalSelected} 筆` : '';\r\n  }, 100);\r\n\r\n  private readonly debouncedRowSelectionUpdate = debounce(async () => {\r\n    this.selectWillChange.emit();\r\n  }, 100);\r\n\r\n  @Method()\r\n  async checkClick(id: string, field: string | number | TableColumnInterface) {\r\n    const col = await this.getColumnByField(field);\r\n    const row = await this.getRowById(id);\r\n    if (getFieldValue(row, col.field)) {\r\n      if (col.type === 'radio' && (!col.data || !(col.data as CheckControlOptionInterface).unchecked)) return;\r\n      this.uncheck(id, col.field);\r\n    } else this.check(id, col.field);\r\n  }\r\n\r\n  isPaginationVisible(): boolean {\r\n    return this.columns && this.pageInfo && this.pagination && this._pageDate && this._pageDate.length > 0;\r\n  }\r\n\r\n  isPageSizeMenuVisible(): boolean {\r\n    return this.pageSizeMenu && this.isPaginationVisible();\r\n  }\r\n\r\n  isSelectedInfoVisible(): boolean {\r\n    return this.selectedInfo && this.clickRowTo != null;\r\n  }\r\n\r\n  getTotalChecked(field: string | number): number {\r\n    if (!this.totalChecked) return 0;\r\n    return this.totalChecked[field];\r\n  }\r\n\r\n  handleSearchChanged(ev: CustomEvent<string>) {\r\n    ev.stopPropagation();\r\n    const value = ev.detail?.trim();\r\n    if (this.searchText === value) return;\r\n    this.searchChanged.emit(value);\r\n  }\r\n\r\n  handleColumnCheckChange(ev: Event, col: TableColumnInterface) {\r\n    const checked = ev.target['checked'];\r\n    if (checked) this.checkAll(col.field);\r\n    else this.uncheckAll(col.field);\r\n  }\r\n\r\n  handleColumnClick(col: TableColumnInterface) {\r\n    if (!col.sortable) return;\r\n    if (col.field == this.sortName) {\r\n      if (this.sortOrder == 'desc') this.sortChange.emit({ sortName: undefined, sortOrder: undefined });\r\n      else this.sortChange.emit({ sortName: this.sortName, sortOrder: 'desc' });\r\n    } else this.sortChange.emit({ sortName: col.field, sortOrder: 'asc' });\r\n  }\r\n\r\n  renderPagination() {\r\n    if (!this.isPaginationVisible()) return;\r\n    return (\r\n      <div class=\"table-pagination\">\r\n        <storm-pagination\r\n          page-number={this.pageNumber}\r\n          total-pages={Math.ceil(this.totalRows / this.pageSize)}\r\n          onPageChange={ev => {\r\n            this.pageNumberChange.emit(ev.detail);\r\n          }}\r\n        ></storm-pagination>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderPageSizeMenu() {\r\n    if (!this.isPageSizeMenuVisible()) return;\r\n    return (\r\n      <div class=\"table-pageSizeMenu\">\r\n        <label>\r\n          顯示{' '}\r\n          <select class=\"table-selector\" onChange={ev => this.pageSizeChange.emit(Number((ev.currentTarget as HTMLInputElement).value))}>\r\n            {this.pageList.map(page => {\r\n              return (\r\n                <option value={page} selected={this.pageSize == page}>\r\n                  {page}\r\n                </option>\r\n              );\r\n            })}\r\n          </select>{' '}\r\n          筆結果\r\n        </label>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderSearch() {\r\n    if (!this.searchable) return;\r\n    return (\r\n      <div class=\"table-search\">\r\n        <FnSearchInput placeholder=\"請輸入關鍵字\" onValueChanged={ev => this.handleSearchChanged(ev)} />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderPageInfo() {\r\n    if (!this.pageInfo) return;\r\n    return (\r\n      <div class=\"table-pageInfo\">\r\n        {this.searchable && this.searchText ? `篩選 ${this._pageDate.length} 筆，` : ''}\r\n        {this.pagination && this._pageDate.length > 0\r\n          ? `顯示第 ${(this.pageNumber - 1) * this.pageSize + 1} 至 ${this.totalRows < this.pageNumber * this.pageSize ? this.totalRows : this.pageNumber * this.pageSize} 筆，`\r\n          : ''}\r\n        共 {this.totalRows} 筆\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderSelectedInfo() {\r\n    if (!this.isSelectedInfoVisible()) return;\r\n    return <div ref={elm => (this._selectedInfoRef = elm)} class=\"table-selectedInfo\"></div>;\r\n  }\r\n\r\n  renderTableTop() {\r\n    if (!this.isPageSizeMenuVisible() && !this.searchable) return;\r\n    return (\r\n      <div class=\"table-top p-1\">\r\n        {this.renderPageSizeMenu()}\r\n        {this.renderSearch()}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderTableBottom() {\r\n    if (!this.isSelectedInfoVisible() && !this.isPaginationVisible()) return;\r\n    return (\r\n      <div class=\"table-bottom p-1\">\r\n        {this.renderPageInfo()}\r\n        {this.renderSelectedInfo()}\r\n        {this.renderPagination()}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private initDataSet(): void {\r\n    if (!this.dataSet?.length || !this.columns?.length) return;\r\n\r\n    const checkboxRadioColumns = this.columns.filter(column => column.type === 'checkbox' || column.type === 'radio');\r\n    const checkboxRadioColumnsLength = checkboxRadioColumns.length;\r\n    const dataSetLength = this.dataSet.length;\r\n    const isStencilPagination = this.sidePagination === 'stencil';\r\n    const columnCheckedCounts = new Map<string | number, number>();\r\n    checkboxRadioColumns.forEach(column => {\r\n      columnCheckedCounts.set(column.field, 0);\r\n    });\r\n\r\n    let selectedCount = 0;\r\n\r\n    this.sortData(this.dataSet);\r\n\r\n    for (let index = 0; index < dataSetLength; index++) {\r\n      const row = this.dataSet[index];\r\n      const fieldId = getFieldValue(row, this.fieldId);\r\n      const fieldIndexValue = getFieldValue(row, this.fieldIndex);\r\n      const fieldSelectedValue = getFieldValue(row, this.fieldSelected);\r\n\r\n      if (fieldId == null) {\r\n        setFieldValue(row, this.fieldId, generateUid('row'));\r\n      }\r\n      if (fieldIndexValue == null) {\r\n        setFieldValue(row, this.fieldIndex, index);\r\n      }\r\n      if (fieldSelectedValue == null) {\r\n        setFieldValue(row, this.fieldSelected, false);\r\n      }\r\n\r\n      for (let i = 0; i < checkboxRadioColumnsLength; i++) {\r\n        const column = checkboxRadioColumns[i];\r\n        const fieldValue = getFieldValue(row, column.field);\r\n\r\n        if (fieldValue == null) {\r\n          setFieldValue(row, column.field, false);\r\n        } else if (isStencilPagination && fieldValue) {\r\n          columnCheckedCounts.set(column.field, columnCheckedCounts.get(column.field)! + 1);\r\n        }\r\n      }\r\n\r\n      if (isStencilPagination && (fieldSelectedValue || getFieldValue(row, this.fieldSelected))) {\r\n        selectedCount++;\r\n      }\r\n    }\r\n\r\n    if (isStencilPagination) {\r\n      this.totalSelected = selectedCount;\r\n      this.totalRows = dataSetLength;\r\n\r\n      for (const [field, count] of columnCheckedCounts) {\r\n        this.setTotalChecked(field, count);\r\n      }\r\n    }\r\n  }\r\n\r\n  private initColumns(): void {\r\n    if (!this.columns) return;\r\n\r\n    this.columns.forEach((col, index) => {\r\n      if (col.type == null) {\r\n        col.type = 'text';\r\n      } else if (typeof col.type === 'string' && isModuleFunctionString(col.type)) {\r\n        col.type = createFunctionFromString(col.type);\r\n      }\r\n\r\n      if (col.type !== 'action') {\r\n        col.field ??= ['checkbox', 'radio'].includes(col.type as string) ? generateUid(col.type as string, index.toString()) : index;\r\n        col.searchable ??= this.searchable;\r\n      }\r\n\r\n      const classes = col.classes ?? {};\r\n      const responsiveClassPairs = Object.entries(classes).filter(\r\n        ([className, value]) => className.startsWith('d-table-') && className !== 'd-table-none' && className !== 'd-table-cell' && value === true,\r\n      );\r\n\r\n      if (responsiveClassPairs.length > 0) {\r\n        col.responsive = true;\r\n        col.rwdClassReversal = {};\r\n\r\n        const hasNone = responsiveClassPairs.some(([cls]) => cls.endsWith('-none'));\r\n        const hasCell = responsiveClassPairs.some(([cls]) => cls.endsWith('-cell'));\r\n\r\n        if (hasNone && hasCell) {\r\n          col.rwdClassReversal['d-table-none'] = classes['d-table-none'] !== true;\r\n        } else if (hasNone && !hasCell) {\r\n          col.rwdClassReversal['d-table-none'] = classes['d-table-none'] !== true;\r\n        }\r\n        for (const [className] of responsiveClassPairs) {\r\n          if (className.endsWith('-cell')) {\r\n            const noneClass = className.replace(/-cell$/, '-none');\r\n            col.rwdClassReversal[noneClass] = true;\r\n          } else if (className.endsWith('-none')) {\r\n            const cellClass = className.replace(/-none$/, '-cell');\r\n            col.rwdClassReversal[cellClass] = true;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (typeof col.data === 'string') {\r\n        if (isModuleFunctionString(col.data)) {\r\n          col.data = createFunctionFromString(col.data);\r\n        } else if (col.data.startsWith('{') && col.data.endsWith('}')) {\r\n          try {\r\n            col.data = JSON.parse(col.data) as\r\n              | ControlOptionInterface\r\n              | CheckControlOptionInterface\r\n              | DropdownTreeControlOptionInterface\r\n              | TextAreaControlOptionInterface\r\n              | CheckboxGroupControlOptionInterface;\r\n          } catch (error) {\r\n            console.warn('無法解析欄位 data JSON：', col.data);\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    if (this.columns.some(col => col.responsive === true)) {\r\n      this.isColumnResponsive = true;\r\n      this.columns.unshift({\r\n        type: 'detail',\r\n      } as TableColumnInterface);\r\n    }\r\n\r\n    this.expand.visibleColumnCount = this.columns.filter(column => column.visible !== false).length;\r\n\r\n    if (this.clickRowTo === 'check') {\r\n      const checkColumn = this.columns.find(col => col.type === 'checkbox' || col.type === 'radio');\r\n      if (checkColumn && (!this.fieldSelected || this.fieldSelected === '__selected')) {\r\n        this.fieldSelected = checkColumn.field?.toString();\r\n      }\r\n    }\r\n\r\n    if (!this.dataSet) {\r\n      this.tableWillRender.emit({\r\n        pageNumber: this.pageNumber,\r\n        pageSize: this.pageSize,\r\n        sortName: this.sortName,\r\n        sortOrder: this.sortOrder,\r\n        searchText: this.searchText,\r\n      });\r\n    } else {\r\n      this.initDataSet();\r\n    }\r\n  }\r\n\r\n  private _resizeObserver?: ResizeObserver;\r\n  private responsiveResize() {\r\n    if (this._resizeObserver) return;\r\n\r\n    this._resizeObserver = new ResizeObserver(() => {\r\n      this.refreshColumnVisibility();\r\n    });\r\n\r\n    this._resizeObserver.observe(this.host);\r\n  }\r\n\r\n  private _breakpointIndex?: number;\r\n  private readonly refreshColumnVisibility = debounce(() => {\r\n    const tableElem = this.host.shadowRoot?.querySelector('table');\r\n    if (!tableElem) return;\r\n\r\n    const tableWidth = tableElem.offsetWidth;\r\n    if (this._breakpointIndex != null) {\r\n      const currentBreakpoint = this._breakpoints[this._breakpointIndex];\r\n      const prevBreakpoint = this._breakpoints[this._breakpointIndex - 1];\r\n\r\n      if (tableWidth >= currentBreakpoint.width && (!prevBreakpoint || tableWidth < prevBreakpoint.width)) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    let newBreakpointIndex: number | undefined;\r\n    const breakpointsLength = this._breakpoints.length;\r\n    const classesToAdd: string[] = [];\r\n    const classesToRemove: string[] = [];\r\n\r\n    for (let index = 0; index < breakpointsLength; index++) {\r\n      const { size, width: bpWidth } = this._breakpoints[index];\r\n      const isLast = index === breakpointsLength - 1;\r\n      const isMatch = tableWidth >= bpWidth && (isLast || tableWidth < this._breakpoints[index + 1].width);\r\n      const className = `storm-table-${size}`;\r\n\r\n      if (isMatch) {\r\n        classesToAdd.push(className);\r\n        newBreakpointIndex = index;\r\n      } else {\r\n        classesToRemove.push(className);\r\n      }\r\n    }\r\n    classesToAdd.forEach(cls => tableElem.classList.add(cls));\r\n    classesToRemove.forEach(cls => tableElem.classList.remove(cls));\r\n\r\n    this._breakpointIndex = newBreakpointIndex;\r\n\r\n    const visibleColumns: any[] = [];\r\n    let hasResponsiveHidden = false;\r\n    const columnsLength = this.columns.length;\r\n    for (let i = 0; i < columnsLength; i++) {\r\n      const col = this.columns[i];\r\n      const isVisible = this.isColumnVisible(col);\r\n      col['__columnVisible'] = isVisible;\r\n\r\n      if (isVisible) {\r\n        visibleColumns.push(col);\r\n      } else if (col.responsive === true) {\r\n        hasResponsiveHidden = true;\r\n      }\r\n    }\r\n\r\n    const elems = this._bodyRef?.querySelectorAll('.detail-toggle, .row-detail');\r\n    const elemsArray = elems ? Array.from(elems) : [];\r\n\r\n    if (hasResponsiveHidden) {\r\n      this.expand.visibleColumnCount = visibleColumns.length;\r\n      elemsArray.forEach(elem => {\r\n        elem.classList.remove('d-table-none');\r\n      });\r\n    } else {\r\n      this.expand.visibleColumnCount = visibleColumns.filter(col => col.type !== 'detail').length;\r\n      elemsArray.forEach(elem => {\r\n        elem.classList.add('d-table-none');\r\n      });\r\n    }\r\n\r\n    const colspanValue = this.expand.visibleColumnCount.toString();\r\n    const fullCellElems = this._bodyRef?.querySelectorAll('.full-cell[colspan]');\r\n    if (fullCellElems) {\r\n      Array.from(fullCellElems).forEach(elem => {\r\n        elem.setAttribute('colspan', colspanValue);\r\n      });\r\n    }\r\n  }, 100);\r\n\r\n  private isColumnVisible(column: TableColumnInterface): boolean {\r\n    if (column.visible === false) return false;\r\n    if (!column.classes || column.responsive !== true) return true;\r\n\r\n    let isVisible = true;\r\n\r\n    if (column.classes['d-table-none'] === true) isVisible = false;\r\n    if (column.classes['d-table-cell'] === true) isVisible = true;\r\n\r\n    if (typeof this._breakpointIndex === 'number' && Array.isArray(this._breakpoints)) {\r\n      for (let i = 0; i <= this._breakpointIndex; i++) {\r\n        const size = this._breakpoints[i]?.size;\r\n        if (!size) continue;\r\n\r\n        if (column.classes[`d-table-${size}-none`] === true) isVisible = false;\r\n        if (column.classes[`d-table-${size}-cell`] === true) isVisible = true;\r\n      }\r\n    }\r\n\r\n    return isVisible;\r\n  }\r\n\r\n  setTotalChecked(field: string | number, total: number) {\r\n    this.totalChecked ??= {};\r\n    this.totalChecked[field] = total;\r\n  }\r\n\r\n  async componentWillLoad() {\r\n    await SharedStyles.applyShadowRootStylesAsync(this.host, 'material');\r\n\r\n    this.initColumns();\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    Object.values(this._cellCheckChangeTimeoutRafId).forEach(id => {\r\n      if (id) clearTimeout(id);\r\n    });\r\n    this._cellCheckChangeTimeoutRafId = {};\r\n\r\n    if (this._resizeObserver) {\r\n      this._resizeObserver.disconnect();\r\n      this._resizeObserver = undefined;\r\n    }\r\n  }\r\n\r\n  componentWillRender() {\r\n    if (!this.dataSet || !this.columns) return;\r\n\r\n    this.classes = parseClassNames(this.classes);\r\n    this._pageDate = this.dataSet;\r\n\r\n    if (this.sidePagination === 'stencil') {\r\n      if (this.searchable && this.searchText) {\r\n        const searchText = this.searchText.toLowerCase();\r\n        const searchableColumns = this.columns.filter(col => col.searchable);\r\n        const searchableColumnsLength = searchableColumns.length;\r\n        this._pageDate = this._pageDate.filter(row => {\r\n          for (let i = 0; i < searchableColumnsLength; i++) {\r\n            const col = searchableColumns![i];\r\n            const value = getFieldValue(row, col.field);\r\n            if (String(value).toLowerCase().includes(searchText)) {\r\n              return true;\r\n            }\r\n          }\r\n          return false;\r\n        });\r\n      }\r\n\r\n      this.sortData(this._pageDate);\r\n    }\r\n  }\r\n\r\n  sortData(data: any[]): void {\r\n    const sortKeys: (string | number)[] = [];\r\n    if (this.groupBy) sortKeys.push(this.groupBy);\r\n    if (this.sortName != null) sortKeys.push(this.sortName);\r\n    if (this.fieldIndex !== undefined) sortKeys.push(this.fieldIndex);\r\n\r\n    data.sort((a, b) => {\r\n      for (const key of sortKeys) {\r\n        const aValue = getFieldValue(a, key);\r\n        const bValue = getFieldValue(b, key);\r\n\r\n        if (aValue == null && bValue == null) continue;\r\n        if (aValue == null) return -1;\r\n        if (bValue == null) return 1;\r\n\r\n        const isDesc = key === this.sortName && this.sortOrder === 'desc';\r\n\r\n        if (typeof aValue === 'string' && typeof bValue === 'string') {\r\n          const result = aValue.localeCompare(bValue);\r\n          if (result !== 0) return isDesc ? -result : result;\r\n        } else if (typeof aValue === 'number' && typeof bValue === 'number') {\r\n          if (aValue !== bValue) return isDesc ? bValue - aValue : aValue - bValue;\r\n        } else {\r\n          const result = String(aValue).localeCompare(String(bValue));\r\n          if (result !== 0) return isDesc ? -result : result;\r\n        }\r\n      }\r\n      return 0;\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if (!this._pageDate) return;\r\n    let data = this._pageDate;\r\n    if (this.pagination && this.sidePagination == 'stencil') {\r\n      const from = (this.pageNumber - 1) * this.pageSize + 1;\r\n      const to = this.pageNumber * this.pageSize;\r\n      data = data.slice(from - 1, to);\r\n    }\r\n\r\n    return (\r\n      <Host>\r\n        {this.renderTableTop()}\r\n        <div class={{ 'text-sm': true, 'table-responsive': true, border: this.classes && !!this.classes['table-bordered'] }}>\r\n          <div class={{ 'table-container': true, 'fixed-table-header': !!this.tableHeight }} style={{ height: !!this.tableHeight ? this.tableHeight : 'inherit' }}>\r\n            <storm-table-body ref={elm => (this._bodyRef = elm)} table={this} dataSet={data} timeStamp={Date.now()}></storm-table-body>\r\n          </div>\r\n        </div>\r\n        {this.renderTableBottom()}\r\n      </Host>\r\n    );\r\n  }\r\n\r\n  componentDidRender() {\r\n    this.debouncedDisplaySelectedCount();\r\n    if (this.isColumnResponsive) {\r\n      this.responsiveResize();\r\n    }\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]}