{"version":3,"names":["stormPaginationCss","StormPagination","pageNumber","totalPages","paginationSuccessivelySize","paginationPagesBySide","pageChange","pageFrom","pageTo","setPage","newPageNumber","this","emit","componentWillLoad","SharedStyles","applyShadowRootStyles","host","componentWillRender","render","paginationItems","Array","max","i","push","page","title","min","h","Host","key","class","href","onClick","FnIcon","map","x","active","disabled","toString","stormTableBodyCss","StormTableBody","table","dataSet","timeStamp","clickRow","updateColumnCheckbox","col","type","checkedCount","getTotalChecked","field","stormCheckbox","querySelector","checked","totalRows","indeterminate","updateRowCheckbox","row","cell","getFieldValue","fieldId","forceUpdate","fieldSelected","updateRowSelection","el","classList","toggle","computeColumnClasses","classes","align","valign","sortable","asc","sortName","sortOrder","desc","renderThead","columns","filter","visible","renderColumn","content","onValueChanged","ev","handleColumnCheckChange","renderHeaderCell","scope","handleColumnClick","description","sortChange","undefined","detail","checkAll","uncheckAll","initSelect","forEach","async","totalChecked","computeCellClasses","renderCell","index","cellClasses","renderCellContent","column","renderRow","rowId","isSelected","visibleColumns","mainRow","isColumnResponsive","detailCol","find","detailClasses","colSpan","expand","visibleColumnCount","renderDetail","responsive","mergeClasses","rwdClassReversal","renderRows","groupBy","groupItem","result","length","groupByValue","renderBody","emptyClasses","clickRowTo","parseClassNames","componentDidRender","isCommandString","value","test","trim","parseCommandString","trimmed","commandRegex","match","exec","command","MemoryCache","store","Map","get","entry","now","Date","timestamp","expiredMillis","delete","set","clear","deleteByPrefix","prefix","keys","startsWith","cacheService","CacheService","invokeDotNetMethodAsync","methodName","args","settings","TypeError","cache","regionName","JSON","stringify","useCache","cachedValue","window","counterInterop","invokeMethodAsync","err","console","error","stormTableCellCss","StormTableCell","cellData","cellType","isDisabled","prependText","appendText","clickCell","clickAction","valueChanged","cellValueChanged","valueChangedHandler","setFieldValue","id","renderSerialNumber","pageSize","FnIconSwitch","onToggle","on","detailRow","shadowRoot","renderActionControl","onClickAction","stopPropagation","renderInputControl","onChange","target","renderTextareaControl","option","cols","rows","renderDropdownControl","item","label","nullable","searchable","selection","renderDropdownTreeControl","dataSets","isConditionGroups","conditionGroup","isConditions","conditions","evaluateConditions","loading","partialLoad","text","fieldText","dataSource","fieldLabel","fieldChildren","expandLevel","nodeSelectableRule","onTextChanged","onSearchChanged","renderCheckControl","renderCheckboxGroupControl","labelClasses","groupType","isSwitch","isInline","renderCellValue","isArray","join","escape","escapeHtml","transform","searchText","appendHighlight","template","cellTemplate","displayValue","innerHTML","replacePlaceholders","Promise","all","resolvePropertyValueAsync","targetObject","propertyName","resolvePropertyValue","parsed","uid","resolved","preventDefault"],"sources":["src/components/storm-pagination/storm-pagination.css?tag=storm-pagination&encapsulation=shadow","src/components/storm-pagination/storm-pagination.tsx","src/components/storm-table/storm-table-body/storm-table-body.scss?tag=storm-table-body","src/components/storm-table/storm-table-body/storm-table-body.tsx","src/utils/command-utils/command-utils.ts","src/utils/cache/memory-cache.ts","src/utils/dotnet-method-invoker/dotnet-method-invoker.ts","src/components/storm-table/storm-table-cell/storm-table-cell.css?tag=storm-table-cell","src/components/storm-table/storm-table-cell/storm-table-cell.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n}\r\n\r\n:host dl,\r\n:host ol,\r\n:host ul {\r\n  margin-bottom: 0;\r\n}","import { Component, Element, Event, EventEmitter, Host, Prop, h } from '@stencil/core';\r\nimport { FnIcon } from '../../utils/functional/functional';\r\nimport { SharedStyles } from '../../utils/shared-styles';\r\n\r\n@Component({\r\n  tag: 'storm-pagination',\r\n  styleUrl: 'storm-pagination.css',\r\n  shadow: true,\r\n})\r\nexport class StormPagination {\r\n  @Element() host: HTMLElement;\r\n  @Prop({ mutable: true }) pageNumber: number = 1;\r\n  @Prop() totalPages: number;\r\n  @Prop() paginationSuccessivelySize: number = 5;\r\n  @Prop() paginationPagesBySide = 1;\r\n\r\n  @Event() pageChange: EventEmitter<number>;\r\n\r\n  pageFrom: number = -1;\r\n  pageTo: number = -1;\r\n\r\n  setPage(newPageNumber: number) {\r\n    this.pageNumber = newPageNumber;\r\n    this.pageChange.emit(this.pageNumber);\r\n  }\r\n\r\n  componentWillLoad() {\r\n    SharedStyles.applyShadowRootStyles(this.host);\r\n  }\r\n\r\n  componentWillRender() {\r\n    if (this.pageNumber > this.totalPages) {\r\n      this.setPage(this.totalPages);\r\n    }\r\n    if (this.pageNumber < 1) {\r\n      this.setPage(1);\r\n    }\r\n    if (this.totalPages < this.paginationSuccessivelySize) {\r\n      this.pageFrom = 1;\r\n      this.pageTo = this.totalPages;\r\n    } else {\r\n      this.pageFrom = this.pageNumber - this.paginationPagesBySide;\r\n      this.pageTo = this.pageFrom + this.paginationPagesBySide * 2;\r\n    }\r\n\r\n    if (this.pageNumber < this.paginationSuccessivelySize - 1) {\r\n      this.pageTo = this.paginationSuccessivelySize;\r\n    }\r\n\r\n    if (this.paginationSuccessivelySize > this.totalPages - this.pageFrom) {\r\n      this.pageFrom = this.pageFrom - (this.paginationSuccessivelySize - (this.totalPages - this.pageFrom)) + 1;\r\n    }\r\n\r\n    if (this.pageFrom < 1) {\r\n      this.pageFrom = 1;\r\n    }\r\n\r\n    if (this.pageTo > this.totalPages) {\r\n      this.pageTo = this.totalPages;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    let paginationItems = new Array<IPaginationItem>();\r\n\r\n    if (this.pageFrom > 1) {\r\n      let max = this.paginationPagesBySide;\r\n      if (max >= this.pageFrom) max = this.pageFrom - 1;\r\n\r\n      for (let i = 1; i <= max; i++) {\r\n        paginationItems.push({\r\n          page: i,\r\n        });\r\n      }\r\n      if (this.pageFrom - 1 === max + 1) {\r\n        paginationItems.push({\r\n          page: this.pageFrom - 1,\r\n        });\r\n      } else {\r\n        if (this.pageFrom - 1 > max) {\r\n          paginationItems.push({\r\n            title: '...',\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    for (let i = this.pageFrom; i <= this.pageTo; i++) {\r\n      paginationItems.push({\r\n        page: i,\r\n      });\r\n    }\r\n\r\n    if (this.totalPages > this.pageTo) {\r\n      let min = this.totalPages - (this.paginationPagesBySide - 1);\r\n      if (this.pageTo >= min) min = this.pageTo + 1;\r\n\r\n      if (this.pageTo + 1 === min - 1) {\r\n        paginationItems.push({\r\n          page: this.pageTo + 1,\r\n        });\r\n      } else {\r\n        paginationItems.push({\r\n          title: '...',\r\n        });\r\n      }\r\n\r\n      for (let i = min; i <= this.totalPages; i++) {\r\n        paginationItems.push({\r\n          page: i,\r\n        });\r\n      }\r\n    }\r\n\r\n    return (\r\n      <Host>\r\n        <ul class=\"pagination pagination-primary\">\r\n          <li class=\"page-item\">\r\n            <a\r\n              class=\"page-link\"\r\n              href=\"javascript:;\"\r\n              aria-label=\"Previous\"\r\n              onClick={() => this.setPage(this.pageNumber == 1 ? (this.pageNumber = this.totalPages) : (this.pageNumber = this.pageNumber - 1))}\r\n            >\r\n              <span aria-hidden=\"true\">\r\n                <FnIcon>keyboard_arrow_left</FnIcon>\r\n              </span>\r\n            </a>\r\n          </li>\r\n          {paginationItems.map(x => {\r\n            return (\r\n              <li\r\n                class={{ 'page-item': true, active: x.page === this.pageNumber, disabled: x.page == null }}\r\n                onClick={() => {\r\n                  if (x.page) this.setPage((this.pageNumber = x.page));\r\n                }}\r\n              >\r\n                <a class=\"page-link\" href=\"javascript:;\">\r\n                  {x.title ? x.title : x.page.toString()}\r\n                </a>\r\n              </li>\r\n            );\r\n          })}\r\n          <li class=\"page-item\">\r\n            <a\r\n              class=\"page-link\"\r\n              href=\"javascript:;\"\r\n              aria-label=\"Next\"\r\n              onClick={() => this.setPage(this.pageNumber == this.totalPages ? (this.pageNumber = 1) : (this.pageNumber = this.pageNumber + 1))}\r\n            >\r\n              <span aria-hidden=\"true\">\r\n                <FnIcon>keyboard_arrow_right</FnIcon>\r\n              </span>\r\n            </a>\r\n          </li>\r\n        </ul>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n\r\nexport interface IPaginationItem {\r\n  title?: string;\r\n  page?: number;\r\n}\r\n","@use \"sass:list\";\r\n\r\n:host {\r\n  display: block;\r\n}\r\n\r\n:host .group-item {\r\n  > th {\r\n    cursor: auto;\r\n\r\n    > div {\r\n      line-height: 1;\r\n      margin: 0.25rem;\r\n    }\r\n  }\r\n}\r\n\r\n:host span.detail-title {\r\n  display: inline-block;\r\n  min-width: 75px;\r\n  font-weight: bold;\r\n}\r\n\r\n:host .d-table-none {\r\n  display: none !important;\r\n}\r\n\r\n:host .d-table-cell {\r\n  display: table-cell !important;\r\n}\r\n\r\n// 響應式類別設定\r\n$sizes: 4xs, 3xs, xxs, xs, sm, md, lg, xl, xxl, 3xl, 4xl;\r\n\r\n@each $innerSize in $sizes {\r\n  $none-selectors: ();\r\n  $cell-selectors: ();\r\n\r\n  @each $size in $sizes {\r\n    @if list.index($sizes, $size) >= list.index($sizes, $innerSize) {\r\n      $none-selectors: list.append($none-selectors, \":host .storm-table-#{$size} .d-table-#{$innerSize}-none\", comma);\r\n    }\r\n\r\n    @if list.index($sizes, $size) >= list.index($sizes, $innerSize) {\r\n      $cell-selectors: list.append($cell-selectors, \":host .storm-table-#{$size} .d-table-#{$innerSize}-cell\", comma);\r\n    }\r\n  }\r\n\r\n  #{$none-selectors} {\r\n    display: none !important;\r\n  }\r\n\r\n  #{$cell-selectors} {\r\n    display: table-cell !important;\r\n  }\r\n}\r\n","import { Component, Element, Event, EventEmitter, Host, Method, Prop, forceUpdate, h } from '@stencil/core';\r\nimport { getFieldValue, mergeClasses, parseClassNames } from '../../../utils/utils';\r\nimport type { TableColumnInterface } from '../interface';\r\nimport { StormTable } from '../storm-table';\r\n\r\n@Component({\r\n  tag: 'storm-table-body',\r\n  styleUrl: 'storm-table-body.scss',\r\n  shadow: false,\r\n})\r\nexport class StormTableBody {\r\n  @Element() host: HTMLElement;\r\n\r\n  @Prop() table: StormTable;\r\n  @Prop() dataSet: object[];\r\n  @Prop({ mutable: true }) timeStamp?: number;\r\n\r\n  @Event() clickRow: EventEmitter<string>;\r\n\r\n  @Method()\r\n  async updateColumnCheckbox(col: TableColumnInterface) {\r\n    if (!this.dataSet || col.type !== 'checkbox') return;\r\n    const checkedCount = this.getTotalChecked(col.field);\r\n    const stormCheckbox = this.host.querySelector('th[data-field=\"' + col.field + '\"] storm-checkbox') as HTMLStormCheckboxElement;\r\n\r\n    stormCheckbox.checked = checkedCount === this.table.totalRows;\r\n    stormCheckbox.indeterminate = checkedCount > 0 && checkedCount < this.table.totalRows;\r\n  }\r\n\r\n  @Method()\r\n  async updateRowCheckbox(row: object, col: TableColumnInterface) {\r\n    const cell = this.host.querySelector(\r\n      'tr[data-id=\"' + getFieldValue(row, this.table.fieldId) + '\"] storm-table-cell[data-field=\"' + col.field + '\"]',\r\n    ) as HTMLStormTableCellElement;\r\n    if (cell) {\r\n      forceUpdate(cell);\r\n    }\r\n    if (col.field === this.table.fieldSelected) {\r\n      await this.updateRowSelection(row);\r\n    }\r\n  }\r\n\r\n  @Method()\r\n  async updateRowSelection(row: object) {\r\n    const el = this.host.querySelector('tr[data-id=\"' + getFieldValue(row, this.table.fieldId) + '\"]') as HTMLInputElement;\r\n    if (el) el.classList.toggle('table-primary', getFieldValue(row, this.table.fieldSelected));\r\n  }\r\n\r\n  private computeColumnClasses(col: TableColumnInterface, classes?: Record<string, boolean>): Record<string, boolean> {\r\n    return {\r\n      'text-center': col.align === 'center',\r\n      'text-start': !col.align || col.align === 'left',\r\n      'text-end': col.align === 'right',\r\n      'align-middle': !col.valign || col.valign === 'middle',\r\n      'align-top': col.valign === 'top',\r\n      'align-bottom': col.valign === 'bottom',\r\n      'font-weight-bolder': true,\r\n      'text-truncate': true,\r\n      'table-sorter': col.sortable,\r\n      asc: this.table.sortName === col.field && this.table.sortOrder !== 'desc',\r\n      desc: this.table.sortName === col.field && this.table.sortOrder === 'desc',\r\n      ...(classes || {}),\r\n      ...(col.classes || {}),\r\n    };\r\n  }\r\n\r\n  renderThead() {\r\n    if (!this.table.columns) return;\r\n    return (\r\n      <thead>\r\n        <tr>\r\n          {this.table.columns\r\n            .filter(col => col.visible !== false)\r\n            .map(col => {\r\n              return this.renderColumn(col);\r\n            })}\r\n        </tr>\r\n      </thead>\r\n    );\r\n  }\r\n\r\n  renderColumn(col: TableColumnInterface) {\r\n    let content: any = col.title;\r\n    const classes: any = {\r\n      'thead-xxs': col.type === 'detail' || col.type === 'serialNumber' || col.type === 'radio' || col.type === 'checkbox',\r\n      'detail-toggle': col.type === 'detail',\r\n    };\r\n\r\n    if (content == null && col.type === 'checkbox') {\r\n      const checkedCount = this.getTotalChecked(col.field);\r\n      content = (\r\n        <storm-checkbox\r\n          type=\"checkbox\"\r\n          indeterminate={checkedCount > 0 && checkedCount < this.table.totalRows}\r\n          checked={checkedCount === this.table.totalRows}\r\n          onValueChanged={ev => this.handleColumnCheckChange(ev, col)}\r\n        ></storm-checkbox>\r\n      );\r\n    }\r\n\r\n    return this.renderHeaderCell(content, col, classes);\r\n  }\r\n\r\n  renderHeaderCell(content: any, col: TableColumnInterface, classes: Record<string, boolean> = {}) {\r\n    return (\r\n      <th data-field={col.field} scope=\"col\" class={this.computeColumnClasses(col, classes)} onClick={() => this.handleColumnClick(col)}>\r\n        <div class=\"cell\">{content}</div>\r\n        {col.description && <div class=\"table-description\">{col.description}</div>}\r\n      </th>\r\n    );\r\n  }\r\n\r\n  handleColumnClick(col: TableColumnInterface) {\r\n    if (!col.sortable) return;\r\n    if (col.field == this.table.sortName) {\r\n      if (this.table.sortOrder == 'desc') this.table.sortChange.emit({ sortName: undefined, sortOrder: undefined });\r\n      else this.table.sortChange.emit({ sortName: this.table.sortName, sortOrder: 'desc' });\r\n    } else this.table.sortChange.emit({ sortName: col.field, sortOrder: 'asc' });\r\n  }\r\n\r\n  async handleColumnCheckChange(ev: CustomEvent<boolean>, col: TableColumnInterface) {\r\n    const checked = ev.detail;\r\n    if (checked) await this.table.checkAll(col.field);\r\n    else await this.table.uncheckAll(col.field);\r\n  }\r\n\r\n  initSelect() {\r\n    if (!this.dataSet || !this.table.columns) return;\r\n\r\n    this.dataSet.forEach(async row => {\r\n      await this.updateRowSelection(row);\r\n    });\r\n  }\r\n\r\n  getTotalChecked(field: string | number): number {\r\n    if (!this.table.totalChecked) return 0;\r\n    return this.table.totalChecked[field];\r\n  }\r\n\r\n  private computeCellClasses(col: TableColumnInterface, classes?: Record<string, boolean>): Record<string, boolean> {\r\n    return {\r\n      'text-center': col.align === 'center',\r\n      'text-start': !col.align || col.align === 'left',\r\n      'text-end': col.align === 'right',\r\n      'align-middle': !col.valign || col.valign === 'middle',\r\n      'align-top': col.valign === 'top',\r\n      'align-bottom': col.valign === 'bottom',\r\n      ...(classes || {}),\r\n      ...(col.classes || {}),\r\n    };\r\n  }\r\n\r\n  renderCell(row: object, index: number, col: TableColumnInterface) {\r\n    const cellClasses = this.computeCellClasses(col, { 'text-xs': col.type === 'serialNumber', 'detail-toggle': col.type === 'detail' });\r\n    return (\r\n      <td data-field={col.field} class={cellClasses}>\r\n        {this.renderCellContent(row, index, col)}\r\n      </td>\r\n    );\r\n  }\r\n\r\n  renderCellContent(row: object, index: number, col: TableColumnInterface) {\r\n    return <storm-table-cell table={this.table} row={row} index={index} column={col} time-stamp={this.timeStamp} data-field={col.field}></storm-table-cell>;\r\n  }\r\n\r\n  private renderRow(row: object, index: number) {\r\n    const rowId = getFieldValue(row, this.table.fieldId);\r\n    const isSelected = getFieldValue(row, this.table.fieldSelected);\r\n    const visibleColumns = this.table.columns.filter(col => col.visible !== false);\r\n\r\n    const mainRow = (\r\n      <tr data-id={rowId} class={{ 'table-primary': isSelected }} onClick={() => this.clickRow.emit(rowId)}>\r\n        {visibleColumns.map(col => this.renderCell(row, index, col))}\r\n      </tr>\r\n    );\r\n\r\n    if (this.table.isColumnResponsive) {\r\n      const detailCol = this.table.columns.find(col => col.type === 'detail');\r\n      const detailClasses = detailCol?.classes ? { ...detailCol.classes, 'row-detail': true, 'd-none': true } : { 'row-detail': true, 'd-none': true };\r\n      \r\n      return [\r\n        mainRow,\r\n        <tr class={detailClasses} data-index={index}>\r\n          <td class=\"full-cell\" colSpan={this.table.expand.visibleColumnCount}>\r\n            <ul class=\"list-group list-group-flush\">{this.renderDetail(row, index)}</ul>\r\n          </td>\r\n        </tr>,\r\n      ];\r\n    }\r\n\r\n    return mainRow;\r\n  }\r\n\r\n  renderDetail(row: object, index: number) {\r\n    return this.table.columns\r\n      .filter(col => col.responsive === true && col.visible !== false)\r\n      .map(col => (\r\n        <li class={mergeClasses({ 'list-group-item': true }, col.rwdClassReversal)}>\r\n          <span class=\"detail-title\">{col.title}</span>\r\n          <span>{this.renderCellContent(row, index, col)}</span>\r\n        </li>\r\n      ));\r\n  }\r\n\r\n  private renderRows() {\r\n    if (this.table.groupBy) {\r\n      let groupItem: string = '';\r\n      const result: any[] = [];\r\n      \r\n      for (let i = 0; i < this.dataSet.length; i++) {\r\n        const row = this.dataSet[i];\r\n        const groupByValue = getFieldValue(row, this.table.groupBy);\r\n        \r\n        if (groupByValue !== groupItem) {\r\n          groupItem = groupByValue;\r\n          result.push(\r\n            <tr class=\"group-item table-info\">\r\n              <th class=\"align-middle full-cell\" colSpan={this.table.expand.visibleColumnCount}>\r\n                {groupByValue}\r\n              </th>\r\n            </tr>\r\n          );\r\n        }\r\n        result.push(this.renderRow(row, i));\r\n      }\r\n      return result;\r\n    }\r\n    \r\n    return this.dataSet.map((row, index) => this.renderRow(row, index));\r\n  }\r\n\r\n  private renderBody() {\r\n    if (!this.dataSet?.length) {\r\n      const emptyClasses = {\r\n        'align-middle': true,\r\n        'text-center': true,\r\n        'full-cell': true,\r\n        ...(this.table.classes?.['table-sm'] ? { 'height-100': true } : { 'height-300': true })\r\n      };\r\n      \r\n      return (\r\n        <tbody>\r\n          <tr>\r\n            <td class={emptyClasses} colSpan={this.table.expand.visibleColumnCount}>\r\n              <p class=\"p-4 h6\">沒有找到符合的結果</p>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      );\r\n    }\r\n    return <tbody>{this.renderRows()}</tbody>;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <table class={{ ...{ table: true, 'mb-0': true, 'table-hover': !!this.table.clickRowTo }, ...parseClassNames(this.table.classes) }}>\r\n          {this.renderThead()}\r\n          {this.renderBody()}\r\n        </table>\r\n      </Host>\r\n    );\r\n  }\r\n\r\n  componentDidRender() {\r\n    this.initSelect();\r\n  }\r\n}\r\n","import type { ParsedCommand } from './interface';\n\n/**\n * 判斷輸入是否為有效命令格式，例如 @Invoke:DotNet('GetUser')\n * @param value 任意輸入\n * @returns 是否符合命令格式\n */\nexport function isCommandString(value: unknown): value is string {\n    if (typeof value !== 'string') return false;\n    // 檢查型別與正則，確保格式正確\n    // 僅允許單層括號內容，且括號內可為任意字元\n    return (\n        typeof value === 'string' &&\n        /^@[a-zA-Z0-9:-]+\\('.*'\\)$/.test(value.trim())\n    );\n}\n\n/**\n * 解析命令字串，回傳 ParsedCommand 或 null\n * 格式範例：@Invoke:DotNet('GetUser')\n * @param value 命令字串\n * @returns 解析後的命令物件，若格式不符則回傳 null\n */\nexport function parseCommandString(value: string): ParsedCommand | null {\n    const trimmed = value.trim();\n    // 強化正則表達式，避免括號內為空或出現多行情況\n    const commandRegex = /^@([a-zA-Z0-9:-]+)\\('([^']*)'\\)$/;\n\n    const match = commandRegex.exec(trimmed);\n    if (!match) return null;\n\n    return {\n        command: match[1],\n        value: match[2]\n    };\n}\n\n/**\n * 檢查解析後命令是否符合指定 path\n * @param parsed 解析後的命令物件\n * @param expectedPath 預期的 path 字串，例如 \"Invoke:DotNet\"\n * @returns 是否符合預期 path\n */\nexport function isPath(parsed: ParsedCommand | null, expectedPath: string): boolean {\n    return !!parsed && parsed.command === expectedPath;\n}","import type { CacheEntry, ICacheProvider } from './interface';\n\n/**\n * 記憶體快取 (MemoryCache) 的實作，使用 Map<string, CacheEntry> 儲存所有項目\n */\nexport class MemoryCache implements ICacheProvider {\n    private readonly store: Map<string, CacheEntry> = new Map();\n\n    async get(key: string): Promise<CacheEntry | null> {\n        const entry = this.store.get(key) ?? null;\n        if (!entry) return null;\n\n        const now = Date.now();\n        // 如果已過期，就刪除並回傳 null\n        if (now - entry.timestamp >= entry.expiredMillis) {\n            this.store.delete(key);\n            return null;\n        }\n        return entry;\n    }\n\n    async set(key: string, entry: CacheEntry): Promise<void> {\n        this.store.set(key, entry);\n    }\n\n    async delete(key: string): Promise<void> {\n        this.store.delete(key);\n    }\n\n    async clear(): Promise<void> {\n        this.store.clear();\n    }\n\n    async deleteByPrefix(prefix: string): Promise<void> {\n        for (const key of this.store.keys()) {\n            if (key.startsWith(prefix)) {\n                this.store.delete(key);\n            }\n        }\n    }\n}\n","import { CacheService } from '../cache/cache-service';\nimport { MemoryCache } from '../cache/memory-cache';\n\ndeclare global {\n    interface Window {\n        counterInterop: {\n            invokeMethodAsync: (method: string, ...args: any[]) => Promise<any>;\n        };\n    }\n}\n\nconst cacheService = new CacheService(new MemoryCache());\n\n/**\n * 呼叫 .NET Interop 方法，支援快取與錯誤保護\n * @param value    字串，格式可為 \"Invoke:DotNet('methodName')\" 或僅 methodName\n * @param args     傳給 .NET 方法的參數陣列\n * @param settings 可選設定：\n *                 - cache: 是否啟用快取，預設 true\n *                 - regionName: 快取區域名稱，預設 'dotnetInterop'\n * @return Promise<any> 回傳 .NET 方法的結果\n */\nexport async function invokeDotNetMethodAsync(\n    methodName: string,\n    args: any[] = [],\n    settings: { cache?: boolean, regionName?: string } = {}\n): Promise<any> {\n    if (typeof methodName !== 'string') {\n        throw new TypeError('methodName 必須是字串');\n    }\n\n    settings = { cache: true, regionName: 'dotnetInterop', ...settings };\n\n    // 組成 key：methodName + args\n    const key = `${methodName}:${JSON.stringify(args)}`;\n    const useCache = settings.cache ?? true;\n\n    if (useCache) {\n        const cachedValue = await cacheService.get<any>(key, settings.regionName);\n        if (cachedValue !== null) {\n            return cachedValue;\n        }\n    }\n\n    try {\n        const result = await window.counterInterop?.invokeMethodAsync(\n            methodName,\n            ...args\n        );\n\n        if (useCache) {\n            await cacheService.set(key, result, settings.regionName);\n        }\n        return result;\n    } catch (err) {\n        console.error(`[Interop] 無法呼叫 '${methodName}'：`, err);\n        return 'unknown';\n    }\n}\n\n/**\n * 清除 .NET Interop 方法的快取\n * @param regionName (可選) 指定要清除的 region，預設為 'dotnetInterop'\n * @return Promise<void>\n */\nexport async function clearDotNetMethodCache(regionName: string = 'dotnetInterop'): Promise<void> {\n    await cacheService.clearRegion(regionName);\n}",":host {\r\n  display: block;\r\n}\r\n\r\n.input-group.input-group-static .form-control {\r\n  background-color: white;\r\n  line-height: 1.25rem;\r\n  padding: .25rem;\r\n}\r\n\r\n.detail-button {\r\n  cursor: pointer;\r\n}","import { Component, Element, Event, EventEmitter, h, Host, Listen, Prop, State } from '@stencil/core';\r\nimport { isCommandString, parseCommandString } from '../../../utils/command-utils/command-utils';\r\nimport { invokeDotNetMethodAsync } from '../../../utils/dotnet-method-invoker/dotnet-method-invoker';\r\nimport { FnIconSwitch } from '../../../utils/functional/functional';\r\nimport {\r\n  appendHighlight,\r\n  escapeHtml,\r\n  evaluateConditions,\r\n  getFieldValue,\r\n  isConditionGroups,\r\n  isConditions,\r\n  replacePlaceholders,\r\n  resolvePropertyValue,\r\n  setFieldValue,\r\n} from '../../../utils/utils';\r\nimport type { ICheckboxItem } from '../../storm-checkbox-group/storm-checkbox-group';\r\nimport type { CheckboxGroupInterface, TableColumnInterface } from '../interface';\r\nimport { StormTable } from '../storm-table';\r\nimport type { ClickActionDetail } from '../storm-table-toolbar/interface';\r\nimport type {\r\n  CheckboxGroupControlOptionInterface,\r\n  CheckControlOptionInterface,\r\n  DropdownControlOptionInterface,\r\n  DropdownTreeControlOptionInterface,\r\n  TextAreaControlOptionInterface,\r\n} from './interface';\r\n\r\n@Component({\r\n  tag: 'storm-table-cell',\r\n  styleUrl: 'storm-table-cell.css',\r\n  shadow: false,\r\n})\r\nexport class StormTableCell {\r\n  @State() private cellData: any;\r\n  @State() private cellType: string = 'text';\r\n  @State() private isDisabled: boolean = false;\r\n  @State() private prependText?: string;\r\n  @State() private appendText?: string;\r\n\r\n  @Element() host: HTMLElement;\r\n\r\n  @Prop() table: StormTable;\r\n  @Prop() row: object;\r\n  @Prop() index: number;\r\n  @Prop() column: TableColumnInterface;\r\n  @Prop({ mutable: true }) timeStamp?: number;\r\n\r\n  @Event() clickCell: EventEmitter<{ id: string; field: string | number }>;\r\n  @Event() clickAction: EventEmitter<ClickActionDetail>;\r\n  @Event() valueChanged: EventEmitter<any>;\r\n  @Event() cellValueChanged: EventEmitter<{ id: string; field: string | number; value: any }>;\r\n\r\n  @Listen('valueChanged')\r\n  valueChangedHandler(ev: CustomEvent<any>) {\r\n    if (this.column.field) {\r\n      setFieldValue(this.row, this.column.field, ev.detail);\r\n      this.cellValueChanged.emit({ id: getFieldValue(this.row, this.table.fieldId), field: this.column.field, value: ev.detail });\r\n    }\r\n  }\r\n\r\n  renderSerialNumber() {\r\n    return (this.table.pageNumber - 1) * this.table.pageSize + this.index + 1;\r\n  }\r\n\r\n  renderDetail() {\r\n    return (\r\n      <FnIconSwitch\r\n        onToggle={on => {\r\n          const detailRow = this.table.host.shadowRoot.querySelector('.row-detail[data-index=\"' + this.index + '\"]');\r\n          if (detailRow) {\r\n            detailRow.classList.toggle('d-none', !on);\r\n          }\r\n        }}\r\n      />\r\n    );\r\n  }\r\n\r\n  renderActionControl() {\r\n    return (\r\n      <storm-table-toolbar\r\n        table={this.table}\r\n        column={this.column}\r\n        row={this.row}\r\n        timeStamp={this.timeStamp}\r\n        onClickAction={ev => {\r\n          ev.stopPropagation();\r\n          this.clickAction.emit(ev.detail);\r\n        }}\r\n      ></storm-table-toolbar>\r\n    );\r\n  }\r\n\r\n  renderInputControl() {\r\n    return (\r\n      <div class=\"input-group input-group-static\">\r\n        <input\r\n          class=\"form-control\"\r\n          type=\"text\"\r\n          aria-label={this.column.title}\r\n          disabled={this.isDisabled}\r\n          value={getFieldValue(this.row, this.column.field)}\r\n          onClick={ev => ev.stopPropagation()}\r\n          onChange={ev => {\r\n            ev.stopPropagation();\r\n            this.valueChanged.emit((ev.target as HTMLInputElement).value);\r\n          }}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderTextareaControl() {\r\n    const option = this.cellData as TextAreaControlOptionInterface;\r\n    return (\r\n      <div class=\"input-group input-group-static\">\r\n        <textarea\r\n          class=\"form-control\"\r\n          disabled={this.isDisabled}\r\n          cols={option.cols}\r\n          rows={option.rows}\r\n          title={this.column.title}\r\n          value={getFieldValue(this.row, this.column.field)}\r\n          onClick={ev => ev.stopPropagation()}\r\n          onChange={ev => {\r\n            ev.stopPropagation();\r\n            this.valueChanged.emit((ev.target as HTMLInputElement).value);\r\n          }}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderDropdownControl() {\r\n    const option = this.cellData as DropdownControlOptionInterface;\r\n    const dataSet = option.dataSet.map(item => ({\r\n      ...item,\r\n    }));\r\n    return (\r\n      <storm-dropdown\r\n        disabled={this.isDisabled}\r\n        label={option.label}\r\n        value={getFieldValue(this.row, this.column.field)}\r\n        dataSet={dataSet}\r\n        nullable={option.nullable ?? false}\r\n        searchable={option.searchable ?? true}\r\n        selection={'single'}\r\n        timeStamp={this.timeStamp}\r\n        type={'select'}\r\n        onValueChanged={ev => {\r\n          ev.stopPropagation();\r\n          this.valueChanged.emit(ev.detail);\r\n        }}\r\n      ></storm-dropdown>\r\n    );\r\n  }\r\n\r\n  renderDropdownTreeControl() {\r\n    const option = this.cellData as DropdownTreeControlOptionInterface;\r\n    let dataSet = option.dataSet;\r\n    if (option.dataSets != null && isConditionGroups(option.dataSets)) {\r\n      for (const conditionGroup of option.dataSets) {\r\n        if (isConditions(conditionGroup.conditions) && evaluateConditions(conditionGroup.conditions, this.row)) {\r\n          dataSet = conditionGroup.value;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    return (\r\n      <storm-dropdown-tree\r\n        disabled={this.isDisabled}\r\n        loading={option.loading}\r\n        partialLoad={option.partialLoad}\r\n        label={option.label}\r\n        value={getFieldValue(this.row, this.column.field)}\r\n        text={option.fieldText ? getFieldValue(this.row, option.fieldText) : null}\r\n        dataSet={dataSet}\r\n        dataSource={option.dataSource}\r\n        fieldId={option.fieldId ?? 'id'}\r\n        fieldLabel={option.fieldLabel ?? 'label'}\r\n        fieldChildren={option.fieldChildren ?? 'children'}\r\n        expandLevel={option.expandLevel ?? 2}\r\n        nodeSelectableRule={option.nodeSelectableRule}\r\n        nullable={option.nullable ?? false}\r\n        searchable={option.searchable ?? true}\r\n        selection={'single'}\r\n        timeStamp={this.timeStamp}\r\n        onValueChanged={ev => {\r\n          ev.stopPropagation();\r\n          this.valueChanged.emit(ev.detail);\r\n        }}\r\n        onTextChanged={ev => {\r\n          ev.stopPropagation();\r\n          if (option.fieldText) setFieldValue(this.row, option.fieldText, ev.detail);\r\n        }}\r\n        onSearchChanged={ev => {\r\n          ev.stopPropagation();\r\n        }}\r\n      ></storm-dropdown-tree>\r\n    );\r\n  }\r\n\r\n  renderCheckControl() {\r\n    return (\r\n      <storm-checkbox type={this.cellType === 'checkbox' ? 'checkbox' : 'radio'} disabled={this.isDisabled} checked={getFieldValue(this.row, this.column.field)}></storm-checkbox>\r\n    );\r\n  }\r\n\r\n  renderCheckboxGroupControl() {\r\n    const option = this.cellData as CheckboxGroupControlOptionInterface;\r\n    const value = getFieldValue(this.row, this.column.field);\r\n    const dataSet = (option.dataSet as CheckboxGroupInterface[])\r\n      .filter(x => x.visible === undefined || (typeof x.visible === 'function' && x.visible(this.row)) || (typeof x.visible === 'boolean' && x.visible))\r\n      .map(x => {\r\n        return {\r\n          id: x.id,\r\n          label: x.label,\r\n          labelClasses: x.labelClasses,\r\n          checked: x.checked,\r\n          disabled: x.disabled,\r\n        } as ICheckboxItem;\r\n      });\r\n    return (\r\n      <div class=\"input-group input-group-static\">\r\n        <storm-checkbox-group\r\n          disabled={this.isDisabled}\r\n          type={option.groupType}\r\n          value={value}\r\n          dataSet={dataSet}\r\n          isSwitch={option.isSwitch ?? false}\r\n          isInline={option.isInline ?? true}\r\n          onValueChanged={ev => {\r\n            ev.stopPropagation();\r\n            this.valueChanged.emit(ev.detail);\r\n          }}\r\n        ></storm-checkbox-group>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderCellContent() {\r\n    switch (this.cellType) {\r\n      case 'action':\r\n        return this.renderActionControl();\r\n      case 'input':\r\n        return this.renderInputControl();\r\n      case 'checkbox':\r\n      case 'radio':\r\n        return this.renderCheckControl();\r\n      case 'textarea':\r\n        return this.renderTextareaControl();\r\n      case 'dropdown':\r\n        return this.renderDropdownControl();\r\n      case 'dropdownTree':\r\n        return this.renderDropdownTreeControl();\r\n      case 'checkboxGroup':\r\n        return this.renderCheckboxGroupControl();\r\n      case 'serialNumber':\r\n        return this.renderSerialNumber();\r\n      case 'detail':\r\n        return this.renderDetail();\r\n      case 'text':\r\n        return this.renderCellValue();\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n\r\n  renderCell() {\r\n    if (!this.prependText && !this.appendText) {\r\n      return this.renderCellContent();\r\n    } else {\r\n      return (\r\n        <div class=\"d-flex flex-row gap-1 align-items-center\">\r\n          {this.prependText && <span>{this.prependText}</span>}\r\n          {this.renderCellContent()}\r\n          {this.appendText && <span>{this.appendText}</span>}\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  renderCellValue() {\r\n    let content = getFieldValue(this.row, this.column.field);\r\n\r\n    if (typeof this.column.render === 'function') {\r\n      content = this.column.render(content, this.row, this.index);\r\n    } else {\r\n      if (Array.isArray(content)) {\r\n        content = content.filter(item => item != null && item !== '').join('、');\r\n      }\r\n\r\n      if (this.table.escape && typeof content !== 'boolean' && content != null) {\r\n        content = escapeHtml(content);\r\n      }\r\n\r\n      if (content != null && this.column.transform && this.column.transform[content.toString()]) {\r\n        content = this.column.transform[content];\r\n      } else if (content && this.table.searchable && this.table.searchText) {\r\n        content = appendHighlight(content, this.table.searchText);\r\n      }\r\n    }\r\n\r\n    const template = this.column.cellTemplate || this.table.cellTemplate;\r\n    const displayValue = content != null && content.toString().trim().length > 0 ? content : '-';\r\n    return (\r\n      <span\r\n        innerHTML={replacePlaceholders(template, {\r\n          value: displayValue,\r\n          row: this.row,\r\n          index: this.index,\r\n        })}\r\n      ></span>\r\n    );\r\n  }\r\n\r\n  async componentWillRender() {\r\n    if (!this.column) {\r\n      this.cellType = 'text';\r\n      this.cellData = undefined;\r\n      this.isDisabled = false;\r\n      return;\r\n    }\r\n\r\n    const [cellType, cellData] = await Promise.all([this.resolvePropertyValueAsync<string>(this.column, 'type'), this.resolvePropertyValueAsync(this.column, 'data')]);\r\n    this.cellType = cellType;\r\n    this.cellData = cellData;\r\n\r\n    if (cellData && typeof cellData === 'object' && !Array.isArray(cellData)) {\r\n      this.isDisabled = (await this.resolvePropertyValueAsync<boolean>(cellData, 'disabled')) ?? false;\r\n      this.prependText = await this.resolvePropertyValueAsync<string>(cellData, 'prependText');\r\n      this.appendText = await this.resolvePropertyValueAsync<string>(cellData, 'appendText');\r\n      if (this.isDisabled && (cellType === 'input' || cellType === 'textarea')) {\r\n        this.cellType = 'text';\r\n      }\r\n    } else {\r\n      this.isDisabled = false;\r\n    }\r\n  }\r\n\r\n  private async resolvePropertyValueAsync<T>(targetObject: any, propertyName: string): Promise<T> {\r\n    const result = resolvePropertyValue(targetObject, propertyName, [this.row, this.index, this.column]);\r\n    if (isCommandString(result)) {\r\n      const parsed = parseCommandString(result);\r\n      if (parsed.command === 'Invoke:DotNet') {\r\n        const rowId = getFieldValue(this.row, this.table?.fieldId);\r\n        try {\r\n          return await invokeDotNetMethodAsync(parsed.value, [rowId, this.index, this.column.field], { cache: true, regionName: this.table.uid });\r\n        } catch (error) {\r\n          console.error('InvokeDotNetMethod 執行失敗', error);\r\n          throw error;\r\n        }\r\n      }\r\n      if (parsed.command === 'Get:Field') {\r\n        return getFieldValue(this.row, parsed.value);\r\n      }\r\n    }\r\n\r\n    if (isConditions(result)) {\r\n      return evaluateConditions(result, this.row) as T;\r\n    }\r\n\r\n    if (isConditionGroups(result)) {\r\n      for (const conditionGroup of result) {\r\n        if (isConditions(conditionGroup.conditions) && evaluateConditions(conditionGroup.conditions, this.row)) {\r\n          return conditionGroup.value as T;\r\n        }\r\n      }\r\n      return undefined;\r\n    }\r\n\r\n    if (result instanceof Promise) {\r\n      try {\r\n        const resolved = await result;\r\n        return resolved;\r\n      } catch (error) {\r\n        console.error('屬性 Promise 解析失敗', error);\r\n        throw error;\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host\r\n        onClick={ev => {\r\n          if (this.cellType === 'checkbox' || this.cellType === 'radio') {\r\n            const option = this.cellData as CheckControlOptionInterface;\r\n            if (option && option.disabled) {\r\n              ev.stopPropagation();\r\n              ev.preventDefault();\r\n              return;\r\n            }\r\n          }\r\n          this.clickCell.emit({ id: getFieldValue(this.row, this.table.fieldId), field: this.column.field });\r\n        }}\r\n      >\r\n        {this.renderCell()}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]}