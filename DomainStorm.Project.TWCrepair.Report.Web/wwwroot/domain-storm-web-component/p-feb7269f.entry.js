import{r as t,c as e,a as s,h as l,H as a,f as i}from"./p-D7_hI2Rs.js";import{F as o,c as n}from"./p-Stldlc6K.js";import{S as r}from"./p-B0cWbvbo.js";import{b as h,p as d,s as c,d as b,l as m,n as x,o as u,q as p,h as f,t as g,r as y}from"./p-k7ub6n8r.js";import{C}from"./p-pMD06zDP.js";import"./p-BOWIeDdp.js";const k=":host{display:block}:host dl,:host ol,:host ul{margin-bottom:0}";const w=class{constructor(s){t(this,s);this.pageChange=e(this,"pageChange")}get host(){return s(this)}pageNumber=1;totalPages;paginationSuccessivelySize=5;paginationPagesBySide=1;pageChange;pageFrom=-1;pageTo=-1;cachedPaginationItems=null;lastCalculationKey="";setPage(t){if(t<1||t>this.totalPages||t===this.pageNumber){return}this.pageNumber=t;this.cachedPaginationItems=null;this.lastCalculationKey="";this.pageChange.emit(this.pageNumber)}async componentWillLoad(){await r.applyShadowRootStylesAsync(this.host,"material")}disconnectedCallback(){this.cachedPaginationItems=null;this.lastCalculationKey=""}calculatePageRange(){if(this.totalPages<=0){this.pageFrom=1;this.pageTo=0;return}if(this.pageNumber>this.totalPages){this.pageNumber=this.totalPages}if(this.pageNumber<1){this.pageNumber=1}if(this.totalPages<=this.paginationSuccessivelySize){this.pageFrom=1;this.pageTo=this.totalPages;return}const t=Math.floor(this.paginationSuccessivelySize/2);this.pageFrom=Math.max(1,this.pageNumber-t);this.pageTo=Math.min(this.totalPages,this.pageFrom+this.paginationSuccessivelySize-1);if(this.pageTo-this.pageFrom+1<this.paginationSuccessivelySize){this.pageFrom=Math.max(1,this.pageTo-this.paginationSuccessivelySize+1)}}componentWillRender(){this.calculatePageRange()}getPaginationItems(){const t=`${this.pageNumber}-${this.totalPages}-${this.paginationSuccessivelySize}-${this.paginationPagesBySide}`;if(this.lastCalculationKey===t&&this.cachedPaginationItems){return this.cachedPaginationItems}const e=[];if(this.pageFrom>1){let t=this.paginationPagesBySide;if(t>=this.pageFrom)t=this.pageFrom-1;for(let s=1;s<=t;s++){e.push({page:s})}if(this.pageFrom-1===t+1){e.push({page:this.pageFrom-1})}else if(this.pageFrom-1>t){e.push({title:"..."})}}for(let t=this.pageFrom;t<=this.pageTo;t++){e.push({page:t})}if(this.totalPages>this.pageTo){let t=this.totalPages-(this.paginationPagesBySide-1);if(this.pageTo>=t)t=this.pageTo+1;if(this.pageTo+1===t-1){e.push({page:this.pageTo+1})}else{e.push({title:"..."})}for(let s=t;s<=this.totalPages;s++){e.push({page:s})}}this.cachedPaginationItems=e;this.lastCalculationKey=t;return e}render(){const t=this.getPaginationItems();return l(a,{key:"d4026dc9a5ddbfd2b8b3564eb5ba22da67045321"},l("ul",{key:"3a614e0464851f0a2d39c58c20259d57135b2690",class:"pagination pagination-primary"},l("li",{key:"19efd76f632376fb8a2bb4e4b35e204678e7a894",class:"page-item"},l("a",{key:"696b30519b7bff7bc2b2b5b909ab395b13db459c",class:"page-link",href:"javascript:;","aria-label":"上一頁",onClick:()=>{const t=this.pageNumber===1?this.totalPages:this.pageNumber-1;this.setPage(t)}},l("span",{key:"791858aa1c4b3f8206f4dfaba90672b60c5f6c63","aria-hidden":"true"},l(o,{key:"a963724b859820313802a6fa9823928deaa2d563"},"keyboard_arrow_left")))),t.map(((t,e)=>{const s=t.page===this.pageNumber;const a=t.page==null;return l("li",{key:t.page?`page-${t.page}`:`ellipsis-${e}`,class:{"page-item":true,active:s,disabled:a},onClick:()=>{if(t.page&&!s)this.setPage(t.page)}},l("a",{class:"page-link",href:"javascript:;","aria-current":s?"page":undefined,"aria-label":t.page?`第 ${t.page} 頁`:undefined},t.title||t.page?.toString()))})),l("li",{key:"bd65dd4ca4edf71ce2b6630106d7cfe1c6bcbd71",class:"page-item"},l("a",{key:"55317727cfdb7c94a2746d7dbdf0210ec43c78e8",class:"page-link",href:"javascript:;","aria-label":"下一頁",onClick:()=>{const t=this.pageNumber===this.totalPages?1:this.pageNumber+1;this.setPage(t)}},l("span",{key:"03688a658056d053e981c16bf7720afa79e2d8f5","aria-hidden":"true"},l(o,{key:"d4b14286cef302d4f3e468788551fbd2f1cc1f09"},"keyboard_arrow_right"))))))}};w.style=k;const v=":host{display:block}:host .group-item>th{cursor:auto}:host .group-item>th>div{line-height:1;margin:0.25rem}:host span.detail-title{display:inline-block;min-width:75px;font-weight:bold}:host .d-table-none{display:none !important}:host .d-table-cell{display:table-cell !important}:host .storm-table-4xs .d-table-4xs-none,:host .storm-table-3xs .d-table-4xs-none,:host .storm-table-xxs .d-table-4xs-none,:host .storm-table-xs .d-table-4xs-none,:host .storm-table-sm .d-table-4xs-none,:host .storm-table-md .d-table-4xs-none,:host .storm-table-lg .d-table-4xs-none,:host .storm-table-xl .d-table-4xs-none,:host .storm-table-xxl .d-table-4xs-none,:host .storm-table-3xl .d-table-4xs-none,:host .storm-table-4xl .d-table-4xs-none{display:none !important}:host .storm-table-4xs .d-table-4xs-cell,:host .storm-table-3xs .d-table-4xs-cell,:host .storm-table-xxs .d-table-4xs-cell,:host .storm-table-xs .d-table-4xs-cell,:host .storm-table-sm .d-table-4xs-cell,:host .storm-table-md .d-table-4xs-cell,:host .storm-table-lg .d-table-4xs-cell,:host .storm-table-xl .d-table-4xs-cell,:host .storm-table-xxl .d-table-4xs-cell,:host .storm-table-3xl .d-table-4xs-cell,:host .storm-table-4xl .d-table-4xs-cell{display:table-cell !important}:host .storm-table-3xs .d-table-3xs-none,:host .storm-table-xxs .d-table-3xs-none,:host .storm-table-xs .d-table-3xs-none,:host .storm-table-sm .d-table-3xs-none,:host .storm-table-md .d-table-3xs-none,:host .storm-table-lg .d-table-3xs-none,:host .storm-table-xl .d-table-3xs-none,:host .storm-table-xxl .d-table-3xs-none,:host .storm-table-3xl .d-table-3xs-none,:host .storm-table-4xl .d-table-3xs-none{display:none !important}:host .storm-table-3xs .d-table-3xs-cell,:host .storm-table-xxs .d-table-3xs-cell,:host .storm-table-xs .d-table-3xs-cell,:host .storm-table-sm .d-table-3xs-cell,:host .storm-table-md .d-table-3xs-cell,:host .storm-table-lg .d-table-3xs-cell,:host .storm-table-xl .d-table-3xs-cell,:host .storm-table-xxl .d-table-3xs-cell,:host .storm-table-3xl .d-table-3xs-cell,:host .storm-table-4xl .d-table-3xs-cell{display:table-cell !important}:host .storm-table-xxs .d-table-xxs-none,:host .storm-table-xs .d-table-xxs-none,:host .storm-table-sm .d-table-xxs-none,:host .storm-table-md .d-table-xxs-none,:host .storm-table-lg .d-table-xxs-none,:host .storm-table-xl .d-table-xxs-none,:host .storm-table-xxl .d-table-xxs-none,:host .storm-table-3xl .d-table-xxs-none,:host .storm-table-4xl .d-table-xxs-none{display:none !important}:host .storm-table-xxs .d-table-xxs-cell,:host .storm-table-xs .d-table-xxs-cell,:host .storm-table-sm .d-table-xxs-cell,:host .storm-table-md .d-table-xxs-cell,:host .storm-table-lg .d-table-xxs-cell,:host .storm-table-xl .d-table-xxs-cell,:host .storm-table-xxl .d-table-xxs-cell,:host .storm-table-3xl .d-table-xxs-cell,:host .storm-table-4xl .d-table-xxs-cell{display:table-cell !important}:host .storm-table-xs .d-table-xs-none,:host .storm-table-sm .d-table-xs-none,:host .storm-table-md .d-table-xs-none,:host .storm-table-lg .d-table-xs-none,:host .storm-table-xl .d-table-xs-none,:host .storm-table-xxl .d-table-xs-none,:host .storm-table-3xl .d-table-xs-none,:host .storm-table-4xl .d-table-xs-none{display:none !important}:host .storm-table-xs .d-table-xs-cell,:host .storm-table-sm .d-table-xs-cell,:host .storm-table-md .d-table-xs-cell,:host .storm-table-lg .d-table-xs-cell,:host .storm-table-xl .d-table-xs-cell,:host .storm-table-xxl .d-table-xs-cell,:host .storm-table-3xl .d-table-xs-cell,:host .storm-table-4xl .d-table-xs-cell{display:table-cell !important}:host .storm-table-sm .d-table-sm-none,:host .storm-table-md .d-table-sm-none,:host .storm-table-lg .d-table-sm-none,:host .storm-table-xl .d-table-sm-none,:host .storm-table-xxl .d-table-sm-none,:host .storm-table-3xl .d-table-sm-none,:host .storm-table-4xl .d-table-sm-none{display:none !important}:host .storm-table-sm .d-table-sm-cell,:host .storm-table-md .d-table-sm-cell,:host .storm-table-lg .d-table-sm-cell,:host .storm-table-xl .d-table-sm-cell,:host .storm-table-xxl .d-table-sm-cell,:host .storm-table-3xl .d-table-sm-cell,:host .storm-table-4xl .d-table-sm-cell{display:table-cell !important}:host .storm-table-md .d-table-md-none,:host .storm-table-lg .d-table-md-none,:host .storm-table-xl .d-table-md-none,:host .storm-table-xxl .d-table-md-none,:host .storm-table-3xl .d-table-md-none,:host .storm-table-4xl .d-table-md-none{display:none !important}:host .storm-table-md .d-table-md-cell,:host .storm-table-lg .d-table-md-cell,:host .storm-table-xl .d-table-md-cell,:host .storm-table-xxl .d-table-md-cell,:host .storm-table-3xl .d-table-md-cell,:host .storm-table-4xl .d-table-md-cell{display:table-cell !important}:host .storm-table-lg .d-table-lg-none,:host .storm-table-xl .d-table-lg-none,:host .storm-table-xxl .d-table-lg-none,:host .storm-table-3xl .d-table-lg-none,:host .storm-table-4xl .d-table-lg-none{display:none !important}:host .storm-table-lg .d-table-lg-cell,:host .storm-table-xl .d-table-lg-cell,:host .storm-table-xxl .d-table-lg-cell,:host .storm-table-3xl .d-table-lg-cell,:host .storm-table-4xl .d-table-lg-cell{display:table-cell !important}:host .storm-table-xl .d-table-xl-none,:host .storm-table-xxl .d-table-xl-none,:host .storm-table-3xl .d-table-xl-none,:host .storm-table-4xl .d-table-xl-none{display:none !important}:host .storm-table-xl .d-table-xl-cell,:host .storm-table-xxl .d-table-xl-cell,:host .storm-table-3xl .d-table-xl-cell,:host .storm-table-4xl .d-table-xl-cell{display:table-cell !important}:host .storm-table-xxl .d-table-xxl-none,:host .storm-table-3xl .d-table-xxl-none,:host .storm-table-4xl .d-table-xxl-none{display:none !important}:host .storm-table-xxl .d-table-xxl-cell,:host .storm-table-3xl .d-table-xxl-cell,:host .storm-table-4xl .d-table-xxl-cell{display:table-cell !important}:host .storm-table-3xl .d-table-3xl-none,:host .storm-table-4xl .d-table-3xl-none{display:none !important}:host .storm-table-3xl .d-table-3xl-cell,:host .storm-table-4xl .d-table-3xl-cell{display:table-cell !important}:host .storm-table-4xl .d-table-4xl-none{display:none !important}:host .storm-table-4xl .d-table-4xl-cell{display:table-cell !important}";const S=class{constructor(s){t(this,s);this.clickRow=e(this,"clickRow")}get host(){return s(this)}table;dataSet;timeStamp;clickRow;async updateColumnCheckbox(t){if(!this.dataSet||t.type!=="checkbox")return;const e=this.getCheckedItemsSum(t.field);const s=this.host.querySelector('th[data-field="'+t.field+'"] storm-checkbox');s.isChecked=e===this.table.totalRows;s.isIndeterminate=e>0&&e<this.table.totalRows}async updateRowCheckbox(t,e){const s=this.host.querySelector('tr[data-id="'+h(t,this.table.fieldId)+'"] storm-table-cell[data-field="'+e.field+'"]');if(s){i(s)}if(e.field===this.table.fieldSelected){await this.updateRowSelection(t)}}async updateRowSelection(t){const e=this.host.querySelector('tr[data-id="'+h(t,this.table.fieldId)+'"]');if(e)e.classList.toggle("table-primary",h(t,this.table.fieldSelected)===true)}computeColumnClasses(t,e){return{"text-center":t.align==="center","text-start":!t.align||t.align==="left","text-end":t.align==="right","align-middle":!t.valign||t.valign==="middle","align-top":t.valign==="top","align-bottom":t.valign==="bottom","font-weight-bolder":true,"text-truncate":true,"table-sorter":t.sortable,asc:this.table.sortName===t.field&&this.table.sortOrder!=="desc",desc:this.table.sortName===t.field&&this.table.sortOrder==="desc",...e,...t.classes}}renderThead(){if(!this.table.columns)return;return l("thead",null,l("tr",null,this.table.columns.filter((t=>t.visible!==false)).map((t=>this.renderTheadColumn(t)))))}renderTheadColumn(t){let e=t.title;const s={"thead-xxs":t.type==="detail"||t.type==="serialNumber"||t.type==="radio"||t.type==="checkbox","detail-toggle":t.type==="detail"};if(e==null&&t.type==="checkbox"){const s=this.getCheckedItemsSum(t.field);e=l("storm-checkbox",{type:"checkbox","is-indeterminate":s>0&&s<this.table.totalRows,"is-checked":s===this.table.totalRows,onValueChanged:e=>this.handleColumnCheckChange(e,t),"time-stamp":this.timeStamp})}return this.renderHeaderCell(e,t,s)}renderHeaderCell(t,e,s={}){return l("th",{"data-field":e.field,scope:"col",class:this.computeColumnClasses(e,s),onClick:()=>this.handleColumnClick(e)},l("div",{class:"cell"},t),e.description&&l("div",{class:"table-description"},e.description))}handleColumnClick(t){if(!t.sortable)return;if(t.field==this.table.sortName){if(this.table.sortOrder=="desc")this.table.sortChange.emit({sortName:undefined,sortOrder:undefined});else this.table.sortChange.emit({sortName:this.table.sortName,sortOrder:"desc"})}else this.table.sortChange.emit({sortName:t.field,sortOrder:"asc"})}async handleColumnCheckChange(t,e){const s=t.detail;if(s)await this.table.checkAll(e.field);else await this.table.uncheckAll(e.field)}async initSelect(){if(!this.dataSet||!this.table.columns)return;for(const t of this.dataSet){await this.updateRowSelection(t)}}getCheckedItemsSum(t){if(!this.table.checkedItemsSum)return 0;return this.table.checkedItemsSum[t]}computeCellClasses(t,e){return{"text-center":t.align==="center","text-start":!t.align||t.align==="left","text-end":t.align==="right","align-middle":!t.valign||t.valign==="middle","align-top":t.valign==="top","align-bottom":t.valign==="bottom",...e,...t.classes}}renderCell(t,e,s){const a=this.computeCellClasses(s,{"text-xs":s.type==="serialNumber","detail-toggle":s.type==="detail"});return l("td",{"data-field":s.field,class:a},this.renderCellContent(t,e,s))}renderCellContent(t,e,s){return l("storm-table-cell",{table:this.table,row:t,index:e,column:s,"time-stamp":this.timeStamp,"data-field":s.field})}renderRow(t,e){const s=h(t,this.table.fieldId);const a=h(t,this.table.fieldSelected)===true;const i=this.table.columns.filter((t=>t.visible!==false));const o=l("tr",{"data-id":s,class:{"table-primary":a},onClick:()=>this.clickRow.emit(s)},i.map((s=>this.renderCell(t,e,s))));if(this.table.isColumnResponsive){const s=this.table.columns.find((t=>t.type==="detail"));const a=s?.classes?{...s.classes,"row-detail":true,"d-none":true}:{"row-detail":true,"d-none":true};return[o,l("tr",{class:a,"data-index":e},l("td",{class:"full-cell",colSpan:this.table.expand.visibleColumnCount},l("ul",{class:"list-group list-group-flush"},this.renderDetail(t,e))))]}return o}renderDetail(t,e){return this.table.columns.filter((t=>t.responsive===true&&t.visible!==false)).map((s=>l("li",{class:{"list-group-item":true,...s.rwdClassReversal}},l("span",{class:"detail-title"},s.title),l("span",null,this.renderCellContent(t,e,s)))))}renderRows(){if(this.table.groupBy){let t="";const e=[];for(const[s,a]of this.dataSet.entries()){const i=h(a,this.table.groupBy);if(i!==t){t=i;e.push(l("tr",{class:"group-item table-info"},l("th",{class:"align-middle full-cell",colSpan:this.table.expand.visibleColumnCount},i)))}e.push(this.renderRow(a,s))}return e}return this.dataSet.map(((t,e)=>this.renderRow(t,e)))}renderBody(){if(!this.dataSet?.length){const t={"align-middle":true,"text-center":true,"full-cell":true,...this.table.classes?.["table-sm"]?{"height-100":true}:{"height-300":true}};return l("tbody",null,l("tr",null,l("td",{class:t,colSpan:this.table.expand.visibleColumnCount},l("p",{class:"p-4 h6"},"沒有找到符合的結果"))))}return l("tbody",null,this.renderRows())}render(){return l(a,{key:"d7002e55e0b37736d336b9bee78c945ec777cce2"},l("table",{key:"ee157435de9195768727d1650392722ef0cca078",class:{table:true,"mb-0":true,"table-hover":!!this.table.clickRowTo,"table-layout-auto":this.table.layout==="auto","table-layout-fixed":this.table.layout==="fixed",...d(this.table.classes)}},this.renderThead(),this.renderBody()))}async componentDidRender(){await this.initSelect()}};S.style=v;function V(t){if(typeof t!=="string")return false;return typeof t==="string"&&/^@[a-zA-Z0-9:-]+\('.*'\)$/.test(t.trim())}function D(t){const e=t.trim();const s=/^@([a-zA-Z0-9:-]+)\('([^']*)'\)$/;const l=s.exec(e);if(!l)return null;return{command:l[1],value:l[2]}}class T{store=new Map;maxEntries;constructor(t=1e3){this.maxEntries=t}async get(t){return this.store.get(t)||null}async set(t,e){if(!this.store.has(t)&&this.store.size>=this.maxEntries){this.evictOldestEntry()}this.store.set(t,e)}evictOldestEntry(){const t=this.store.keys();const e=t.next().value;if(e!==undefined){this.store.delete(e)}}async delete(t){this.store.delete(t)}async clear(){this.store.clear()}get defaultKeyPrefix(){return"mem"}async size(){return this.store.size}setMaxEntries(t){this.maxEntries=t;this.enforceMaxEntries()}enforceMaxEntries(){const t=this.store.size-this.maxEntries;if(t<=0)return;const e=this.store.keys();for(let s=0;s<t;s++){const t=e.next().value;if(t===undefined)break;this.store.delete(t)}}getMaxEntries(){return this.maxEntries}async destroy(){this.store.clear()}}const _=new C(new T);async function N(t,e=[],s={}){if(typeof t!=="string"){throw new TypeError("methodName 必須是字串")}s={cache:true,regionName:"dotnetInterop",...s};const l=`${t}:${JSON.stringify(e)}`;const a=s.cache??true;if(a){const t=await _.get(l);if(t!==null){return t}}try{const s=await(window.counterInterop?.invokeMethodAsync(t,...e));if(a){await _.set(l,s)}return s}catch(e){console.error(`[Interop] 無法呼叫 '${t}'：`,e);return"unknown"}}const P=":host{display:block}.input-group.input-group-static .form-control{background-color:white;line-height:1.25rem;padding:0.25rem}.detail-button{cursor:pointer}";const I=class{constructor(s){t(this,s);this.clickCell=e(this,"clickCell");this.clickAction=e(this,"clickAction");this.valueChanged=e(this,"valueChanged");this.cellWillValueChanged=e(this,"cellWillValueChanged");this.cellValueChanged=e(this,"cellValueChanged");this.cellDidValueChanged=e(this,"cellDidValueChanged");this.cellValueChangedOnBlur=e(this,"cellValueChangedOnBlur")}__cellValueEditingEvent;get host(){return s(this)}cellData;cellType="text";isDisabled=false;prependText;appendText;table;row;index;column;timeStamp;clickCell;clickAction;valueChanged;cellWillValueChanged;cellValueChanged;cellDidValueChanged;cellValueChangedOnBlur;valueChangedHandler(t){if(!this.column?.field)return;const e={id:h(this.row,this.table.fieldId),field:this.column.field,value:t.detail};this.cellWillValueChanged.emit(e)}cellWillValueChangedHandler(t){if(this.table.sidePagination==="stencil"){this.cellValueChanged.emit(t.detail)}}cellValueChangedHandler(t){c(this.row,this.column.field,t.detail.value);if(this.table.sidePagination==="stencil"){this.cellDidValueChanged.emit(t.detail)}}cellDidValueChangedHandler(t){if(this.host.querySelector(":focus")){this.__cellValueEditingEvent=t.detail}else if(this.__cellValueEditingEvent!=null){this.__cellValueEditingEvent=t.detail;this.__emitCellValueChangedOnBlur()}this.rerender()}focusoutHandler(t){if(this.__cellValueEditingEvent){this.__emitCellValueChangedOnBlur()}}rerender=b((()=>{i(this)}),100);async dispatchCustomEvent(t,e){this[t].emit(e)}renderSerialNumber(){return(this.table.pageNumber-1)*this.table.pageSize+this.index+1}renderDetail(){return l(n,{onToggle:t=>{const e=this.table.host.shadowRoot.querySelector('.row-detail[data-index="'+this.index+'"]');if(e){e.classList.toggle("d-none",!t)}}})}renderActionControl(){return l("storm-table-toolbar",{table:this.table,column:this.column,row:this.row,timeStamp:this.timeStamp,onClickAction:t=>{t.stopPropagation();this.clickAction.emit(t.detail)}})}renderInputControl(){return l("div",{class:"input-group input-group-static"},l("input",{class:"form-control",type:"text","aria-label":this.column.title,disabled:this.isDisabled,value:h(this.row,this.column.field),onClick:t=>t.stopPropagation(),onChange:t=>{t.stopPropagation();this.valueChanged.emit(t.target.value)}}))}renderTextareaControl(){const t=this.cellData;return l("div",{class:"input-group input-group-static"},l("textarea",{class:"form-control",disabled:this.isDisabled,cols:t.cols,rows:t.rows,title:this.column.title,value:h(this.row,this.column.field),onClick:t=>t.stopPropagation(),onChange:t=>{t.stopPropagation();this.valueChanged.emit(t.target.value)}}))}renderDropdownControl(){const t=this.cellData;const e=t.dataSet;return l("storm-dropdown",{disabled:this.isDisabled,label:t.label,value:h(this.row,this.column.field),dataSet:e,nullable:t.nullable??false,searchable:t.searchable??true,selection:"single",timeStamp:this.timeStamp,type:"select",onValueChanged:t=>{t.stopPropagation();this.valueChanged.emit(t.detail)}})}renderDropdownTreeControl(){const t=this.cellData;let e=t.dataSet;if(t.dataSets&&m(t.dataSets)){const s=t.dataSets.find((t=>x(t.conditions)&&u(t.conditions,this.row)));if(s){e=s.value}}return l("storm-dropdown-tree",{disabled:this.isDisabled,loading:t.loading,partialLoad:t.partialLoad,label:t.label,value:h(this.row,this.column.field),text:t.fieldText?h(this.row,t.fieldText):null,dataSet:e,dataSource:t.dataSource,fieldId:t.fieldId??"id",fieldLabel:t.fieldLabel??"label",fieldChildren:t.fieldChildren??"children",expandLevel:t.expandLevel??2,nodeSelectableRule:t.nodeSelectableRule,nullable:t.nullable??false,searchable:t.searchable??true,selection:"single",timeStamp:this.timeStamp,onValueChanged:t=>{t.stopPropagation();this.valueChanged.emit(t.detail)},onTextChanged:e=>{e.stopPropagation();if(t.fieldText)c(this.row,t.fieldText,e.detail)},onSearchChanged:t=>{t.stopPropagation()}})}renderCheckControl(){return l("storm-checkbox",{type:this.cellType==="checkbox"?"checkbox":"radio","is-disabled":this.isDisabled,"is-checked":h(this.row,this.column.field),"time-stamp":this.timeStamp})}renderCheckboxGroupControl(){const t=this.cellData;const e=h(this.row,this.column.field);const s=t.dataSet.filter((t=>{if(t.visible===undefined)return true;return typeof t.visible==="function"?t.visible(this.row):t.visible})).map((t=>({id:t.id,label:t.label,labelClasses:t.labelClasses,checked:t.checked,disabled:t.disabled})));return l("div",{class:"input-group input-group-static"},l("storm-checkbox-group",{disabled:this.isDisabled,type:t.groupType,value:e,dataSet:s,isSwitch:t.isSwitch??false,isInline:t.isInline??true,onValueChanged:t=>{t.stopPropagation();this.valueChanged.emit(t.detail)}}))}renderCellContent(){switch(this.cellType){case"action":return this.renderActionControl();case"input":return this.renderInputControl();case"checkbox":case"radio":return this.renderCheckControl();case"textarea":return this.renderTextareaControl();case"dropdown":return this.renderDropdownControl();case"dropdownTree":return this.renderDropdownTreeControl();case"checkboxGroup":return this.renderCheckboxGroupControl();case"serialNumber":return this.renderSerialNumber();case"detail":return this.renderDetail();case"text":return this.renderCellValue();case"empty":return"";default:return null}}renderCell(){if(!this.prependText&&!this.appendText){return this.renderCellContent()}else{return l("div",{class:"d-flex flex-row gap-1 align-items-center"},this.prependText&&l("span",null,this.prependText),this.renderCellContent(),this.appendText&&l("span",null,this.appendText))}}renderCellValue(){let t=h(this.row,this.column.field);if(typeof this.column.render==="function"){t=this.column.render(t,this.row,this.index)}else{if(Array.isArray(t)){t=t.filter((t=>t!=null&&t!=="")).join("、")}if(this.table.escape&&typeof t!=="boolean"&&t!=null){t=p(t)}if(t!=null&&this.column.transform&&this.column.transform[t.toString()]){t=this.column.transform[t]}else if(t&&this.table.searchable&&this.table.searchText){t=f(t,this.table.searchText)}}const e=this.column.cellTemplate||this.table.cellTemplate;const s=t!=null&&t.toString().trim().length>0?t:"-";return l("span",{innerHTML:g(e,{value:s,row:this.row,index:this.index})})}async componentWillRender(){if(!this.column){this.resetCellState();return}const[t,e]=await Promise.all([this.resolvePropertyValueAsync(this.column,"cellType"),this.resolvePropertyValueAsync(this.column,"data")]);this.cellType=t||this.column.type||"text";this.cellData=e;if(!this.cellData||typeof this.cellData!=="object"||Array.isArray(this.cellData)){this.resetControlState();return}const[s,l,a]=await Promise.all([this.resolvePropertyValueAsync(this.cellData,"disabled"),this.resolvePropertyValueAsync(this.cellData,"prependText"),this.resolvePropertyValueAsync(this.cellData,"appendText")]);this.isDisabled=s??false;this.prependText=l;this.appendText=a;if(this.isDisabled&&(this.cellType==="input"||this.cellType==="textarea")){this.cellType="text"}}resetCellState(){this.cellType="text";this.cellData=undefined;this.resetControlState()}resetControlState(){this.isDisabled=false;this.prependText=undefined;this.appendText=undefined;this.__cellValueEditingEvent=undefined}async resolvePropertyValueAsync(t,e){const s=y(t,e,[this.row,this.index,this.column]);if(V(s)){return this.handleCommandString(s)}if(x(s)){return u(s,this.row)}if(m(s)){return this.evaluateConditionGroups(s)}if(s instanceof Promise){try{return await s}catch(t){console.error("屬性 Promise 解析失敗",t);throw t}}return s}async handleCommandString(t){const e=D(t);if(e.command==="Invoke:DotNet"){const t=h(this.row,this.table?.fieldId);try{return await N(e.value,[t,this.index,this.column.field],{cache:true})}catch(t){console.error("InvokeDotNetMethod 執行失敗",t);throw t}}if(e.command==="Get:Field"){return h(this.row,e.value)}return t}evaluateConditionGroups(t){for(const e of t){if(x(e.conditions)&&u(e.conditions,this.row)){return e.value}}return undefined}__emitCellValueChangedOnBlur=b((()=>{if(this.__cellValueEditingEvent!==undefined){this.cellValueChangedOnBlur.emit(this.__cellValueEditingEvent);this.__cellValueEditingEvent=undefined}}),500);render(){return l(a,{key:"17114a940b14fb261a3fab204c1c4cf17107f644",onClick:t=>{if(this.cellType==="checkbox"||this.cellType==="radio"){t.stopPropagation();t.preventDefault();const e=this.cellData;if(e&&e.disabled){return}}this.clickCell.emit({id:h(this.row,this.table.fieldId),field:this.column.field})}},this.renderCell())}};I.style=P;export{w as storm_pagination,S as storm_table_body,I as storm_table_cell};
//# sourceMappingURL=p-feb7269f.entry.js.map