{"version":3,"names":["stormMultistepsFormCss","StormMultistepsForm","stepTitle","stepTitleDetail","stepButton","formSubmit","_stepButton","dataSetWatcher","newValue","this","JSON","parse","DOMstrings","componentWillLoad","componentDidRender","stepsBtnClass","stepsBtns","host","querySelectorAll","stepsBar","querySelector","stepsForm","stepsFormTextareas","stepFormPanelClass","stepFormPanels","stepPrevBtnClass","stepNextBtnClass","length","click","removeClasses","elemSet","className","forEach","elem","classList","remove","findParent","parentClass","currentNode","contains","parentNode","getActiveStep","Array","from","indexOf","setActiveStep","activeStepNum","index","add","getActivePanel","activePanel","setActivePanel","activePanelNum","stepBarClick","async","e","eventTarget","target","activeStep","prevNextClick","sendClick","stopPropagation","emit","setStepBtn","map","element","h","class","type","title","onClick","setPanel","name","toString","setPrevNextSendBtn","render","Host","key"],"sources":["src/components/storm-multisteps-form/storm-multisteps-form.css?tag=storm-multisteps-form","src/components/storm-multisteps-form/storm-multisteps-form.tsx"],"sourcesContent":[".multisteps-form__panel{\r\n  position: relative !important;\r\n}\r\n","import { Component, Element, Event, EventEmitter, Host, Prop, Watch, h } from '@stencil/core';\r\n\r\n@Component({\r\n  tag: 'storm-multisteps-form',\r\n  styleUrl: 'storm-multisteps-form.css',\r\n  shadow: false,\r\n})\r\nexport class StormMultistepsForm {\r\n  @Element() host: HTMLElement;\r\n\r\n  @Prop() stepTitle: string;\r\n  @Prop() stepTitleDetail: string;\r\n  @Prop() stepButton: string[] | string;\r\n  @Event() formSubmit: EventEmitter;\r\n  private _stepButton: string[];\r\n\r\n  @Watch('stepButton')\r\n  dataSetWatcher(newValue: string[] | string) {\r\n    if (typeof newValue === 'string') {\r\n      this._stepButton = JSON.parse(newValue);\r\n    } else {\r\n      this._stepButton = newValue;\r\n    }\r\n  }\r\n\r\n  //DOM elements\r\n  DOMstrings: {\r\n    stepsBtnClass;\r\n    stepsBtns;\r\n    stepsBar;\r\n    stepsForm;\r\n    stepsFormTextareas;\r\n    stepFormPanelClass;\r\n    stepFormPanels;\r\n    stepPrevBtnClass;\r\n    stepNextBtnClass;\r\n  };\r\n\r\n  // @Method()\r\n  // async resize() {\r\n  //   this.setFormHeight()\r\n  // }\r\n\r\n  componentWillLoad() {\r\n    if (!this.stepButton) return;\r\n    this.dataSetWatcher(this.stepButton);\r\n  }\r\n\r\n  componentDidRender() {\r\n    if (!this._stepButton && this.DOMstrings) return;\r\n    this.DOMstrings = {\r\n      stepsBtnClass: 'multisteps-form__progress-btn',\r\n      stepsBtns: this.host.querySelectorAll(`.multisteps-form__progress-btn`),\r\n      stepsBar: this.host.querySelector('.multisteps-form__progress'),\r\n      stepsForm: this.host.querySelector('.multisteps-form__form'),\r\n      stepsFormTextareas: this.host.querySelectorAll('.multisteps-form__textarea'),\r\n      stepFormPanelClass: 'multisteps-form__panel',\r\n      stepFormPanels: this.host.querySelectorAll('.multisteps-form__panel'),\r\n      stepPrevBtnClass: 'js-btn-prev',\r\n      stepNextBtnClass: 'js-btn-next',\r\n    };\r\n    //trigger stepbtn[0] by mao\r\n    if (this.DOMstrings.stepsBtns.length > 0) this.DOMstrings.stepsBtns[0].click();\r\n\r\n    // this.setFormHeight();\r\n\r\n    //SETTING PROPER FORM HEIGHT ONLOAD\r\n    // window.addEventListener('load', () => this.setFormHeight(), false);\r\n\r\n    //SETTING PROPER FORM HEIGHT ONRESIZE\r\n    // window.addEventListener('resize', () => this.setFormHeight(), false);\r\n  }\r\n\r\n  //remove class from a set of items\r\n  removeClasses = (elemSet, className) => {\r\n    elemSet.forEach(elem => {\r\n      elem.classList.remove(className);\r\n    });\r\n  };\r\n\r\n  //return exect parent node of the element\r\n  findParent = (elem, parentClass) => {\r\n    let currentNode = elem;\r\n\r\n    while (!currentNode.classList.contains(parentClass)) {\r\n      currentNode = currentNode.parentNode;\r\n    }\r\n\r\n    return currentNode;\r\n  };\r\n\r\n  //get active button step number\r\n  getActiveStep = elem => {\r\n    return Array.from(this.DOMstrings.stepsBtns).indexOf(elem);\r\n  };\r\n\r\n  //set all steps before clicked (and clicked too) to active\r\n  setActiveStep = activeStepNum => {\r\n    //remove active state from all the state\r\n    this.removeClasses(this.DOMstrings.stepsBtns, 'js-active');\r\n\r\n    //set picked items to active\r\n    this.DOMstrings.stepsBtns.forEach((elem, index) => {\r\n      if (index <= activeStepNum) {\r\n        elem.classList.add('js-active');\r\n      }\r\n    });\r\n  };\r\n\r\n  //get active panel\r\n  getActivePanel = () => {\r\n    let activePanel;\r\n\r\n    this.DOMstrings.stepFormPanels.forEach(elem => {\r\n      if (elem.classList.contains('js-active')) {\r\n        activePanel = elem;\r\n      }\r\n    });\r\n\r\n    return activePanel;\r\n  };\r\n\r\n  //open active panel (and close unactive panels)\r\n  setActivePanel = activePanelNum => {\r\n    //remove active class from all the panels\r\n    this.removeClasses(this.DOMstrings.stepFormPanels, 'js-active');\r\n\r\n    //show active panel\r\n    this.DOMstrings.stepFormPanels.forEach((elem, index) => {\r\n      if (index === activePanelNum) {\r\n        elem.classList.add('js-active');\r\n\r\n        // this.setFormHeight(/*elem*/);\r\n      }\r\n    });\r\n  };\r\n\r\n  //從css設定，取消設定高度\r\n  //set form height equal to current panel height\r\n  // formHeight = activePanel => {\r\n\r\n  //   const activePanelHeight = activePanel.offsetHeight;\r\n\r\n  //   this.DOMstrings.stepsForm.style.height = `${activePanelHeight}px`;\r\n\r\n  // };\r\n\r\n  //從css設定，取消設定高度\r\n  // setFormHeight = () => {\r\n  //   const activePanel = this.getActivePanel();\r\n\r\n  //   this.formHeight(activePanel);\r\n  // };\r\n\r\n  stepBarClick = async e => {\r\n    //check if click target is a step button\r\n    const eventTarget = e.target;\r\n\r\n    if (!eventTarget.classList.contains(`${this.DOMstrings.stepsBtnClass}`)) {\r\n      return;\r\n    }\r\n\r\n    //get active button step number\r\n    const activeStep = this.getActiveStep(eventTarget);\r\n\r\n    //set all steps before clicked (and clicked too) to active\r\n    this.setActiveStep(activeStep);\r\n\r\n    //open active panel\r\n    this.setActivePanel(activeStep);\r\n  };\r\n\r\n  prevNextClick = async e => {\r\n    const eventTarget = e.target;\r\n\r\n    //check if we clicked on `PREV` or NEXT` buttons\r\n    if (!(eventTarget.classList.contains(`${this.DOMstrings.stepPrevBtnClass}`) || eventTarget.classList.contains(`${this.DOMstrings.stepNextBtnClass}`))) {\r\n      return;\r\n    }\r\n\r\n    //find active panel\r\n    const activePanel = this.findParent(eventTarget, `${this.DOMstrings.stepFormPanelClass}`);\r\n\r\n    let activePanelNum = Array.from(this.DOMstrings.stepFormPanels).indexOf(activePanel);\r\n\r\n    //set active step and active panel onclick\r\n    if (eventTarget.classList.contains(`${this.DOMstrings.stepPrevBtnClass}`)) {\r\n      activePanelNum--;\r\n    } else {\r\n      activePanelNum++;\r\n    }\r\n\r\n    this.setActiveStep(activePanelNum);\r\n    this.setActivePanel(activePanelNum);\r\n  };\r\n\r\n  sendClick = async (e: Event) => {\r\n    e.stopPropagation();\r\n    this.formSubmit.emit();\r\n  };\r\n\r\n  //add by mao\r\n  setStepBtn = () => {\r\n    return this._stepButton?.map(element => (\r\n      <button class=\"multisteps-form__progress-btn\" type=\"button\" title={element} onClick={e => this.stepBarClick(e)}>\r\n        {element}\r\n      </button>\r\n    ));\r\n  };\r\n\r\n  //add by mao\r\n  setPanel = () => {\r\n    return this._stepButton?.map(element => {\r\n      let index = this._stepButton.indexOf(element);\r\n      return (\r\n        <div class=\"multisteps-form__panel border-radius-xl bg-white\" data-animation=\"FadeIn\">\r\n          <div class=\"multisteps-form__content\">\r\n            <slot name={/*\"multisteps\"+*/ index.toString()}></slot>\r\n            {this.setPrevNextSendBtn(index)}\r\n          </div>\r\n        </div>\r\n      );\r\n    });\r\n  };\r\n\r\n  //add by mao\r\n  setPrevNextSendBtn = (index: Number) => {\r\n    if (index == 0) {\r\n      return (\r\n        <div class=\"button-row d-flex mt-4\">\r\n          <button class=\"btn bg-gradient-dark ms-auto mb-0 js-btn-next\" type=\"button\" title=\"Next\" onClick={e => this.prevNextClick(e)}>\r\n            下一頁\r\n          </button>\r\n        </div>\r\n      );\r\n    } else if (this._stepButton.length - 1 == index) {\r\n      return (\r\n        <div class=\"button-row d-flex mt-0 mt-md-4\">\r\n          <button class=\"btn bg-gradient-light mb-0 js-btn-prev\" type=\"button\" title=\"Prev\" onClick={e => this.prevNextClick(e)}>\r\n            上一頁\r\n          </button>\r\n          <button class=\"btn bg-gradient-dark ms-auto mb-0\" type=\"button\" title=\"Send\" onClick={e => this.sendClick(e)}>\r\n            送出\r\n          </button>\r\n        </div>\r\n      );\r\n    } else {\r\n      return (\r\n        <div class=\"row\">\r\n          <div class=\"button-row d-flex mt-4 col-12\">\r\n            <button class=\"btn bg-gradient-light mb-0 js-btn-prev\" type=\"button\" title=\"Prev\" onClick={e => this.prevNextClick(e)}>\r\n              上一頁\r\n            </button>\r\n            <button class=\"btn bg-gradient-dark ms-auto mb-0 js-btn-next\" type=\"button\" title=\"Next\" onClick={e => this.prevNextClick(e)}>\r\n              下一頁\r\n            </button>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        {/* <div class=\"container-fluid py-4\"> */}\r\n        {/* <div class=\"row min-vh-80\"> */}\r\n        <div class=\"row\">\r\n          {' '}\r\n          {/* mark container and row add */}\r\n          <div class=\"row\">\r\n            {' '}\r\n            {/* progress bar contain */}\r\n            <div class=\"col-12 col-lg-8 mx-auto my-5\"></div>\r\n          </div>\r\n          <div class=\"col-lg-8 col-md-10 col-12 m-auto\">\r\n            {this.stepTitle ? <h3 class=\"mt-3 mb-0 text-center\">{this.stepTitle}</h3> : ''}\r\n            {this.stepTitleDetail ? <p class=\"lead font-weight-normal opacity-8 mb-7 text-center\">{this.stepTitleDetail}</p> : ''}\r\n            <div class=\"card\">\r\n              <div class=\"card-header p-0 position-relative mt-n5 mx-3 z-index-2\">\r\n                <div class=\"bg-gradient-primary shadow-primary border-radius-lg pt-4 pb-3\">\r\n                  <div class=\"multisteps-form__progress\">{this.setStepBtn()}</div>\r\n                </div>\r\n              </div>\r\n              <div class=\"card-body\">\r\n                <form class=\"multisteps-form__form\">{this.setPanel()}</form>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        {/* </div> */}\r\n        {/* </div> */}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]}