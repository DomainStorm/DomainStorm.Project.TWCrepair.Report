{"version":3,"file":"storm-checkbox-group.storm-dropdown-tree.storm-table-toolbar.storm-toolbar.storm-tree-view.entry.esm.js","sources":["src/components/storm-checkbox-group/storm-checkbox-group.css?tag=storm-checkbox-group","src/components/storm-checkbox-group/storm-checkbox-group.tsx","src/components/storm-dropdown-tree/storm-dropdown-tree.css?tag=storm-dropdown-tree","src/components/storm-dropdown-tree/storm-dropdown-tree.tsx","src/components/storm-table/storm-table-toolbar/storm-table-toolbar.css?tag=storm-table-toolbar","src/components/storm-table/storm-table-toolbar/storm-table-toolbar.tsx","src/components/storm-toolbar/storm-toolbar.css?tag=storm-toolbar","src/components/storm-toolbar/storm-toolbar.tsx","src/utils/cache/indexed-db-cache.ts","src/utils/fetch-data-source/fetch-data-source.ts","src/components/storm-tree-view/storm-tree-view.css?tag=storm-tree-view&encapsulation=shadow","src/components/storm-tree-view/storm-tree-view.tsx"],"sourcesContent":[":host {\r\n    display: block;\r\n}","import { Component, Event, EventEmitter, h, Host, Prop, Watch } from '@stencil/core';\r\n\r\n@Component({\r\n  tag: 'storm-checkbox-group',\r\n  styleUrl: 'storm-checkbox-group.css',\r\n  shadow: false,\r\n})\r\nexport class StormCheckboxGroup {\r\n  private _dataSet: ICheckboxItem[];\r\n\r\n  @Prop() type: 'checkbox' | 'radio' = 'checkbox';\r\n  @Prop() labelClasses: Record<string, boolean> | string = 'custom-control-label';\r\n  @Prop() isSwitch: boolean = false;\r\n  @Prop() isInline: boolean = false;\r\n  @Prop() dataSet: ICheckboxItem[] | string;\r\n  @Prop({ mutable: true }) value: string | string[];\r\n  @Prop({ mutable: true }) disabled?: boolean;\r\n\r\n  @Event() valueChanged: EventEmitter<string | string[] | null>;\r\n\r\n  @Watch('dataSet')\r\n  dataSetWatcher(newValue: ICheckboxItem[] | string) {\r\n    try {\r\n      this._dataSet = typeof newValue === 'string' ? JSON.parse(newValue) : newValue;\r\n    } catch (error) {\r\n      console.error('Invalid JSON format:', error);\r\n      return;\r\n    }\r\n    if (this.value) {\r\n      this.valueWatcher(this.value);\r\n    } else this.value = this.type === 'checkbox' ? this._dataSet.find(x => x.checked)?.id : this._dataSet.filter(x => x.checked).map(x => x.id);\r\n    if (this.type === 'radio') {\r\n      const checkedItems = this._dataSet.filter(x => x.checked);\r\n      if (checkedItems.length === 0) {\r\n        this._dataSet[0].checked = true;\r\n      } else if (checkedItems.length > 1) {\r\n        checkedItems\r\n          .reverse()\r\n          .slice(1)\r\n          .forEach(item => (item.checked = false));\r\n      }\r\n    }\r\n  }\r\n\r\n  @Watch('value')\r\n  valueWatcher(newValue: string | string[]) {\r\n    if (Array.isArray(newValue)) this._dataSet.forEach(x => (x.checked = newValue.includes(x.id)));\r\n    else this._dataSet.forEach(x => (x.checked = x.id == newValue));\r\n  }\r\n\r\n  check(item: ICheckboxItem) {\r\n    if (this.type === 'radio') {\r\n      this.uncheckAll();\r\n    }\r\n    item.checked = true;\r\n    if (this.type === 'radio') {\r\n      this.value = item.id;\r\n    } else if (Array.isArray(this.value)) {\r\n      if (!this.value.includes(item.id)) this.value = [...this.value, item.id];\r\n    } else {\r\n      this.value = [item.id];\r\n    }\r\n  }\r\n\r\n  uncheck(item: ICheckboxItem) {\r\n    item.checked = false;\r\n    if (this.type === 'radio') {\r\n      if (this.value === item.id) {\r\n        this.value = null;\r\n      }\r\n    } else if (Array.isArray(this.value)) {\r\n      this.value = this.value.filter(id => id !== item.id);\r\n    }\r\n  }\r\n\r\n  uncheckAll() {\r\n    if (this._dataSet) {\r\n      this._dataSet.filter(x => x.checked).forEach(x => (x.checked = false));\r\n    }\r\n  }\r\n\r\n  componentWillLoad() {\r\n    if (this.dataSet) {\r\n      this.dataSetWatcher(this.dataSet);\r\n    }\r\n  }\r\n\r\n  dataSetRender() {\r\n    return this._dataSet.map(item => {\r\n      if (!item.id) item.id = item.label;\r\n      return (\r\n        <storm-checkbox\r\n          type={this.type}\r\n          label={item.label}\r\n          labelClasses={item.labelClasses ?? this.labelClasses}\r\n          disabled={this.disabled || item.disabled}\r\n          checked={item.checked}\r\n          isSwitch={this.isSwitch}\r\n          isInline={this.isInline}\r\n          onValueChanged={ev => {\r\n            if (ev.detail) {\r\n              this.check(item);\r\n            } else {\r\n              this.uncheck(item);\r\n            }\r\n          }}\r\n        ></storm-checkbox>\r\n      );\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return <Host>{this.dataSetRender()}</Host>;\r\n  }\r\n}\r\n\r\nexport interface ICheckboxItem {\r\n  id?: string;\r\n  label: string;\r\n  labelClasses?: string;\r\n  checked?: boolean;\r\n  disabled?: boolean;\r\n}\r\n",":host {\r\n  display: block;\r\n}","import { Component, Element, Event, EventEmitter, h, Host, Prop, Watch } from '@stencil/core';\r\nimport type { FetchOption } from '../../utils/fetch-data-source/interface';\r\n\r\n@Component({\r\n  tag: 'storm-dropdown-tree',\r\n  styleUrl: 'storm-dropdown-tree.css',\r\n  shadow: false,\r\n})\r\nexport class StormDropdownTree {\r\n  private _dropdownRef: HTMLStormDropdownElement;\r\n  private _treeRef: HTMLStormTreeViewElement;\r\n  private _text: string;\r\n\r\n  @Element() host: HTMLElement;\r\n\r\n  @Prop({ mutable: true }) label: string;\r\n  @Prop({ mutable: true }) heading: string;\r\n  @Prop({ mutable: true }) text?: string;\r\n  @Prop({ mutable: true }) value?: string | string[];\r\n  @Prop({ mutable: true }) dataSet?: object | object[];\r\n  @Prop({ mutable: true }) dataSource?: FetchOption | Function | string;\r\n  @Prop({ mutable: true }) disabled?: boolean;\r\n  @Prop() nullable: boolean = false;\r\n  @Prop() fieldId: string = 'id';\r\n  @Prop() fieldLabel: string = 'label';\r\n  @Prop() fieldChildren: string = 'children';\r\n  @Prop() expandLevel: number = 2;\r\n  @Prop() nodeSelectableRule?: string | Function;\r\n  @Prop() size: 'Default' | 'Small' = 'Default';\r\n  @Prop() partialLoad: boolean = false;\r\n  @Prop() loading: 'eager' | 'lazy' = 'lazy';\r\n  @Prop() class: Record<string, boolean> | string;\r\n\r\n  @Prop({ mutable: true }) valid?: boolean;\r\n  @Prop() required?: boolean;\r\n\r\n  @Prop({ mutable: true }) searchText?: string;\r\n  @Prop() searchable: boolean = false;\r\n  @Prop() selection: 'single' | 'multiple' | 'none' = 'single';\r\n\r\n  @Prop({ mutable: true }) timeStamp?: number;\r\n\r\n  @Event() valueChanged: EventEmitter<string | string[]>;\r\n  @Event() textChanged: EventEmitter<string>;\r\n  @Event() searchChanged: EventEmitter<string>;\r\n\r\n  @Watch('value')\r\n  valueWatcher() {\r\n    this.updateValue();\r\n    this.valueChanged.emit(this.value);\r\n  }\r\n\r\n  @Watch('text')\r\n  textWatcher() {\r\n    this.textChanged.emit(this.text);\r\n  }\r\n\r\n  @Watch('dataSet')\r\n  dataSetWatcher() {\r\n    this._treeRef.dataSet = this.dataSet;\r\n  }\r\n\r\n  updateValue() {\r\n    if (this._treeRef.value != this.value) this._treeRef.value = this.value;\r\n    if (this._dropdownRef.value != this.value) this._dropdownRef.value = this.value;\r\n  }\r\n\r\n  componentDidLoad() {\r\n    this.updateValue();\r\n  }\r\n\r\n  renderTree() {\r\n    return (\r\n      <storm-tree-view\r\n        ref={elm => (this._treeRef = elm)}\r\n        partialLoad={this.partialLoad}\r\n        loading={this.loading}\r\n        value={this.value}\r\n        class={this.class}\r\n        dataSet={this.dataSet}\r\n        dataSource={this.dataSource}\r\n        fieldId={this.fieldId}\r\n        fieldLabel={this.fieldLabel}\r\n        fieldChildren={this.fieldChildren}\r\n        nullable={this.nullable}\r\n        selection={this.selection}\r\n        expandLevel={this.expandLevel}\r\n        nodeSelectableRule={this.nodeSelectableRule}\r\n        searchable={this.searchable}\r\n        onValueChanged={ev => {\r\n          ev.stopPropagation();\r\n          this.value = ev.detail;\r\n        }}\r\n        onNodeClick={async ev => {\r\n          ev.stopPropagation();\r\n          await this._dropdownRef.hide();\r\n        }}\r\n        onSearchChanged={ev => {\r\n          ev.stopPropagation();\r\n          this.searchChanged.emit(ev.detail);\r\n        }}\r\n      ></storm-tree-view>\r\n    );\r\n  }\r\n\r\n  async componentWillRender() {\r\n    this._text = this.text;\r\n    if (this._text == null) {\r\n      if (this._treeRef && this.value) {\r\n        const values = Array.isArray(this.value) ? this.value : [this.value];\r\n        const texts = [];\r\n        for (const value of values) {\r\n          const node = await this._treeRef.getNodeById(value);\r\n          if (node) {\r\n            texts.push(await this._treeRef.getLabel(node));\r\n          }\r\n        }\r\n        this._text = texts.join('、');\r\n      } else {\r\n        this._text = undefined;\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <storm-dropdown\r\n          ref={elm => (this._dropdownRef = elm)}\r\n          nullable={this.nullable}\r\n          heading={this.heading}\r\n          label={this.label}\r\n          text={this._text}\r\n          value={this.value}\r\n          showSelected={true}\r\n          valid={this.valid}\r\n          required={this.required}\r\n          disabled={this.disabled}\r\n          timeStamp={this.timeStamp}\r\n          type=\"select\"\r\n          onValueChanged={ev => {\r\n            ev.stopPropagation();\r\n            this.value = ev.detail;\r\n            if (this.value == null) {\r\n              this.text = undefined;\r\n            }\r\n          }}\r\n          onUnselectedAll={async ev => {\r\n            ev.stopPropagation();\r\n            await this._treeRef.unselectAll();\r\n          }}\r\n          onShowMenu={async ev => {\r\n            ev.stopPropagation();\r\n            await this._treeRef.loadDataSet();\r\n            if (this.searchable && this._treeRef) {\r\n              requestAnimationFrame(async () => {\r\n                await this._treeRef.setSearchFocus();\r\n              });\r\n            }\r\n          }}\r\n        >\r\n          {this.renderTree()}\r\n        </storm-dropdown>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n}\r\n\r\n:host storm-button,\r\n:host storm-dropdown,\r\n:host div {\r\n  vertical-align: middle;\r\n}\r\n\r\n\r\n:host .btn:hover:not(.active) {\r\n  color: white;\r\n}\r\n\r\n:host .btn.btn-outline-primary:hover {\r\n  background-color: #e91e63;\r\n}\r\n\r\n:host .btn.disabled {\r\n  color: #7b809a;\r\n  border-color: #7b809a;\r\n  cursor: not-allowed;\r\n}","import { Component, Element, Event, EventEmitter, Host, Prop, h } from '@stencil/core';\r\nimport type { ConditionInterface, ListItemInterface } from '../../../utils/interface';\r\nimport { calculateObjectValue, evaluateConditions, getFieldValue, isConditions } from '../../../utils/utils';\r\nimport type { ToolbarItemInterface } from '../../storm-toolbar/interface';\r\nimport type { TableColumnInterface } from '../interface';\r\nimport type { StormTable } from '../storm-table';\r\nimport type { ClickActionDetail } from '../storm-table-toolbar/interface';\r\n\r\n@Component({\r\n  tag: 'storm-table-toolbar',\r\n  styleUrl: 'storm-table-toolbar.css',\r\n  shadow: false,\r\n})\r\nexport class StormTableToolbar {\r\n  private _dateSet: ToolbarItemInterface[];\r\n\r\n  @Element() host: HTMLElement;\r\n\r\n  @Prop() table: StormTable;\r\n  @Prop() column: TableColumnInterface;\r\n  @Prop() row: object;\r\n  @Prop() isDynamicLabel: boolean = true;\r\n  @Prop({ mutable: true }) timeStamp?: number;\r\n\r\n  @Event() clickAction: EventEmitter<ClickActionDetail>;\r\n\r\n  componentWillRender() {\r\n    this._dateSet = this.column.buttons?.map(x => {\r\n      const item: ToolbarItemInterface = {\r\n        id: x.id,\r\n        type: x.type,\r\n        label: x.label,\r\n        tooltip: x.tooltip,\r\n        icon: x.icon,\r\n        size: 'sm',\r\n        buttonStyle: 'outline-primary',\r\n        rounded: true,\r\n        visible: () => {\r\n          if (isConditions(x.visible)) {\r\n            return evaluateConditions(x.visible as ConditionInterface[], this.row);\r\n          }\r\n          return calculateObjectValue(this, x.visible, this.row, this.table, getFieldValue(this.row, this.table.fieldIndex)) ?? true;\r\n        },\r\n        disabled: () => {\r\n          if (isConditions(x.disabled)) {\r\n            return evaluateConditions(x.disabled as ConditionInterface[], this.row);\r\n          }\r\n          return calculateObjectValue(this, x.disabled, this.row, this.table, getFieldValue(this.row, this.table.fieldIndex)) ?? false;\r\n        },\r\n        items: x.items\r\n          ? x.items.map(\r\n              y =>\r\n                ({\r\n                  id: y.id,\r\n                  title: y.title,\r\n                  icon: y.icon,\r\n                  selected: y.selected,\r\n                  visible: () => {\r\n                    if (isConditions(y.visible)) {\r\n                      return evaluateConditions(y.visible as ConditionInterface[], this.row);\r\n                    }\r\n                    return calculateObjectValue(this, y.visible, this.row, this.table, getFieldValue(this.row, this.table.fieldIndex)) ?? true;\r\n                  },\r\n                  disabled: () => {\r\n                    if (isConditions(y.disabled)) {\r\n                      return evaluateConditions(y.disabled as ConditionInterface[], this.row);\r\n                    }\r\n                    return calculateObjectValue(this, y.disabled, this.row, this.table, getFieldValue(this.row, this.table.fieldIndex)) ?? false;\r\n                  },\r\n                } as ListItemInterface),\r\n            )\r\n          : null,\r\n        click: (_: ToolbarItemInterface, dropdownItem: ListItemInterface = null) => {\r\n          if (x.action) x.action(this.row, x, this.table, dropdownItem);\r\n          this.clickAction.emit({\r\n            id: getFieldValue(this.row, this.table.fieldId),\r\n            field: this.column.field,\r\n            actionId: x.id,\r\n            dropdownItemId: dropdownItem ? dropdownItem.id : null,\r\n          });\r\n        },\r\n      } as ToolbarItemInterface;\r\n      return item;\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <storm-toolbar\r\n          class={{\r\n            'storm-dynamic-label': this.isDynamicLabel,\r\n            'justify-content-start': this.column.align === 'left',\r\n            'justify-content-center': this.column.align === 'center',\r\n            'justify-content-end': this.column.align === 'right',\r\n          }}\r\n          dataSet={this._dateSet}\r\n          timeStamp={this.timeStamp}\r\n        ></storm-toolbar>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n",":host {\n    display: block;\n}","import { Component, Event, EventEmitter, h, Prop } from '@stencil/core';\r\nimport type { ListItemInterface } from '../../utils/interface';\r\nimport { createFunctionFromString, isModuleFunctionString, parseClassNames } from '../../utils/utils';\r\nimport type { ToolbarItemInterface } from './interface';\r\n\r\n@Component({\r\n  tag: 'storm-toolbar',\r\n  styleUrl: 'storm-toolbar.css',\r\n  shadow: false,\r\n})\r\nexport class StormToolbar {\r\n  @Prop() dataSet: ToolbarItemInterface[];\r\n  @Prop({ mutable: true }) timeStamp?: number;\r\n  @Prop({ mutable: true }) class: Record<string, boolean> | string;\r\n\r\n  @Event() toolbarAction: EventEmitter<string>;\r\n\r\n  renderToolbarItem(item: ToolbarItemInterface) {\r\n    if (typeof item.visible === 'function' && !item.visible()) return;\r\n    if (typeof item.visible === 'boolean' && !item.visible) return;\r\n    if (item.type === 'group') {\r\n      return this.renderDropdown(item);\r\n    } else if (item.type === 'divider') {\r\n      return (\r\n        <div class=\"d-inline-flex align-middle mx-2\">\r\n          <div class=\"vr\"></div>\r\n        </div>\r\n      );\r\n    } else {\r\n      return (\r\n        <storm-toolbar-item\r\n          dataSet={item}\r\n          onToolbarAction={e => {\r\n            this.handleAction(e, item);\r\n          }}\r\n        ></storm-toolbar-item>\r\n      );\r\n    }\r\n  }\r\n\r\n  handleAction(_: Event, item: ToolbarItemInterface, dropdownItem: ListItemInterface = null) {\r\n    if (!item.click) return;\r\n    if (typeof item.click === 'string') {\r\n      if (!isModuleFunctionString(item.click)) {\r\n        throw new Error('Invalid function string');\r\n      }\r\n      item.click = createFunctionFromString(item.click);\r\n    }\r\n    item.click(item, dropdownItem);\r\n    this.toolbarAction.emit(dropdownItem ? dropdownItem.id : item.id);\r\n  }\r\n\r\n  renderDropdown(item: ToolbarItemInterface) {\r\n    if (!item || !item.items || item.items.length === 0) return;\r\n    return (\r\n      <div class=\"d-inline-flex align-middle\">\r\n        <storm-dropdown\r\n          dataSet={item.items}\r\n          trigger=\"click\"\r\n          toggleIcon=\"more_vert\"\r\n          type=\"none\"\r\n          selection=\"none\"\r\n          nullable={true}\r\n          showSelected={false}\r\n          onItemClick={e => {\r\n            this.handleAction(e, item, e.detail);\r\n          }}\r\n        ></storm-dropdown>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    if (!this.dataSet) return;\r\n    return (\r\n      <div class=\"w-100\">\r\n        <div class={{ 'd-flex': true, ...parseClassNames(this.class) }}>\r\n          {this.dataSet.map(x => {\r\n            return this.renderToolbarItem(x);\r\n          })}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import type { CacheEntry, ICacheProvider } from './interface';\n\nconst DB_NAME = 'UnifiedCacheDB';\nconst STORE_NAME = 'cache';\nconst DB_VERSION = 1;\n\n/**\n * IndexedDB 快取 (IndexedDBCache) 的實作，\n * 底層以 IndexedDB 做資料儲存，keyPath 為 'key'，value 為 CacheEntry 內容\n */\nexport class IndexedDBCache implements ICacheProvider {\n    private dbPromise: Promise<IDBDatabase> | null = null;\n    private isSupported: boolean | null = null;\n\n    /**\n     * 檢查 IndexedDB 是否可用\n     */\n    private checkSupport(): boolean {\n        if (this.isSupported === null) {\n            this.isSupported = !!(typeof window !== 'undefined' && window.indexedDB);\n        }\n        return this.isSupported;\n    }\n\n    /**\n     * 取得已開啟的 IndexedDB 連線，若是首次開啟會建立 object store\n     * 使用連線快取避免重複開啟資料庫\n     */\n    private openDB(): Promise<IDBDatabase> {\n        if (!this.checkSupport()) {\n            return Promise.reject(new Error('IndexedDB is not supported'));\n        }\n\n        if (!this.dbPromise) {\n            this.dbPromise = new Promise((resolve, reject) => {\n                const request = window.indexedDB.open(DB_NAME, DB_VERSION);\n                \n                request.onupgradeneeded = (event) => {\n                    const db = (event.target as IDBOpenDBRequest).result;\n                    if (!db.objectStoreNames.contains(STORE_NAME)) {\n                        db.createObjectStore(STORE_NAME, { keyPath: 'key' });\n                    }\n                };\n                \n                request.onsuccess = (event) => {\n                    const db = (event.target as IDBOpenDBRequest).result;\n                    \n                    // 監聽資料庫關閉事件，重置快取的連線\n                    db.onclose = () => {\n                        this.dbPromise = null;\n                    };\n                    \n                    // 監聽版本變更事件\n                    db.onversionchange = () => {\n                        db.close();\n                        this.dbPromise = null;\n                    };\n                    \n                    resolve(db);\n                };\n                \n                request.onerror = (event) => {\n                    this.dbPromise = null;\n                    reject((event.target as IDBOpenDBRequest).error);\n                };\n                \n                request.onblocked = () => {\n                    console.warn('IndexedDB connection is blocked');\n                };\n            });\n        }\n        \n        return this.dbPromise;\n    }\n\n    /**\n     * 安全執行資料庫操作，自動處理錯誤和資源清理\n     */\n    private async withTransaction<T>(\n        mode: IDBTransactionMode,\n        operation: (store: IDBObjectStore, tx: IDBTransaction) => Promise<T> | T\n    ): Promise<T> {\n        const db = await this.openDB();\n        \n        return new Promise((resolve, reject) => {\n            const tx = db.transaction(STORE_NAME, mode);\n            const store = tx.objectStore(STORE_NAME);\n            \n            let operationCompleted = false;\n            \n            tx.oncomplete = () => {\n                if (!operationCompleted) {\n                    resolve(undefined as T);\n                }\n            };\n            \n            tx.onerror = (event) => {\n                const error = (event.target as IDBRequest).error || new Error('Transaction failed');\n                reject(error);\n            };\n            \n            tx.onabort = (event) => {\n                const error = (event.target as IDBRequest).error || new Error('Transaction aborted');\n                reject(error);\n            };\n            \n            try {\n                const result = operation(store, tx);\n                if (result instanceof Promise) {\n                    result.then(\n                        (value) => {\n                            operationCompleted = true;\n                            resolve(value);\n                        },\n                        (error) => {\n                            tx.abort();\n                            reject(error);\n                        }\n                    );\n                } else {\n                    operationCompleted = true;\n                    resolve(result);\n                }\n            } catch (error) {\n                tx.abort();\n                reject(error);\n            }\n        });\n    }\n\n    async get(key: string): Promise<CacheEntry | null> {\n        return this.withTransaction('readonly', (store) => {\n            return new Promise<CacheEntry | null>((resolve, reject) => {\n                const req = store.get(key);\n                \n                req.onsuccess = async (evt) => {\n                    const record: (CacheEntry & { key: string }) | undefined = (evt.target as IDBRequest).result;\n                    if (!record) {\n                        resolve(null);\n                        return;\n                    }\n                    \n                    const now = Date.now();\n                    // 若過期，自動刪除並回傳 null\n                    if (typeof record.timestamp === 'number' && \n                        typeof record.expiredMillis === 'number' && \n                        now - record.timestamp >= record.expiredMillis) {\n                        \n                        // 非同步刪除過期項目，不阻塞當前讀取操作\n                        this.delete(key).catch(console.error);\n                        resolve(null);\n                    } else {\n                        resolve({\n                            value: record.value,\n                            timestamp: record.timestamp,\n                            expiredMillis: record.expiredMillis,\n                        });\n                    }\n                };\n                \n                req.onerror = (evt) => {\n                    reject((evt.target as IDBRequest).error);\n                };\n            });\n        });\n    }\n\n    async set(key: string, entry: CacheEntry): Promise<void> {\n        return this.withTransaction('readwrite', (store) => {\n            return new Promise<void>((resolve, reject) => {\n                const req = store.put({ key, ...entry });\n                req.onsuccess = () => resolve();\n                req.onerror = (evt) => reject((evt.target as IDBRequest).error);\n            });\n        });\n    }\n\n    async delete(key: string): Promise<void> {\n        return this.withTransaction('readwrite', (store) => {\n            return new Promise<void>((resolve, reject) => {\n                const req = store.delete(key);\n                req.onsuccess = () => resolve();\n                req.onerror = (evt) => reject((evt.target as IDBRequest).error);\n            });\n        });\n    }\n\n    async clear(): Promise<void> {\n        return this.withTransaction('readwrite', (store) => {\n            return new Promise<void>((resolve, reject) => {\n                const req = store.clear();\n                req.onsuccess = () => resolve();\n                req.onerror = (evt) => reject((evt.target as IDBRequest).error);\n            });\n        });\n    }\n\n    async deleteByPrefix(prefix: string): Promise<void> {\n        return this.withTransaction('readwrite', (store) => {\n            return new Promise<void>((resolve, reject) => {\n                // 使用 IDBKeyRange 優化效能，限制搜尋範圍\n                const range = IDBKeyRange.bound(\n                    prefix,\n                    prefix + '\\uffff',\n                    false,\n                    true\n                );\n                \n                const req = store.openCursor(range);\n                const keysToDelete: string[] = [];\n                \n                req.onsuccess = (event) => {\n                    const cursor = (event.target as IDBRequest<IDBCursorWithValue>).result;\n                    if (cursor) {\n                        const key = cursor.key.toString();\n                        if (key.startsWith(prefix)) {\n                            keysToDelete.push(key);\n                        }\n                        cursor.continue();\n                    } else {\n                        // 批次刪除提升效能\n                        if (keysToDelete.length > 0) {\n                            this.batchDelete(keysToDelete).then(\n                                () => resolve(),\n                                (error) => reject(error)\n                            );\n                        } else {\n                            resolve();\n                        }\n                    }\n                };\n                \n                req.onerror = (event) => {\n                    reject((event.target as IDBRequest).error);\n                };\n            });\n        });\n    }\n    \n    /**\n     * 批次刪除多個鍵值，提升刪除效能\n     */\n    async batchDelete(keys: string[]): Promise<void> {\n        if (keys.length === 0) return;\n        \n        return this.withTransaction('readwrite', (store) => {\n            return new Promise<void>((resolve, reject) => {\n                let completed = 0;\n                let hasError = false;\n                \n                const checkCompletion = () => {\n                    if (completed === keys.length && !hasError) {\n                        resolve();\n                    }\n                };\n                \n                for (const key of keys) {\n                    const req = store.delete(key);\n                    req.onsuccess = () => {\n                        completed++;\n                        checkCompletion();\n                    };\n                    req.onerror = (evt) => {\n                        if (!hasError) {\n                            hasError = true;\n                            reject((evt.target as IDBRequest).error);\n                        }\n                    };\n                }\n            });\n        });\n    }\n    \n    /**\n     * 批次設定多個項目，提升寫入效能\n     */\n    async batchSet(entries: Array<{ key: string; entry: CacheEntry }>): Promise<void> {\n        if (entries.length === 0) return;\n        \n        return this.withTransaction('readwrite', (store) => {\n            return new Promise<void>((resolve, reject) => {\n                let completed = 0;\n                let hasError = false;\n                \n                const checkCompletion = () => {\n                    if (completed === entries.length && !hasError) {\n                        resolve();\n                    }\n                };\n                \n                for (const { key, entry } of entries) {\n                    const req = store.put({ key, ...entry });\n                    req.onsuccess = () => {\n                        completed++;\n                        checkCompletion();\n                    };\n                    req.onerror = (evt) => {\n                        if (!hasError) {\n                            hasError = true;\n                            reject((evt.target as IDBRequest).error);\n                        }\n                    };\n                }\n            });\n        });\n    }\n    \n    /**\n     * 清理資源，關閉資料庫連線\n     */\n    async close(): Promise<void> {\n        if (this.dbPromise) {\n            try {\n                const db = await this.dbPromise;\n                db.close();\n            } catch (error) {\n                console.error('Error closing IndexedDB:', error);\n            } finally {\n                this.dbPromise = null;\n            }\n        }\n    }\n}","\r\nimport { CacheService } from '../cache/cache-service';\r\nimport { IndexedDBCache } from '../cache/indexed-db-cache';\r\nimport type { FetchOption } from './interface';\r\n\r\nconst cacheService = new CacheService(new IndexedDBCache(), {\r\n    regionName: 'fetchDataSource',\r\n});\r\n\r\nexport async function fetchDataSource(options: FetchOption): Promise<any> {\r\n    // 1. 合併預設值\r\n    options = {\r\n        method: 'POST',\r\n        contentType: 'application/json',\r\n        ...options,\r\n    };\r\n\r\n    // 2. 以 JSON.stringify(options) 當作單筆快取的 key\r\n    const key = JSON.stringify(options);\r\n\r\n    // 3. 嘗試從快取讀取 (使用預設 region)\r\n    const cached = await cacheService.get<any>(key);\r\n    if (cached !== null) {\r\n        return cached;\r\n    }\r\n\r\n    // 4. 快取不存在或已過期，真正執行 fetch\r\n    const response = await fetch(options.url, {\r\n        method: options.method,\r\n        body: options.method !== 'GET' ? JSON.stringify(options.body ?? {}) : null,\r\n        headers: new Headers({\r\n            'Content-Type': options.contentType,\r\n        }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n        throw new Error(`Network response was not ok: ${response.statusText}`);\r\n    }\r\n\r\n    const data =\r\n        options.contentType === 'application/json'\r\n            ? await response.json()\r\n            : await response.text();\r\n\r\n    // 5. 把新資料寫回快取 (使用預設 region)\r\n    await cacheService.set(key, data);\r\n\r\n    return data;\r\n}\r\n",":host {\r\n    display: block;\r\n    background-color: #fff;\r\n}\r\n\r\n:host .list-group-item {\r\n    border: none !important;\r\n    white-space: nowrap !important;\r\n    cursor: pointer !important;\r\n    margin-bottom: 0 !important;\r\n}\r\n\r\n:host .close.material-icons,\r\n:host .open.material-icons:hover {\r\n    opacity: 0.5;\r\n}\r\n\r\n:host .open.material-icons,\r\n:host .close.material-icons:hover {\r\n    opacity: 1;\r\n}\r\n\r\n:host .material-icons:empty {\r\n    width: 1.25rem;\r\n}\r\n\r\n:host .indent {\r\n    margin-left: 0.575rem;\r\n    margin-right: 0.575rem;\r\n}\r\n\r\n:host .leaf {\r\n    margin-left: 0.6rem;\r\n}","import { Component, Element, Event, EventEmitter, forceUpdate, h, Host, Listen, Method, Prop, Watch } from '@stencil/core';\r\nimport { fetchDataSource } from '../../utils/fetch-data-source/fetch-data-source';\r\nimport type { FetchOption } from '../../utils/fetch-data-source/interface';\r\nimport { FnSearchInput } from '../../utils/functional/functional';\r\nimport { SharedStyles } from '../../utils/shared-styles';\r\nimport { appendHighlight, calculateObjectValue, createFunctionFromString, debounce, getFieldValue, isModuleFunctionString, setFieldValue } from '../../utils/utils';\r\nimport type { StormTreeNode } from './storm-tree-node/storm-tree-node';\r\n\r\n@Component({\r\n  tag: 'storm-tree-view',\r\n  styleUrl: 'storm-tree-view.css',\r\n  shadow: true,\r\n})\r\nexport class StormTreeView {\r\n  private _searchText?: string;\r\n  private _dataSet?: object[];\r\n  private _items?: object[];\r\n  private _dataSource?: FetchOption | Function;\r\n  private _searchRef: HTMLStormInputGroupElement;\r\n  private _nodeSelectableRule?: Function;\r\n  private _nodeCheckRule?: Function;\r\n\r\n  @Element() host: HTMLElement;\r\n\r\n  @Prop() partialLoad: boolean = false;\r\n  @Prop() loading: 'eager' | 'lazy' = 'eager';\r\n  @Prop({ mutable: true }) value?: string | string[];\r\n  @Prop({ mutable: true }) checked: string[] = [];\r\n\r\n  @Prop() fieldId: string = 'id';\r\n  @Prop() fieldLabel: string = 'label';\r\n  @Prop() fieldChildren: string = 'children';\r\n\r\n  @Prop() fieldSubId: string = 'subId';\r\n  @Prop() fieldSubLabel: string = 'subLabel';\r\n  @Prop() fieldSubChildren: string = 'subChildren';\r\n\r\n  @Prop() fieldSelected: string = '_selected';\r\n  @Prop() fieldChecked: string = '_checked';\r\n  @Prop() fieldExpanded: string = '_expanded';\r\n  @Prop() fieldDisabled: string = '_disabled';\r\n  @Prop() fieldParent: string = '_parent';\r\n  @Prop() fieldSelectable: string = '_selectable';\r\n  @Prop() fieldCheckSelectable: string = '_checkSelectable';\r\n  @Prop() fieldIcon: string = '_icon';\r\n  @Prop() fieldHref: string = '_href';\r\n  @Prop() fieldLevel: string = '_level';\r\n  @Prop() fieldChildLoaded: string = '_loaded';\r\n  @Prop() fieldElement: string = '_element';\r\n\r\n  @Prop({ mutable: true }) expandIconAlign: 'left' | 'right' = 'left';\r\n  @Prop({ mutable: true }) expandIcon?: string;\r\n  @Prop({ mutable: true }) collapseIcon?: string;\r\n  @Prop() color?: string;\r\n\r\n  @Prop({ mutable: true }) dataSet?: object | object[];\r\n  @Prop({ mutable: true }) dataSource?: FetchOption | Function | string;\r\n  @Prop({ mutable: true }) fetch?: Function;\r\n  @Prop() nullable: boolean = true;\r\n  @Prop({ mutable: true }) expandLevel: number = 2;\r\n  @Prop() structure: 'tree' | 'array' | 'auto' = 'auto';\r\n  @Prop() searchable: boolean = false;\r\n  @Prop() selection: 'single' | 'multiple' | 'none' = 'single';\r\n  @Prop({ mutable: true }) nodeSelectableRule?: string | Function;\r\n  @Prop() checkSelectable: boolean = false;\r\n  @Prop({ mutable: true }) nodeCheckRule?: string | Function;\r\n  @Prop({ mutable: true }) selectToCheck: boolean = true;\r\n\r\n  @Event() dateSetLoaded: EventEmitter;\r\n  @Event() valueChanged: EventEmitter<string | string[]>;\r\n  @Event() nodeSelect: EventEmitter<string>;\r\n  @Event() nodeUnselect: EventEmitter<string>;\r\n  @Event() nodeClick: EventEmitter<string>;\r\n  @Event() nodeDblClick: EventEmitter<string>;\r\n  @Event() nodeCheck: EventEmitter<string>;\r\n  @Event() nodeUncheck: EventEmitter<string>;\r\n  @Event() checkedChanged: EventEmitter<string[]>;\r\n\r\n  @Event() searchChanged: EventEmitter<string>;\r\n  @Event() keydown: EventEmitter<KeyboardEvent>;\r\n\r\n  @Listen('searchChanged')\r\n  async searchChangedHandler(ev: CustomEvent<string>) {\r\n    this._searchText = ev.detail;\r\n    if (this.partialLoad) {\r\n      this.cleanNodes();\r\n      await this.loadDataSet();\r\n    } else {\r\n      this.rerender();\r\n    }\r\n  }\r\n\r\n  @Listen('nodeSelect')\r\n  nodeSelectHandler(ev: CustomEvent<string>) {\r\n    switch (this.selection) {\r\n      case 'single':\r\n        this.value = ev.detail;\r\n        break;\r\n      case 'multiple': {\r\n        const currentValue = Array.isArray(this.value) ? this.value : this.value ? [this.value] : [];\r\n        if (!currentValue.includes(ev.detail)) this.value = [...currentValue, ev.detail];\r\n        break;\r\n      }\r\n      default:\r\n        console.warn(`Unknown selection mode: ${this.selection}`);\r\n    }\r\n  }\r\n\r\n  @Listen('nodeUnselect')\r\n  nodeUnselectHandler(ev: CustomEvent<string>) {\r\n    switch (this.selection) {\r\n      case 'single':\r\n        if (this.value === ev.detail) {\r\n          this.value = null;\r\n        }\r\n        break;\r\n      case 'multiple': {\r\n        const currentValue = Array.isArray(this.value) ? this.value : [];\r\n        if (currentValue.includes(ev.detail)) this.value = currentValue.filter(id => id !== ev.detail);\r\n        break;\r\n      }\r\n      default:\r\n        console.warn(`Unknown selection mode: ${this.selection}`);\r\n    }\r\n  }\r\n\r\n  @Listen('nodeCheck')\r\n  nodeCheckHandler(ev: CustomEvent<string>) {\r\n    if (this.selectToCheck) return;\r\n    if (!this.checked.includes(ev.detail)) this.checked = [...this.checked, ev.detail];\r\n  }\r\n\r\n  @Listen('nodeUncheck')\r\n  nodeUncheckHandler(ev: CustomEvent<string>) {\r\n    if (this.selectToCheck) return;\r\n    if (this.checked.includes(ev.detail)) this.checked = this.checked.filter(id => id !== ev.detail);\r\n  }\r\n\r\n  @Listen('valueChanged')\r\n  async valueChangedHandler(): Promise<void> {\r\n    if (!Array.isArray(this._items)) return;\r\n\r\n    const valueArray = Array.isArray(this.value) ? this.value : this.value ? [this.value] : [];\r\n\r\n    await Promise.all(\r\n      this._items.map(async item => {\r\n        const id = String(getFieldValue(item, this.fieldId));\r\n        const shouldSelect = valueArray.includes(id);\r\n        const selected = getFieldValue(item, this.fieldSelected) === true;\r\n\r\n        const promises: Promise<void>[] = [];\r\n        if (shouldSelect) {\r\n          promises.push(this.setNodeExpanded(item));\r\n        }\r\n\r\n        if (selected !== shouldSelect) {\r\n          promises.push(this.setNodeSelectionState(item, shouldSelect));\r\n        }\r\n\r\n        return Promise.all(promises);\r\n      }),\r\n    );\r\n\r\n    if (this.checkSelectable && this.selectToCheck) {\r\n      this.checked = valueArray;\r\n    }\r\n  }\r\n\r\n  @Listen('checkedChanged')\r\n  async checkedChangedHandler(): Promise<void> {\r\n    if (!Array.isArray(this._items)) return;\r\n\r\n    await Promise.all(\r\n      this._items.map(item => {\r\n        const id = String(getFieldValue(item, this.fieldId));\r\n        const checkedArray = Array.isArray(this.checked) ? this.checked : this.checked ? [this.checked] : [];\r\n        const shouldChecked = checkedArray.includes(id);\r\n        const checked = getFieldValue(item, this.fieldChecked) === true;\r\n\r\n        if (checked !== shouldChecked) {\r\n          return this.setNodeCheckedState(item, shouldChecked);\r\n        }\r\n        return Promise.resolve();\r\n      }),\r\n    );\r\n  }\r\n\r\n  @Watch('value')\r\n  async watchValueHandler() {\r\n    this.valueChanged.emit(this.value);\r\n  }\r\n\r\n  @Watch('checked')\r\n  async watchCheckedHandler() {\r\n    this.checkedChanged.emit(this.checked);\r\n  }\r\n\r\n  async setNodeSelectionState(item: object, shouldSelect: boolean): Promise<void> {\r\n    const node = await this.getTreeNode(item);\r\n\r\n    if (node) {\r\n      await (shouldSelect ? node.select() : node.unselect());\r\n    } else {\r\n      setFieldValue(item, this.fieldSelected, shouldSelect);\r\n    }\r\n    if (this.checkSelectable && this.selectToCheck) {\r\n      await this.setNodeCheckedState(item, shouldSelect);\r\n    }\r\n  }\r\n\r\n  async setNodeCheckedState(item: object, shouldChecked: boolean): Promise<void> {\r\n    const node = await this.getTreeNode(item);\r\n\r\n    if (node) {\r\n      await (shouldChecked ? node.check() : node.uncheck());\r\n    } else {\r\n      setFieldValue(item, this.fieldChecked, shouldChecked);\r\n    }\r\n  }\r\n\r\n  @Watch('dataSource')\r\n  watchDataSourceHandler() {\r\n    this.cleanNodes();\r\n    if (typeof this.dataSource === 'string') {\r\n      if (isModuleFunctionString(this.dataSource)) {\r\n        this._dataSource = createFunctionFromString(this.dataSource);\r\n      } else if (this.dataSource.startsWith('{') && this.dataSource.endsWith('}')) {\r\n        this._dataSource = JSON.parse(this.dataSource) as FetchOption;\r\n      } else {\r\n        this._dataSource = { url: this.dataSource } as FetchOption;\r\n      }\r\n    } else {\r\n      this._dataSource = this.dataSource;\r\n    }\r\n  }\r\n\r\n  @Watch('nodeSelectableRule')\r\n  watchNodeSelectableRuleHandler() {\r\n    if (typeof this.nodeSelectableRule === 'string') {\r\n      if (isModuleFunctionString(this.nodeSelectableRule)) {\r\n        this._nodeSelectableRule = createFunctionFromString(this.nodeSelectableRule);\r\n      }\r\n    } else {\r\n      this._nodeSelectableRule = this.nodeSelectableRule;\r\n    }\r\n  }\r\n\r\n  @Watch('nodeCheckRule')\r\n  watchNodeCheckRuleHandler() {\r\n    if (typeof this.nodeCheckRule === 'string') {\r\n      if (isModuleFunctionString(this.nodeCheckRule)) {\r\n        this._nodeCheckRule = createFunctionFromString(this.nodeCheckRule);\r\n      }\r\n    } else {\r\n      this._nodeCheckRule = this.nodeCheckRule;\r\n    }\r\n  }\r\n\r\n  @Watch('dataSet')\r\n  async watchDataSetHandler() {\r\n    this.cleanNodes();\r\n    await this.watchValueHandler();\r\n    await this.watchCheckedHandler();\r\n  }\r\n\r\n  @Method()\r\n  async getNodeById(id: string): Promise<object | null> {\r\n    if (!this._items) return null;\r\n    return this._items.find(x => getFieldValue(x, this.fieldId) === id);\r\n  }\r\n\r\n  @Method()\r\n  async getTreeNode(item: object): Promise<HTMLStormTreeNodeElement> {\r\n    return getFieldValue(item, this.fieldElement) as HTMLStormTreeNodeElement;\r\n  }\r\n\r\n  @Method()\r\n  async getLabel(item: object): Promise<string> {\r\n    return getFieldValue(item, this.fieldLabel);\r\n  }\r\n\r\n  @Method()\r\n  async unselectAll() {\r\n    this.value = null;\r\n  }\r\n\r\n  @Method()\r\n  async loadDataSet() {\r\n    if (this._dataSet) return;\r\n    if (this.dataSource || this.fetch) {\r\n      try {\r\n        const dataSet = await this.getDataSource();\r\n        this.setDataSet(dataSet);\r\n      } catch (error) {\r\n        console.error('Error loading data:', error);\r\n      }\r\n    } else {\r\n      this.setDataSet(this.dataSet);\r\n    }\r\n  }\r\n\r\n  @Method()\r\n  async getSelected(): Promise<object[]> {\r\n    return this._items.filter(node => getFieldValue(node, this.fieldSelected));\r\n  }\r\n\r\n  @Method()\r\n  async getSelectedById(): Promise<string[]> {\r\n    return await this.getSelected().then(x => x.map(y => getFieldValue(y, this.fieldId)));\r\n  }\r\n\r\n  @Method()\r\n  async setSearchFocus() {\r\n    if (this.searchable && this._searchRef) {\r\n      await this._searchRef.setFocus();\r\n    }\r\n  }\r\n\r\n  private readonly rerender = debounce(async (): Promise<void> => {\r\n    if (!Array.isArray(this._items) || this._items.length === 0) return;\r\n    await Promise.all(\r\n      this._items.map(async item => {\r\n        const node = await this.getTreeNode(item);\r\n        if (node) {\r\n          forceUpdate(node);\r\n        }\r\n      }),\r\n    );\r\n    forceUpdate(this);\r\n  }, 100);\r\n\r\n  renderNode(item: object): StormTreeNode {\r\n    let content = getFieldValue(item, this.fieldLabel);\r\n    if (content && this._searchText) {\r\n      content = appendHighlight(content, this._searchText);\r\n    }\r\n\r\n    return <storm-tree-node tree={this} dataSet={item} content={content} searchText={this._searchText}></storm-tree-node>;\r\n  }\r\n\r\n  async setNodeExpanded(item: object) {\r\n    let parent = getFieldValue(item, this.fieldParent);\r\n    while (parent) {\r\n      const node = await this.getTreeNode(parent);\r\n      if (node) {\r\n        await node.expand().catch(error => {\r\n          console.error('Failed to expand tree node:', error);\r\n        });\r\n      } else {\r\n        setFieldValue(parent, this.fieldExpanded, true);\r\n      }\r\n\r\n      parent = getFieldValue(parent, this.fieldParent);\r\n    }\r\n  }\r\n\r\n  cleanNodes() {\r\n    this._dataSet = undefined;\r\n    this._items = undefined;\r\n  }\r\n\r\n  async getDataSource(treeNode: StormTreeNode | null = null): Promise<any> {\r\n    if (this.fetch) {\r\n      return this.fetch(treeNode?.dataSet);\r\n    } else {\r\n      const options: FetchOption = typeof this._dataSource === 'function' ? this._dataSource(treeNode?.dataSet, this._searchText) : this._dataSource;\r\n      return await fetchDataSource(options);\r\n    }\r\n  }\r\n\r\n  async loadChild(treeNode: StormTreeNode) {\r\n    try {\r\n      const dataSource = await this.getDataSource(treeNode);\r\n      const dataSet = this.dataSetParse(dataSource);\r\n\r\n      await this.mergeChild(\r\n        dataSet,\r\n        this.fieldChildren.split('&').map(x => x.trim()),\r\n      );\r\n      setFieldValue(treeNode.dataSet, this.fieldChildLoaded, true);\r\n\r\n      this._items = this.updateItems(this._dataSet);\r\n    } catch (error) {\r\n      console.error('Error loading data:', error);\r\n    }\r\n  }\r\n\r\n  async mergeChild(source: any, fieldChildren: string[]): Promise<void> {\r\n    for (const item of source) {\r\n      const dest = await this.getNodeById(getFieldValue(item, this.fieldId));\r\n\r\n      for (const part of fieldChildren) {\r\n        const sourcePartValue = getFieldValue(item, part);\r\n        const destPartValue = getFieldValue(dest, part);\r\n\r\n        if (!!sourcePartValue && (!destPartValue || destPartValue.length == 0)) {\r\n          setFieldValue(dest, part, sourcePartValue);\r\n        } else if (!!sourcePartValue && sourcePartValue.length > 0) {\r\n          await this.mergeChild(sourcePartValue, [part]);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  dataSetParse(value: object | object[]): object[] {\r\n    const clonedValue = JSON.parse(JSON.stringify(value));\r\n    const structureType = this.structure === 'auto' ? (!Array.isArray(clonedValue) && !!this.fieldChildren ? 'tree' : 'array') : this.structure;\r\n\r\n    switch (structureType) {\r\n      case 'tree':\r\n        return getFieldValue(clonedValue, this.fieldChildren) as object[];\r\n      case 'array':\r\n        return clonedValue as object[];\r\n      default:\r\n        throw new Error(`Unsupported structure type: ${structureType}`);\r\n    }\r\n  }\r\n\r\n  setDataSet(value: object | object[]) {\r\n    if (!value) return;\r\n\r\n    this._dataSet = this.dataSetParse(value);\r\n    this._items = this.updateItems(this._dataSet);\r\n\r\n    this.rerender();\r\n  }\r\n\r\n  updateItems(value: object[], parent: object = null): object[] {\r\n    if (!value || value.length === 0) return [];\r\n\r\n    const items: object[] = [];\r\n    for (const item of value) {\r\n      let id = getFieldValue(item, this.fieldId);\r\n      if (id == null) {\r\n        id = getFieldValue(item, this.fieldLabel);\r\n        setFieldValue(item, this.fieldId, id);\r\n      }\r\n\r\n      if (this.selection != 'none' && item[this.fieldSelectable] == null) {\r\n        setFieldValue(item, this.fieldSelectable, calculateObjectValue(this, this._nodeSelectableRule, item) ?? true);\r\n      }\r\n      if (this.checkSelectable && item[this.fieldCheckSelectable] == null) {\r\n        setFieldValue(item, this.fieldCheckSelectable, calculateObjectValue(this, this._nodeCheckRule, item) ?? true);\r\n      }\r\n\r\n      let level: number = 1;\r\n      if (parent) {\r\n        setFieldValue(item, this.fieldParent, parent);\r\n        level = (getFieldValue(parent, this.fieldLevel) as number) + 1;\r\n      }\r\n\r\n      setFieldValue(item, this.fieldLevel, level);\r\n      if (!getFieldValue(item, this.fieldChildLoaded)) {\r\n        setFieldValue(item, this.fieldExpanded, this.expandLevel > level);\r\n        setFieldValue(item, this.fieldChildLoaded, !this.partialLoad || this.expandLevel > level);\r\n      }\r\n\r\n      items.push(item);\r\n\r\n      const children = getFieldValue(item, this.fieldChildren);\r\n      if (children && children.length > 0) {\r\n        items.push(...this.updateItems(children, item));\r\n      }\r\n    }\r\n\r\n    return items;\r\n  }\r\n\r\n  async componentWillLoad() {\r\n    SharedStyles.applyShadowRootStyles(this.host);\r\n    this.expandIcon = this.expandIcon ?? (this.expandIconAlign === 'right' ? 'add' : 'chevron_right');\r\n    this.collapseIcon = this.collapseIcon ?? (this.expandIconAlign === 'right' ? 'remove' : 'expand_more');\r\n    this.watchDataSourceHandler();\r\n    this.watchNodeSelectableRuleHandler();\r\n    this.watchNodeCheckRuleHandler();\r\n  }\r\n\r\n  async componentWillRender() {\r\n    if (this.loading === 'eager' || !this.partialLoad) {\r\n      await this.loadDataSet();\r\n    }\r\n\r\n    if (this.selection != 'none' && !this.nullable && !this.value && this._items?.length) {\r\n      this.value = getFieldValue(\r\n        this._items.find(item => getFieldValue(item, this.fieldSelectable)),\r\n        this.fieldId,\r\n      );\r\n    }\r\n\r\n    await this.watchValueHandler();\r\n    await this.watchCheckedHandler();\r\n  }\r\n\r\n  async componentDidLoad() {\r\n    if (this._items?.length) {\r\n      this.dateSetLoaded.emit();\r\n    }\r\n  }\r\n\r\n  handleSearchChanged(ev: CustomEvent<string>) {\r\n    ev.stopPropagation();\r\n    const value = ev.detail?.trim() ?? '';\r\n    if (this._searchText === value) return;\r\n    if (value) {\r\n      this.searchChanged.emit(value);\r\n    }\r\n  }\r\n\r\n  renderSearch() {\r\n    if (!this.searchable) return;\r\n    return <FnSearchInput ref={elm => (this._searchRef = elm)} value={this._searchText} onValueChanged={ev => this.handleSearchChanged(ev)} />;\r\n  }\r\n\r\n  nodesRender() {\r\n    let nodes: any[] = [];\r\n    if (this.partialLoad || !this.searchable || this._searchText == null || !this._searchText.length) {\r\n      nodes = this._dataSet;\r\n    } else {\r\n      nodes = this._items.filter(x => getFieldValue(x, this.fieldLabel).includes(this._searchText));\r\n    }\r\n    if (nodes.length === 0) return <div class=\"align-middle text-center p-4 h6\">沒有找到符合的結果</div>;\r\n    return nodes.map(item => this.renderNode(item));\r\n  }\r\n\r\n  render() {\r\n    if (!this._dataSet) return;\r\n\r\n    return (\r\n      <Host>\r\n        {this.renderSearch()}\r\n        {this.nodesRender()}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}