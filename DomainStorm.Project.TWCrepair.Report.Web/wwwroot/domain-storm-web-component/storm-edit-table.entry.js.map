{"file":"storm-edit-table.entry.esm.js","mappings":"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","names":[],"sources":["src/components/storm-edit-table/storm-edit-table.css?tag=storm-edit-table&encapsulation=shadow","src/components/storm-edit-table/storm-edit-table.tsx"],"sourcesContent":["","import { Component, Element, Event, EventEmitter, h, Host, Prop } from '@stencil/core';\r\nimport { SharedStyles } from '../../utils/shared-styles';\r\nimport { parseClassNames } from '../../utils/utils';\r\nimport type { TableColumnInterface } from '../storm-table/interface';\r\nimport { StormTable } from '../storm-table/storm-table';\r\n\r\n@Component({\r\n  tag: 'storm-edit-table',\r\n  styleUrl: 'storm-edit-table.css',\r\n  shadow: true,\r\n})\r\nexport class StormEditTable {\r\n  @Element() host: HTMLElement;\r\n  @Prop() dataSet: object[];\r\n  @Prop() columns: TableColumnInterface[];\r\n  @Prop() classes: Record<string, boolean> | string = 'table-hover table-striped table-dark table-sm table-borderless';\r\n  @Prop() clickRowTo?: 'select' | 'check';\r\n  @Prop() pagination: boolean = false;\r\n  @Prop() searchable: boolean = false;\r\n  @Prop() viewable: boolean = true;\r\n  @Prop() editable: boolean = true;\r\n  @Prop() deletable: boolean = true;\r\n  @Prop() orderable: boolean = false;\r\n  @Prop() escape: boolean = true;\r\n  // @Prop() actionColumn: ITableColumn\r\n\r\n  @Event() change: EventEmitter;\r\n  @Event() rowView: EventEmitter<object>;\r\n  @Event() rowUpdate: EventEmitter<object>;\r\n  @Event() rowDelete: EventEmitter<object>;\r\n\r\n  tableRef: HTMLStormTableElement;\r\n  tableResponsiveRef: any;\r\n  viewAnchors: HTMLAnchorElement[];\r\n  deleteAnchors: HTMLAnchorElement[];\r\n  value: any;\r\n\r\n  async componentWillLoad() {\r\n    await SharedStyles.applyShadowRootStylesAsync(this.host, 'material');\r\n  }\r\n\r\n  componentWillRender() {\r\n    if (!this.columns) return;\r\n    this.addActionColumnRender();\r\n  }\r\n\r\n  addActionColumnRender() {\r\n    const actionColumns = this.columns.filter(c => c.type == 'action');\r\n    if (actionColumns.length == 0) return;\r\n\r\n    for (var c of actionColumns) {\r\n      c.buttons = [];\r\n    }\r\n\r\n    if (this.orderable) {\r\n      actionColumns[0].buttons.push(\r\n        {\r\n          label: '上移',\r\n          icon: 'arrow_upward',\r\n          action: (row: object, _action: object, table: StormTable) => {\r\n            (async () => {\r\n              let from = row['__index'];\r\n              let to = row['__index'] - 1;\r\n              await table.moveRow(from, to);\r\n            })();\r\n          },\r\n          visible: row => {\r\n            return row['__index'] > 0;\r\n          },\r\n        },\r\n        {\r\n          label: '下移',\r\n          icon: 'arrow_downward',\r\n          action: (row: object, _action: object, table: StormTable) => {\r\n            (async () => {\r\n              let from = row['__index'];\r\n              let to = row['__index'] + 1;\r\n              await table.moveRow(from, to);\r\n            })();\r\n          },\r\n          visible: row => {\r\n            return row['__index'] < this.dataSet?.length - 1;\r\n          },\r\n        },\r\n      );\r\n    }\r\n\r\n    let i = actionColumns.length == 2 ? 1 : 0;\r\n    if (this.viewable) {\r\n      actionColumns[i].buttons.push({\r\n        label: '觀看',\r\n        icon: 'visibility',\r\n        action: (row: object, _action: object, _table: StormTable) => {\r\n          (async () => {\r\n            this.rowView.emit(row);\r\n          })();\r\n        },\r\n      });\r\n    }\r\n    if (this.editable) {\r\n      actionColumns[i].buttons.push({\r\n        label: '修改',\r\n        icon: 'drive_file_rename_outline',\r\n        action: (row: object, _action: object, _table: StormTable) => {\r\n          (async () => {\r\n            this.rowUpdate.emit(row);\r\n          })();\r\n        },\r\n      });\r\n    }\r\n    if (this.deletable) {\r\n      actionColumns[i].buttons.push({\r\n        label: '刪除',\r\n        icon: 'delete',\r\n        action: (row: object, _action: object, _table: StormTable) => {\r\n          (async () => {\r\n            this.rowDelete.emit(row);\r\n          })();\r\n        },\r\n      });\r\n    }\r\n\r\n    // const actionColumns = this.columns.filter(c => c.type == \"action\");\r\n    // if(actionColumns.length == 0)\r\n    //   return;\r\n\r\n    // actionColumns[0].render = (value, row, index) => {\r\n    //   let renderList = []\r\n    //   if(this.viewable){\r\n    //     renderList.push('<storm-tooltip title=\"觀看\">',\r\n    //     '<a role=\"button\" class=\"mx-1 editor-view\" data-index=\"'+index+'\">',\r\n    //     '<i class=\"material-icons\">visibility</i>',\r\n    //     '</a>',\r\n    //     '</storm-tooltip>')\r\n    //   }\r\n    //   if(this.editable){\r\n    //     renderList.push('<storm-tooltip title=\"修改\">',\r\n    //     '<a role=\"button\" class=\"mx-1 editor-update\" data-index=\"'+index+'\">',\r\n    //     '<i class=\"material-icons\">drive_file_rename_outline</i>',\r\n    //     '</a>',\r\n    //     '</storm-tooltip>')\r\n    //   }\r\n    //   if(this.deletable){\r\n    //     renderList.push('<storm-tooltip title=\"刪除\">',\r\n    //     '<a role=\"button\" class=\"mx-1 editor-delete\" data-index=\"'+index+'\">',\r\n    //     '<i class=\"material-icons\">delete</i>',\r\n    //     '</a>',\r\n    //     '</storm-tooltip>')\r\n    //   }\r\n    //   return renderList.join('')};\r\n  }\r\n\r\n  // async componentDidRender() {\r\n  //   this.tableRef.shadowRoot.querySelectorAll(\".editor-view\").forEach((element) => {\r\n  //     element.addEventListener('click', (e) => {\r\n  //       const rowIndex = parseInt((e.currentTarget as HTMLElement).getAttribute(\"data-index\"))\r\n  //       this.rowView.emit(this.dataSet[rowIndex]);\r\n  //       e.stopPropagation();\r\n  //     })\r\n  //   });\r\n\r\n  //   this.tableRef.shadowRoot.querySelectorAll(\".editor-update\").forEach((element) => {\r\n  //     element.addEventListener('click', (e) => {\r\n  //       const rowIndex = parseInt((e.currentTarget as HTMLElement).getAttribute(\"data-index\"))\r\n  //       this.rowUpdate.emit(this.dataSet[rowIndex]);\r\n  //       e.stopPropagation();\r\n  //     })\r\n  //   });\r\n\r\n  //   this.tableRef.shadowRoot.querySelectorAll(\".editor-delete\").forEach((element) => {\r\n  //     element.addEventListener('click', (e) => {\r\n  //       const rowIndex = parseInt((e.currentTarget as HTMLElement).getAttribute(\"data-index\"))\r\n  //       this.rowDelete.emit(this.dataSet[rowIndex]);\r\n  //       e.stopPropagation();\r\n  //     })\r\n  //   });\r\n  // }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <storm-table\r\n          searchable={this.searchable}\r\n          pagination={this.pagination}\r\n          classes={parseClassNames(this.classes)}\r\n          columns={this.columns}\r\n          dataSet={this.dataSet}\r\n          clickRowTo={this.clickRowTo}\r\n          escape={this.escape}\r\n          ref={el => (this.tableRef = el)}\r\n        />\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"version":3}