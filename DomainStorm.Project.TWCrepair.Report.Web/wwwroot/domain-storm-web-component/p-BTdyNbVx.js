import{e as n,h as t}from"./p-DS2LX-Ro.js";function r(n){var t,e,o="";if("string"==typeof n||"number"==typeof n)o+=n;else if("object"==typeof n)if(Array.isArray(n)){var s=n.length;for(t=0;t<s;t++)n[t]&&(e=r(n[t]))&&(o&&(o+=" "),o+=e)}else for(e in n)n[e]&&(o&&(o+=" "),o+=e);return o}function e(){for(var n,t,e=0,o="",s=arguments.length;e<s;e++)(n=arguments[e])&&(t=r(n))&&(o&&(o+=" "),o+=t);return o}function o(n="",t=""){const r=crypto.randomUUID();const e=[];if(n)e.push(n);e.push(r);if(t)e.push(t);return e.join("_")}const s=new Map;const i=500;function f(n,t){if(n==null)return n;if(typeof t==="number"){return Array.isArray(n)?n[t]:undefined}if(typeof t!=="string"){throw new Error("Field must be a string or a number")}const r=t.trim();if(r==="")return undefined;let e=s.get(r);if(!e){e=u(r);if(s.size>=i){const n=s.keys().next().value;s.delete(n)}s.set(r,e)}switch(e.type){case"pipe":return a(n,e.parts);case"ampersand":return l(n,e.parts);case"dot":{const t=f(n,e.firstField);return f(t,e.subField)}case"simple":if(Array.isArray(n)&&n.length>0&&typeof n[0]==="object"){return n.map((n=>f(n,r)))}if(typeof n==="object"&&n!==null){return n[r]}}return undefined}function u(n){const t=n.indexOf("|");const r=n.indexOf("&");const e=n.indexOf(".");if(t!==-1){return{type:"pipe",parts:n.split("|")}}if(r!==-1){return{type:"ampersand",parts:n.split("&")}}if(e!==-1){return{type:"dot",firstField:n.substring(0,e),subField:n.substring(e+1)}}return{type:"simple"}}function c(n,t,r){if(n==null){return}if(typeof t==="number"){if(Array.isArray(n)){n[t]=r}return}if(typeof t!=="string"){throw new Error("Field must be a string or a number")}const e=t.trim();if(e==="")return;let o=s.get(e);if(!o){o=u(e);if(s.size>=i){const n=s.keys().next().value;s.delete(n)}s.set(e,o)}if(o.type==="pipe"||o.type==="ampersand"){const t=o.parts;for(let e=0;e<t.length;e++){const o=t[e].trim();if(o&&f(n,o)!==undefined){c(n,o,r);return}}const e=t[0]?.trim();if(e){c(n,e,r)}return}if(o.type==="dot"){if(typeof n==="object"){const t=n[o.firstField];if(t!==undefined){c(t,o.subField,r)}}return}if(Array.isArray(n)&&n.length>0&&typeof n[0]==="object"){for(let t=0;t<n.length;t++){const o=n[t];if(o&&typeof o==="object"){o[e]=r}}}else if(typeof n==="object"){n[e]=r}}function a(n,t){for(const r of t){const t=r.trim();if(t){const r=f(n,t);if(r!=null)return r}}return null}function l(n,t){const r=[];for(const e of t){const t=e.trim();if(t){const e=f(n,t);if(e!=null){if(Array.isArray(e)){r.push(...e)}else{r.push(e)}}}}return r}function p(n,t,...r){if(t==null)return t;if(typeof t==="string"){if(d(t)){t=y(t)}else{const r=t.split(".");let e=n||(typeof window!=="undefined"?window:globalThis);for(const n of r){e=e?.[n];if(e===undefined)break}if(typeof e==="function"){t=e}}}if(typeof t==="function"){return h(n,t,...r)}return t}function y(n){if(typeof n!=="string"||n.trim()===""){throw new Error("Function string cannot be empty")}const t=/^export default\s+(async\s+)?function\s*\(([^)]*)\)\s*{([\s\S]*)}$/;const r=t.exec(n);if(!r){throw new Error("Invalid function string")}const e=!!r[1];const o=r[2].split(",").map((n=>n.trim())).filter(Boolean);const s=r[3].trim();const i=new Compartment;const f=e?Object.getPrototypeOf((async function(){})).constructor:Function;const u=new i.globalThis[f.name](...o,s);return u}function d(n){if(typeof n!=="string"){return false}const t=n.trim();const r=/^export\s+default\s+function\s*[a-zA-Z0-9_$]*\s*\([^)]*\)\s*{[\s\S]*}$/;return r.test(t)}function b(n,t){const r=n.filter((n=>n.conjunction!=="or"));const e=n.filter((n=>n.conjunction==="or"));if(r.some((n=>!g(n,t)))){return false}if(e.length>0&&!e.some((n=>g(n,t)))){return false}return true}function g(n,t){try{const r=p(null,n.field,t);const e=p(null,n.operator,t);const o=p(null,n.value,t);const s=j(t,r);if(s===null||s===undefined){if(e==="=")return o===null||o===undefined;if(e==="!=")return o!==null&&o!==undefined;if(e==="empty")return true;if(e==="notempty")return false;return false}switch(e){case">":{const n=+s;const t=+o;return!isNaN(n)&&!isNaN(t)&&n>t}case"<":{const n=+s;const t=+o;return!isNaN(n)&&!isNaN(t)&&n<t}case">=":{const n=+s;const t=+o;return!isNaN(n)&&!isNaN(t)&&n>=t}case"<=":{const n=+s;const t=+o;return!isNaN(n)&&!isNaN(t)&&n<=t}case"=":return s===o||typeof s==="number"&&typeof o==="string"&&s===+o&&!isNaN(+o)||typeof s==="string"&&typeof o==="number"&&+s===o&&!isNaN(+s);case"!=":return s!==o&&!(typeof s==="number"&&typeof o==="string"&&s===+o&&!isNaN(+o))&&!(typeof s==="string"&&typeof o==="number"&&+s===o&&!isNaN(+s));case"like":{const n=String(s).toLowerCase();const t=String(o).toLowerCase();return n.includes(t)}case"include":return Array.isArray(s)&&s.includes(o);case"notinclude":return Array.isArray(s)&&!s.includes(o);case"in":return Array.isArray(o)&&o.includes(s);case"notin":return Array.isArray(o)&&!o.includes(s);case"typeof":if(typeof o!=="string"){console.warn("typeof 運算符需要字串型別的比較值");return false}return typeof s===o;case"instanceof":if(typeof o!=="function"){console.warn("instanceof 運算符需要函數型別的比較值");return false}return s instanceof o;case"empty":return s===""||Array.isArray(s)&&s.length===0||typeof s==="object"&&s!==null&&Object.keys(s).length===0;case"notempty":return s!==""&&!(Array.isArray(s)&&s.length===0)&&!(typeof s==="object"&&s!==null&&Object.keys(s).length===0);case"match":try{const n=String(o);return new RegExp(n).test(String(s))}catch(n){console.error("無效的正則表達式:",o);return false}default:throw new Error(`不支援的運算符: ${e}`)}}catch(n){console.error("條件檢查失敗:",n);return false}}function m(n,t){const r=/\{([^}]+)\}/g;return n.replace(r,((n,r)=>{const e=f(t,r);return e!==undefined?String(e):""}))}function N(n){if(!n)return{};if(typeof n==="object")return n;const t=n.trim();if(!t)return{};return t.split(/\s+/).reduce(((n,t)=>{if(t)n[t]=true;return n}),{})}function w(n,t){const r=e(n,t);if(!r)return{};return r.split(/\s+/).reduce(((n,t)=>{if(t)n[t]=true;return n}),{})}function j(n,t,r){if(!n||typeof n!=="object"){return null}if(!Object.hasOwn(n,t)){if(t.includes(".")){const e=t.split(".");const o=e.shift();if(Object.hasOwn(n,o)){const t=n[o];return j(t,e.join("."),r)}}return null}let e=n[t];if(typeof e==="string"&&d(e)){try{e=n[t]=y(e)}catch(n){console.error(`無法解析函式字串 '${t}':`,n);return null}}try{return h(n,e,...r||[])}catch(n){console.error(`執行屬性 '${t}' 時發生錯誤:`,n);return null}}function A(n,r,e='<span class="bg-warning text-dark">$1</span>'){if(!r||!n){return n}try{const o=t.encode(r);const s=new RegExp(`(${o})`,"gi");const i=e.replace("$1","$&");return n.replace(s,i)}catch(t){console.error("搜尋高亮處理錯誤:",t);return n}}function h(n,t,...r){if(typeof t!=="function"){return t}return t.apply(n,r)}function S(n){if(n==null||!Array.isArray(n)){return false}return n.every((n=>typeof n==="object"&&n!==null&&"field"in n&&"operator"in n&&"value"in n))}function $(n){if(n==null||!Array.isArray(n)){return false}return n.every((n=>typeof n==="object"&&n!==null&&"conditions"in n&&S(n.conditions)&&"value"in n))}function E(n,t,r="single"){if(!Array.isArray(n)||n.length===0)return null;const e=n.filter((n=>n.selected===true&&n.id)).map((n=>String(n.id)));if(e.length===0){if(t||r==="none"){return null}const o=n.find((n=>n.id));if(o){e.push(String(o.id))}else{return null}}return r==="single"?e[0]:e}function v(n){if(Array.isArray(n)){if(n.length===0){return false}return n.some((n=>v(n)))}return typeof n==="string"&&n.trim()!==""}function x(t,r){return t==r||n(t,r)}export{f as a,A as b,y as c,x as d,p as e,E as f,o as g,$ as h,d as i,S as j,b as k,m as l,w as m,v as n,N as p,j as r,c as s};
//# sourceMappingURL=p-BTdyNbVx.js.map