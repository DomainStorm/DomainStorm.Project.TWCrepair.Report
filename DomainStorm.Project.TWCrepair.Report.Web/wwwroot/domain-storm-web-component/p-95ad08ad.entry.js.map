{"version":3,"names":["stormNavsCss","StormNavs","_resizeObserver","_navPillsRef","_navsRef","_movingDiv","value","dataSet","direction","activeChanged","watchDataSetHandler","this","initDataSet","valueHandler","moveNav","length","forEach","x","id","generateUid","active","some","setActive","handleItemClick","ev","preventDefault","stopPropagation","checkSize","componentDidLoad","activeLi","querySelector","offsetWidth","offsetHeight","requestAnimationFrame","actionRender","bindMouseOver","observeResize","addEventListener","target","li","closest","nodes","Array","from","children","index","indexOf","bindClickEvent","navLink","updateNavPosition","once","navElem","classList","toggle","parentElement","emit","sum","contains","j","style","transform","height","width","ResizeObserver","observe","host","activeLink","createOrUpdateMovingNav","isVertical","calculateNavOffset","updateMovingNav","adjustLayoutForScreenSize","document","createElement","nav","cloneNode","textContent","add","appendChild","padding","transition","dimension","window","innerWidth","toggleLayout","remove","componentWillRender","render","h","Host","class","ref","elm","map","disabled","onClick","href","FnIcon","icon","name"],"sources":["src/components/storm-navs/storm-navs.css?tag=storm-navs","src/components/storm-navs/storm-navs.tsx"],"sourcesContent":[":host {\r\n    display: block;\r\n}\r\n\r\n.nav-link:not(.active):hover {\r\n    color: #e91e63 !important;\r\n}\r\n\r\n.nav-link.disabled {\r\n    color: #7b809a !important;\r\n}","import { Component, Element, Event, EventEmitter, h, Host, Method, Prop, Watch } from '@stencil/core';\r\nimport { FnIcon } from '@utils/functional/functional';\r\nimport { generateUid } from '@utils/utils';\r\nimport type { StormNavInterface } from './interface';\r\n\r\n@Component({\r\n  tag: 'storm-navs',\r\n  styleUrl: 'storm-navs.css',\r\n})\r\nexport class StormNavs {\r\n  private _resizeObserver: ResizeObserver;\r\n  private _navPillsRef: HTMLElement;\r\n  private _navsRef: Record<string, Element>;\r\n  private _movingDiv: HTMLElement;\r\n\r\n  @Element() host: HTMLElement;\r\n\r\n  @Prop({ mutable: true }) value?: string;\r\n  @Prop() dataSet: StormNavInterface[];\r\n  @Prop() direction: 'horizontal' | 'vertical' = 'horizontal';\r\n\r\n  @Event({ bubbles: true }) activeChanged: EventEmitter<string>;\r\n\r\n  @Watch('dataSet')\r\n  async watchDataSetHandler() {\r\n    this.initDataSet();\r\n  }\r\n\r\n  @Watch('value')\r\n  async valueHandler() {\r\n    this.moveNav();\r\n  }\r\n\r\n  initDataSet() {\r\n    if (!this.dataSet || this.dataSet.length === 0) {\r\n      return;\r\n    }\r\n\r\n    this.dataSet.forEach(x => {\r\n      if (!x.id) {\r\n        x.id = generateUid('storm-nav');\r\n      }\r\n    });\r\n\r\n    if (this.value) {\r\n      this.dataSet.forEach(x => {\r\n        x.active = x.id === this.value;\r\n      });\r\n    } else if (!this.dataSet.some(x => x.active)) {\r\n      this.dataSet[0].active = true;\r\n      this.value = this.dataSet[0].id;\r\n    }\r\n  }\r\n\r\n  @Method()\r\n  async setActive(id: string) {\r\n    this.value = id;\r\n  }\r\n\r\n  handleItemClick(ev: MouseEvent, id: string) {\r\n    if (ev) {\r\n      ev.preventDefault();\r\n      ev.stopPropagation();\r\n    }\r\n\r\n    this.value = id;\r\n  }\r\n\r\n  checkSize() {}\r\n\r\n  componentDidLoad() {\r\n    if (!this.dataSet) return;\r\n\r\n    const checkSize = () => {\r\n      const activeLi = this._navPillsRef.querySelector('.nav-link.active') as HTMLElement;\r\n      if (!activeLi.offsetWidth && !activeLi.offsetHeight) {\r\n        return requestAnimationFrame(checkSize);\r\n      }\r\n\r\n      this.actionRender();\r\n      this.bindMouseOver();\r\n      this.observeResize();\r\n    };\r\n\r\n    checkSize();\r\n    this.moveNav();\r\n  }\r\n\r\n  bindMouseOver() {\r\n    this._navPillsRef.addEventListener('mouseover', (ev: MouseEvent) => {\r\n      const target = ev.target as HTMLElement;\r\n      const li = target.closest('li');\r\n      if (li) {\r\n        const nodes = Array.from(li.closest('ul')?.children || []);\r\n        const index = nodes.indexOf(li) + 1;\r\n        this.bindClickEvent(li, nodes, index);\r\n      }\r\n    });\r\n  }\r\n\r\n  bindClickEvent(li: HTMLElement, nodes: Element[], index: number) {\r\n    const navLink = this._navPillsRef.querySelector(`li:nth-child(${index}) .nav-link`);\r\n    navLink?.addEventListener(\r\n      'click',\r\n      () => {\r\n        this.updateNavPosition(li, nodes, index);\r\n      },\r\n      { once: true },\r\n    );\r\n  }\r\n\r\n  moveNav() {\r\n    if (!this.value) return;\r\n    this.dataSet.forEach(x => {\r\n      x.active = x.id === this.value;\r\n      const navElem = this._navsRef[x.id];\r\n\r\n      navElem.classList.toggle('active', x.active);\r\n    });\r\n\r\n    this.updateNavPosition(\r\n      this._navsRef[this.value].parentElement as HTMLElement,\r\n      Array.from(this._navsRef[this.value].closest('ul').children),\r\n      Array.from(this._navsRef[this.value].closest('ul').children).indexOf(this._navsRef[this.value].parentElement) + 1,\r\n    );\r\n\r\n    this.activeChanged.emit(this.value);\r\n  }\r\n\r\n  updateNavPosition(li: HTMLElement, nodes: Element[], index: number) {\r\n    if (!this._movingDiv) {\r\n      return;\r\n    }\r\n    let sum = 0;\r\n\r\n    if (this._navPillsRef.classList.contains('flex-column')) {\r\n      for (let j = 1; j <= nodes.indexOf(li); j++) {\r\n        sum += (this._navPillsRef.querySelector(`li:nth-child(${j})`) as HTMLElement).offsetHeight;\r\n      }\r\n      this._movingDiv.style.transform = `translate3d(0px, ${sum}px, 0px)`;\r\n      this._movingDiv.style.height = `${(this._navPillsRef.querySelector(`li:nth-child(${index})`) as HTMLElement).offsetHeight}px`;\r\n    } else {\r\n      for (let j = 1; j <= nodes.indexOf(li); j++) {\r\n        sum += (this._navPillsRef.querySelector(`li:nth-child(${j})`) as HTMLElement).offsetWidth;\r\n      }\r\n      this._movingDiv.style.transform = `translate3d(${sum}px, 0px, 0px)`;\r\n      this._movingDiv.style.width = `${(this._navPillsRef.querySelector(`li:nth-child(${index})`) as HTMLElement).offsetWidth}px`;\r\n    }\r\n  }\r\n\r\n  observeResize() {\r\n    this._resizeObserver = new ResizeObserver(() => {\r\n      this.actionRender();\r\n    });\r\n    this._resizeObserver.observe(this.host);\r\n  }\r\n\r\n  actionRender() {\r\n    if (this._navPillsRef == null) return;\r\n\r\n    const activeLink = this._navPillsRef.querySelector('.nav-link.active') as HTMLElement;\r\n    if (activeLink == null) return;\r\n\r\n    const li = activeLink.parentElement;\r\n    const nodes = Array.from(li.closest('ul').children);\r\n    this.createOrUpdateMovingNav(activeLink);\r\n\r\n    if (li) {\r\n      const isVertical = this._navPillsRef.classList.contains('flex-column');\r\n      const index = nodes.indexOf(li) + 1;\r\n      const sum = this.calculateNavOffset(index, isVertical);\r\n\r\n      this.updateMovingNav(sum, isVertical, index);\r\n    }\r\n\r\n    this.adjustLayoutForScreenSize();\r\n  }\r\n\r\n  createOrUpdateMovingNav(activeLink: HTMLElement): HTMLElement {\r\n    if (!this._movingDiv) {\r\n      this._movingDiv = document.createElement('div');\r\n      const nav = activeLink.cloneNode() as HTMLElement;\r\n      nav.textContent = '-';\r\n\r\n      this._movingDiv.classList.add('moving-tab', 'position-absolute', 'nav-link');\r\n      this._movingDiv.appendChild(nav);\r\n      this._navPillsRef.appendChild(this._movingDiv);\r\n    }\r\n\r\n    this._movingDiv.style.padding = '0px';\r\n    this._movingDiv.style.transition = '.5s ease';\r\n    return this._movingDiv;\r\n  }\r\n\r\n  calculateNavOffset(index: number, isVertical: boolean): number {\r\n    let sum = 0;\r\n    for (let j = 1; j < index; j++) {\r\n      const dimension = isVertical ? 'offsetHeight' : 'offsetWidth';\r\n      sum += (this._navPillsRef.querySelector(`li:nth-child(${j})`) as HTMLElement)[dimension];\r\n    }\r\n    return sum;\r\n  }\r\n\r\n  updateMovingNav(sum: number, isVertical: boolean, index: number) {\r\n    this._movingDiv.style.transform = isVertical ? `translate3d(0px, ${sum}px, 0px)` : `translate3d(${sum}px, 0px, 0px)`;\r\n    this._movingDiv.style[`width`] = (this._navPillsRef.querySelector(`li:nth-child(${index})`) as HTMLElement).offsetWidth + 'px';\r\n    this._movingDiv.style[`height`] = (this._navPillsRef.querySelector(`li:nth-child(${index})`) as HTMLElement).offsetHeight + 'px';\r\n  }\r\n\r\n  adjustLayoutForScreenSize() {\r\n    if (window.innerWidth < 991 && !this._navPillsRef.classList.contains('flex-column')) {\r\n      this.toggleLayout(true);\r\n    } else if (window.innerWidth >= 991 && this._navPillsRef.classList.contains('on-resize')) {\r\n      this.toggleLayout(false);\r\n    }\r\n  }\r\n\r\n  toggleLayout(isVertical: boolean) {\r\n    if (isVertical) {\r\n      this._navPillsRef.classList.remove('flex-row');\r\n      this._navPillsRef.classList.add('flex-column', 'on-resize');\r\n    } else {\r\n      this._navPillsRef.classList.remove('flex-column', 'on-resize');\r\n      this._navPillsRef.classList.add('flex-row');\r\n    }\r\n    const li = this._navPillsRef.querySelector('.nav-link.active').parentElement;\r\n    const nodes = Array.from(li.closest('ul').children);\r\n    const sum = this.calculateNavOffset(nodes.indexOf(li) + 1, isVertical);\r\n    this._movingDiv.style.transform = isVertical ? `translate3d(0px, ${sum}px, 0px)` : `translate3d(${sum}px, 0px, 0px)`;\r\n  }\r\n\r\n  componentWillRender() {\r\n    this.initDataSet();\r\n  }\r\n\r\n  render() {\r\n    this._navsRef = {};\r\n    if (!this.dataSet) return;\r\n    return (\r\n      <Host>\r\n        <div class=\"nav-wrapper position-relative end-0 m-1\">\r\n          <ul\r\n            ref={elm => (this._navPillsRef = elm)}\r\n            class={{\r\n              nav: true,\r\n              'nav-pills': true,\r\n              'nav-fill': true,\r\n              'p-1': true,\r\n              'flex-column': this.direction === 'vertical',\r\n            }}\r\n          >\r\n            {this.dataSet.map(x => (\r\n              <li class=\"nav-item\">\r\n                <a\r\n                  ref={elm => (this._navsRef[x.id] = elm)}\r\n                  class={{\r\n                    'nav-link': true,\r\n                    'mb-0': true,\r\n                    'px-0': true,\r\n                    'py-1': true,\r\n                    active: x.active,\r\n                    disabled: x.disabled,\r\n                  }}\r\n                  onClick={ev => this.handleItemClick(ev, x.id)}\r\n                  href=\"#\"\r\n                >\r\n                  <FnIcon>{x.icon}</FnIcon>\r\n                  {x.name}\r\n                </a>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]}